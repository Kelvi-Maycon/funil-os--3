{"version":3,"file":"CanvasBoard-Dx6yABxR.js","names":["__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","Map","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","icons: Record<string, any>","newTask: Task","Switch","newTask: Task","newTask: Task","newAsset: Resource","newNode: Node"],"sources":["../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/arrow-left.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/circle-arrow-up.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/circle-check-big.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/circle-play.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/credit-card.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/dollar-sign.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/hand-heart.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/hand.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/link.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/mail.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/map.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/megaphone.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/message-circle.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/minus.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/mouse-pointer-2.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/phone.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/settings.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/smartphone.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/type.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/zap.js","../../src/components/canvas/BlockPalette.tsx","../../src/components/canvas/NodeItem.tsx","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/@radix-ui+react-switch@1.2.6_@types+react-dom@19.2.3_@types+react@19.2.14__@types+react_e3738c514c10df2ef7e24af5ee461853/node_modules/@radix-ui/react-switch/dist/index.mjs","../../src/components/ui/switch.tsx","../../src/components/canvas/RightPanel.tsx","../../src/components/canvas/NodeSettingsModal.tsx","../../src/hooks/useCanvasHistory.ts","../../src/hooks/useCanvasTransform.ts","../../src/hooks/useCanvasSelection.ts","../../src/components/canvas/CanvasBoard.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m12 19-7-7 7-7\", key: \"1l729n\" }],\n  [\"path\", { d: \"M19 12H5\", key: \"x3x0zl\" }]\n];\nconst ArrowLeft = createLucideIcon(\"arrow-left\", __iconNode);\n\nexport { __iconNode, ArrowLeft as default };\n//# sourceMappingURL=arrow-left.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"m16 12-4-4-4 4\", key: \"177agl\" }],\n  [\"path\", { d: \"M12 16V8\", key: \"1sbj14\" }]\n];\nconst CircleArrowUp = createLucideIcon(\"circle-arrow-up\", __iconNode);\n\nexport { __iconNode, CircleArrowUp as default };\n//# sourceMappingURL=circle-arrow-up.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M21.801 10A10 10 0 1 1 17 3.335\", key: \"yps3ct\" }],\n  [\"path\", { d: \"m9 11 3 3L22 4\", key: \"1pflzl\" }]\n];\nconst CircleCheckBig = createLucideIcon(\"circle-check-big\", __iconNode);\n\nexport { __iconNode, CircleCheckBig as default };\n//# sourceMappingURL=circle-check-big.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z\",\n      key: \"kmsa83\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }]\n];\nconst CirclePlay = createLucideIcon(\"circle-play\", __iconNode);\n\nexport { __iconNode, CirclePlay as default };\n//# sourceMappingURL=circle-play.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"20\", height: \"14\", x: \"2\", y: \"5\", rx: \"2\", key: \"ynyp8z\" }],\n  [\"line\", { x1: \"2\", x2: \"22\", y1: \"10\", y2: \"10\", key: \"1b3vmo\" }]\n];\nconst CreditCard = createLucideIcon(\"credit-card\", __iconNode);\n\nexport { __iconNode, CreditCard as default };\n//# sourceMappingURL=credit-card.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"2\", y2: \"22\", key: \"7eqyqh\" }],\n  [\"path\", { d: \"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\", key: \"1b0p4s\" }]\n];\nconst DollarSign = createLucideIcon(\"dollar-sign\", __iconNode);\n\nexport { __iconNode, DollarSign as default };\n//# sourceMappingURL=dollar-sign.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M11 14h2a2 2 0 0 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16\", key: \"1v1a37\" }],\n  [\n    \"path\",\n    {\n      d: \"m14.45 13.39 5.05-4.694C20.196 8 21 6.85 21 5.75a2.75 2.75 0 0 0-4.797-1.837.276.276 0 0 1-.406 0A2.75 2.75 0 0 0 11 5.75c0 1.2.802 2.248 1.5 2.946L16 11.95\",\n      key: \"fhfbnt\"\n    }\n  ],\n  [\"path\", { d: \"m2 15 6 6\", key: \"10dquu\" }],\n  [\n    \"path\",\n    {\n      d: \"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a1 1 0 0 0-2.75-2.91\",\n      key: \"1x6kdw\"\n    }\n  ]\n];\nconst HandHeart = createLucideIcon(\"hand-heart\", __iconNode);\n\nexport { __iconNode, HandHeart as default };\n//# sourceMappingURL=hand-heart.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2\", key: \"1fvzgz\" }],\n  [\"path\", { d: \"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2\", key: \"1kc0my\" }],\n  [\"path\", { d: \"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8\", key: \"10h0bg\" }],\n  [\n    \"path\",\n    {\n      d: \"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15\",\n      key: \"1s1gnw\"\n    }\n  ]\n];\nconst Hand = createLucideIcon(\"hand\", __iconNode);\n\nexport { __iconNode, Hand as default };\n//# sourceMappingURL=hand.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\", key: \"1cjeqo\" }],\n  [\"path\", { d: \"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\", key: \"19qd67\" }]\n];\nconst Link = createLucideIcon(\"link\", __iconNode);\n\nexport { __iconNode, Link as default };\n//# sourceMappingURL=link.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7\", key: \"132q7q\" }],\n  [\"rect\", { x: \"2\", y: \"4\", width: \"20\", height: \"16\", rx: \"2\", key: \"izxlao\" }]\n];\nconst Mail = createLucideIcon(\"mail\", __iconNode);\n\nexport { __iconNode, Mail as default };\n//# sourceMappingURL=mail.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z\",\n      key: \"169xi5\"\n    }\n  ],\n  [\"path\", { d: \"M15 5.764v15\", key: \"1pn4in\" }],\n  [\"path\", { d: \"M9 3.236v15\", key: \"1uimfh\" }]\n];\nconst Map = createLucideIcon(\"map\", __iconNode);\n\nexport { __iconNode, Map as default };\n//# sourceMappingURL=map.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z\",\n      key: \"q8bfy3\"\n    }\n  ],\n  [\"path\", { d: \"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14\", key: \"1853fq\" }],\n  [\"path\", { d: \"M8 6v8\", key: \"15ugcq\" }]\n];\nconst Megaphone = createLucideIcon(\"megaphone\", __iconNode);\n\nexport { __iconNode, Megaphone as default };\n//# sourceMappingURL=megaphone.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719\",\n      key: \"1sd12s\"\n    }\n  ]\n];\nconst MessageCircle = createLucideIcon(\"message-circle\", __iconNode);\n\nexport { __iconNode, MessageCircle as default };\n//# sourceMappingURL=message-circle.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"M5 12h14\", key: \"1ays0h\" }]];\nconst Minus = createLucideIcon(\"minus\", __iconNode);\n\nexport { __iconNode, Minus as default };\n//# sourceMappingURL=minus.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z\",\n      key: \"edeuup\"\n    }\n  ]\n];\nconst MousePointer2 = createLucideIcon(\"mouse-pointer-2\", __iconNode);\n\nexport { __iconNode, MousePointer2 as default };\n//# sourceMappingURL=mouse-pointer-2.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384\",\n      key: \"9njp5v\"\n    }\n  ]\n];\nconst Phone = createLucideIcon(\"phone\", __iconNode);\n\nexport { __iconNode, Phone as default };\n//# sourceMappingURL=phone.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915\",\n      key: \"1i5ecw\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n];\nconst Settings = createLucideIcon(\"settings\", __iconNode);\n\nexport { __iconNode, Settings as default };\n//# sourceMappingURL=settings.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"14\", height: \"20\", x: \"5\", y: \"2\", rx: \"2\", ry: \"2\", key: \"1yt0o3\" }],\n  [\"path\", { d: \"M12 18h.01\", key: \"mhygvu\" }]\n];\nconst Smartphone = createLucideIcon(\"smartphone\", __iconNode);\n\nexport { __iconNode, Smartphone as default };\n//# sourceMappingURL=smartphone.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 4v16\", key: \"1654pz\" }],\n  [\"path\", { d: \"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2\", key: \"e0r10z\" }],\n  [\"path\", { d: \"M9 20h6\", key: \"s66wpe\" }]\n];\nconst Type = createLucideIcon(\"type\", __iconNode);\n\nexport { __iconNode, Type as default };\n//# sourceMappingURL=type.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z\",\n      key: \"1xq2db\"\n    }\n  ]\n];\nconst Zap = createLucideIcon(\"zap\", __iconNode);\n\nexport { __iconNode, Zap as default };\n//# sourceMappingURL=zap.js.map\n","import React from 'react'\nimport {\n  Mail,\n  MessageSquare,\n  MessageCircle,\n  Phone,\n  Smartphone,\n  Clock,\n  LayoutTemplate,\n  CreditCard,\n  ArrowUpCircle,\n  CheckCircle,\n  FileText,\n  Megaphone,\n  PlayCircle,\n} from 'lucide-react'\nimport { Funnel } from '@/types'\n\nconst BLOCK_CATEGORIES = [\n  {\n    title: 'MESSAGES',\n    iconColor: 'text-[#C2714F]',\n    blocks: [\n      { type: 'Email', icon: Mail, label: 'Email' },\n      { type: 'Slack', icon: MessageSquare, label: 'Slack' },\n      { type: 'SMS', icon: MessageCircle, label: 'SMS' },\n      { type: 'WhatsApp', icon: Phone, label: 'WATI (WhatsApp)' },\n      { type: 'ManyChat', icon: Smartphone, label: 'ManyChat (WhatsApp)' },\n    ],\n  },\n  {\n    title: 'DELAYS',\n    iconColor: 'text-[#C2714F]',\n    blocks: [{ type: 'Wait', icon: Clock, label: 'Wait Until' }],\n  },\n  {\n    title: 'PAGES',\n    iconColor: 'text-[#C2714F]',\n    blocks: [\n      { type: 'LandingPage', icon: LayoutTemplate, label: 'Landing Page' },\n      { type: 'VSL', icon: PlayCircle, label: 'VSL Page' },\n      { type: 'Checkout', icon: CreditCard, label: 'Checkout' },\n      { type: 'Upsell', icon: ArrowUpCircle, label: 'Upsell' },\n      { type: 'ThankYou', icon: CheckCircle, label: 'Thank You' },\n      { type: 'Form', icon: FileText, label: 'Form' },\n      { type: 'Ad', icon: Megaphone, label: 'Ad Campaign' },\n    ],\n  },\n]\n\nexport default function BlockPalette({ funnel }: { funnel: Funnel }) {\n  const onDragStart = (e: React.DragEvent, type: string) => {\n    e.dataTransfer.setData('blockType', type)\n  }\n\n  return (\n    <div className=\"w-[260px] max-h-[calc(100vh-140px)] bg-white rounded-2xl border border-[#E8E2D9] shadow-xl flex flex-col overflow-hidden\">\n      <div className=\"flex-1 overflow-y-auto p-5 no-scrollbar space-y-8\">\n        {BLOCK_CATEGORIES.map((cat, idx) => (\n          <div key={idx} className=\"space-y-4\">\n            <div className=\"flex items-center gap-2 px-1\">\n              <div\n                className={`w-2 h-2 rotate-45 bg-current ${cat.iconColor}`}\n              />\n              <h4 className=\"text-[11px] font-bold text-[#8C7B6C] tracking-widest uppercase\">\n                {cat.title}\n              </h4>\n            </div>\n            <div className=\"flex flex-col gap-1\">\n              {cat.blocks.map((block) => (\n                <div\n                  key={block.type}\n                  draggable\n                  onDragStart={(e) => onDragStart(e, block.type)}\n                  className=\"flex items-center gap-4 p-3 hover:bg-[#FAF7F2] rounded-2xl cursor-grab active:cursor-grabbing transition-colors text-[#3D2B1F] border border-transparent hover:border-[#E8E2D9]\"\n                >\n                  <block.icon\n                    size={18}\n                    className=\"text-[#8C7B6C] shrink-0\"\n                    strokeWidth={2}\n                  />\n                  <span className=\"text-[13px] font-bold truncate\">\n                    {block.label}\n                  </span>\n                </div>\n              ))}\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  )\n}\n","import { useState, useRef, useEffect } from 'react'\nimport { generateId } from '@/lib/generateId'\nimport { Node, Task } from '@/types'\nimport { cn } from '@/lib/utils'\nimport useTaskStore from '@/stores/useTaskStore'\nimport useFunnelStore from '@/stores/useFunnelStore'\nimport {\n  Megaphone,\n  LayoutTemplate,\n  MessageCircle,\n  Mail,\n  DollarSign,\n  HandHeart,\n  CheckCircle,\n  FileText,\n  Settings,\n  Trash2,\n  Zap,\n  MessageSquare,\n  Clock,\n  ExternalLink,\n  Image as ImageIcon,\n  CheckSquare,\n  Plus,\n  X,\n  PlayCircle,\n} from 'lucide-react'\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from '@/components/ui/tooltip'\nimport { Checkbox } from '@/components/ui/checkbox'\n\nconst icons: Record<string, any> = {\n  Ad: Megaphone,\n  LandingPage: LayoutTemplate,\n  Email: Mail,\n  Checkout: DollarSign,\n  Upsell: HandHeart,\n  Obrigado: CheckCircle,\n  Form: FileText,\n  Slack: MessageSquare,\n  SMS: MessageCircle,\n  WATI: MessageCircle,\n  ManyChat: MessageCircle,\n  WaitUntil: Clock,\n  Default: Zap,\n  VSL: PlayCircle,\n  Traffic: Megaphone,\n  Goal: CheckCircle,\n}\n\ntype NodeItemProps = {\n  node: Node\n  selected: boolean\n  isNodeDragging: boolean\n  snapToGrid?: boolean\n  activeTool: string\n  taskProgress: { total: number; completed: number }\n  onPointerDownAction: (shiftKey: boolean) => void\n  onMove: (dx: number, dy: number) => void\n  onMoveEnd: (dx: number, dy: number) => void\n  onResize?: (x: number, y: number, w: number, h: number) => void\n  onResizeEnd?: (x: number, y: number, w: number, h: number) => void\n  scale: number\n  onOpenRightPanel: (tab: string) => void\n  onOpenSettings: () => void\n  onToggleComplete: () => void\n  onDelete: () => void\n  onAddChild: () => void\n  onTextChange: (text: string) => void\n  onEdgeDragStart: (nodeId: string, e: React.PointerEvent) => void\n  onDropResource: (type: string, id: string) => void\n}\n\nexport default function NodeItem({\n  node,\n  selected,\n  isNodeDragging,\n  snapToGrid,\n  activeTool,\n  taskProgress,\n  onPointerDownAction,\n  onMove,\n  onMoveEnd,\n  onResize,\n  onResizeEnd,\n  scale,\n  onOpenRightPanel,\n  onOpenSettings,\n  onToggleComplete,\n  onDelete,\n  onAddChild,\n  onTextChange,\n  onEdgeDragStart,\n  onDropResource,\n}: NodeItemProps) {\n  const [isDragging, setIsDragging] = useState(false)\n  const [isResizing, setIsResizing] = useState(false)\n  const [isHovered, setIsHovered] = useState(false)\n  const [isEditingText, setIsEditingText] = useState(false)\n  const textRef = useRef<HTMLDivElement>(null)\n  const hasAutoSelected = useRef(false)\n\n  const [tasks, setTasks] = useTaskStore()\n  const [funnels] = useFunnelStore()\n  const [newTaskTitle, setNewTaskTitle] = useState('')\n  const [isAddingTask, setIsAddingTask] = useState(false)\n\n  const callbacksRef = useRef({\n    onPointerDownAction,\n    onMove,\n    onMoveEnd,\n    onResize,\n    onResizeEnd,\n  })\n  callbacksRef.current = {\n    onPointerDownAction,\n    onMove,\n    onMoveEnd,\n    onResize,\n    onResizeEnd,\n  }\n\n  const funnel = funnels.find((f) => f.nodes.some((n) => n.id === node.id))\n  const linkedTasks = tasks.filter(\n    (t) => t.nodeId === node.id || node.data.linkedTaskIds?.includes(t.id),\n  )\n\n  const isPanMode = activeTool === 'Pan'\n  const isSelectMode = activeTool === 'Select'\n  const currentlyDragging = isDragging || isNodeDragging\n\n  useEffect(() => {\n    if (\n      node.type === 'FloatingText' &&\n      node.data.name === 'New Text' &&\n      !hasAutoSelected.current\n    ) {\n      hasAutoSelected.current = true\n      setIsEditingText(true)\n      setTimeout(() => {\n        if (textRef.current) {\n          textRef.current.focus()\n          document.execCommand('selectAll', false, undefined)\n        }\n      }, 0)\n    }\n  }, [node.type, node.data.name])\n\n  const handleToggleTask = (task: Task) => {\n    const newStatus = task.status === 'Concluído' ? 'A Fazer' : 'Concluído'\n    setTasks(\n      tasks.map((t) => (t.id === task.id ? { ...t, status: newStatus } : t)),\n    )\n  }\n\n  const handleAddTask = () => {\n    if (!newTaskTitle.trim()) {\n      setIsAddingTask(false)\n      return\n    }\n    const newTask: Task = {\n      id: generateId('t'),\n      title: newTaskTitle.trim(),\n      projectId: funnel?.projectId || null,\n      funnelId: funnel?.id,\n      nodeId: node.id,\n      priority: 'Média',\n      status: 'A Fazer',\n      deadline: new Date(Date.now() + 86400000).toISOString(),\n    }\n    setTasks([...tasks, newTask])\n    setNewTaskTitle('')\n    setIsAddingTask(false)\n  }\n\n  const handlePointerDown = (e: React.PointerEvent) => {\n    if (e.button !== 0) return\n    const target = e.target as HTMLElement\n    if (\n      isPanMode ||\n      target.closest('button') ||\n      target.closest('.interactive-icon') ||\n      target.closest('[role=\"checkbox\"]') ||\n      target.closest('input') ||\n      target.closest('.resize-handle') ||\n      !isSelectMode\n    )\n      return\n    e.stopPropagation()\n    target.setPointerCapture(e.pointerId)\n    setIsDragging(true)\n    callbacksRef.current.onPointerDownAction(e.shiftKey)\n    document.body.style.userSelect = 'none'\n\n    const startX = e.clientX,\n      startY = e.clientY,\n      initialNodeX = node.x,\n      initialNodeY = node.y\n    const handlePointerMove = (moveEv: PointerEvent) => {\n      let dx = (moveEv.clientX - startX) / scale,\n        dy = (moveEv.clientY - startY) / scale\n      if (snapToGrid) {\n        const snappedX = Math.round((initialNodeX + dx) / 28) * 28,\n          snappedY = Math.round((initialNodeY + dy) / 28) * 28\n        dx = snappedX - initialNodeX\n        dy = snappedY - initialNodeY\n      }\n      callbacksRef.current.onMove(dx, dy)\n    }\n    const handlePointerUp = (upEv: PointerEvent) => {\n      try {\n        target.releasePointerCapture(upEv.pointerId)\n      } catch (err) {\n        /* ignore */\n      }\n      setIsDragging(false)\n      document.body.style.userSelect = ''\n      let dx = (upEv.clientX - startX) / scale,\n        dy = (upEv.clientY - startY) / scale\n      if (snapToGrid) {\n        const snappedX = Math.round((initialNodeX + dx) / 28) * 28,\n          snappedY = Math.round((initialNodeY + dy) / 28) * 28\n        dx = snappedX - initialNodeX\n        dy = snappedY - initialNodeY\n      }\n      callbacksRef.current.onMoveEnd(dx, dy)\n      window.removeEventListener('pointermove', handlePointerMove)\n      window.removeEventListener('pointerup', handlePointerUp)\n      window.removeEventListener('pointercancel', handlePointerUp)\n    }\n    window.addEventListener('pointermove', handlePointerMove)\n    window.addEventListener('pointerup', handlePointerUp)\n    window.addEventListener('pointercancel', handlePointerUp)\n  }\n\n  const handleResizeStart = (e: React.PointerEvent, corner: string) => {\n    if (e.button !== 0) return\n    e.stopPropagation()\n    const target = e.target as HTMLElement\n    target.setPointerCapture(e.pointerId)\n    setIsResizing(true)\n    callbacksRef.current.onPointerDownAction(e.shiftKey)\n    document.body.style.userSelect = 'none'\n\n    const startX = e.clientX,\n      startY = e.clientY,\n      initialX = node.x,\n      initialY = node.y,\n      initialW = node.width || 120,\n      initialH = node.height || 120\n    const isSquare = e.shiftKey\n\n    const handlePointerMove = (moveEv: PointerEvent) => {\n      let dx = (moveEv.clientX - startX) / scale,\n        dy = (moveEv.clientY - startY) / scale\n      let newX = initialX,\n        newY = initialY,\n        newW = initialW,\n        newH = initialH\n\n      if (corner.includes('e')) newW = Math.max(20, initialW + dx)\n      if (corner.includes('s')) newH = Math.max(20, initialH + dy)\n      if (corner.includes('w')) {\n        const mw = Math.max(20, initialW - dx)\n        newX = initialX + (initialW - mw)\n        newW = mw\n      }\n      if (corner.includes('n')) {\n        const mh = Math.max(20, initialH - dy)\n        newY = initialY + (initialH - mh)\n        newH = mh\n      }\n\n      if (isSquare) {\n        const size = Math.max(newW, newH)\n        newW = size\n        newH = size\n      }\n      if (snapToGrid) {\n        newX = Math.round(newX / 28) * 28\n        newY = Math.round(newY / 28) * 28\n        newW = Math.round(newW / 28) * 28\n        newH = Math.round(newH / 28) * 28\n      }\n      callbacksRef.current.onResize?.(newX, newY, newW, newH)\n    }\n\n    const handlePointerUp = (upEv: PointerEvent) => {\n      try {\n        target.releasePointerCapture(upEv.pointerId)\n      } catch (err) {\n        /* ignore */\n      }\n      setIsResizing(false)\n      document.body.style.userSelect = ''\n\n      let dx = (upEv.clientX - startX) / scale,\n        dy = (upEv.clientY - startY) / scale\n      let newX = initialX,\n        newY = initialY,\n        newW = initialW,\n        newH = initialH\n\n      if (corner.includes('e')) newW = Math.max(20, initialW + dx)\n      if (corner.includes('s')) newH = Math.max(20, initialH + dy)\n      if (corner.includes('w')) {\n        const mw = Math.max(20, initialW - dx)\n        newX = initialX + (initialW - mw)\n        newW = mw\n      }\n      if (corner.includes('n')) {\n        const mh = Math.max(20, initialH - dy)\n        newY = initialY + (initialH - mh)\n        newH = mh\n      }\n\n      if (isSquare) {\n        const size = Math.max(newW, newH)\n        newW = size\n        newH = size\n      }\n      if (snapToGrid) {\n        newX = Math.round(newX / 28) * 28\n        newY = Math.round(newY / 28) * 28\n        newW = Math.round(newW / 28) * 28\n        newH = Math.round(newH / 28) * 28\n      }\n      callbacksRef.current.onResizeEnd?.(newX, newY, newW, newH)\n      window.removeEventListener('pointermove', handlePointerMove)\n      window.removeEventListener('pointerup', handlePointerUp)\n      window.removeEventListener('pointercancel', handlePointerUp)\n    }\n    window.addEventListener('pointermove', handlePointerMove)\n    window.addEventListener('pointerup', handlePointerUp)\n    window.addEventListener('pointercancel', handlePointerUp)\n  }\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault()\n    e.stopPropagation()\n    const resType = e.dataTransfer.getData('resourceType'),\n      resId = e.dataTransfer.getData('resourceId')\n    if (resType && resId) onDropResource(resType, resId)\n  }\n\n  if (node.type === 'FloatingText') {\n    return (\n      <div\n        className={cn(\n          'absolute top-0 left-0 pointer-events-auto min-w-[50px] p-2 z-10 group outline-none',\n          selected && 'ring-2 ring-[#C2714F]/60 shadow-lg rounded-md',\n          !currentlyDragging && 'transition-transform duration-150',\n          currentlyDragging\n            ? 'opacity-95 z-50 cursor-grabbing shadow-xl ring-2 ring-[#C2714F]/30 rounded-md'\n            : isPanMode\n              ? 'cursor-grab'\n              : isSelectMode\n                ? isEditingText\n                  ? 'cursor-text'\n                  : 'cursor-pointer'\n                : '',\n        )}\n        style={{\n          transform: `translate3d(${node.x}px, ${node.y}px, 0) scale(${currentlyDragging ? 1.02 : 1})`,\n          color: node.style?.color || '#3D2B1F',\n          transformOrigin: 'center center',\n        }}\n        onPointerDown={(e) => {\n          if (isEditingText) {\n            e.stopPropagation()\n            return\n          }\n          handlePointerDown(e)\n        }}\n        onDoubleClick={(e) => {\n          if (!isPanMode && isSelectMode) {\n            e.stopPropagation()\n            setIsEditingText(true)\n            setTimeout(() => {\n              textRef.current?.focus()\n              const selection = window.getSelection()\n              const range = document.createRange()\n              range.selectNodeContents(textRef.current!)\n              selection?.removeAllRanges()\n              selection?.addRange(range)\n            }, 0)\n          }\n        }}\n        onMouseEnter={() => setIsHovered(true)}\n        onMouseLeave={() => setIsHovered(false)}\n        data-node-id={node.id}\n      >\n        <div\n          ref={textRef}\n          className=\"font-bold text-[15px] whitespace-pre-wrap outline-none min-h-[24px] min-w-[20px]\"\n          contentEditable={isEditingText}\n          suppressContentEditableWarning\n          onPointerDown={(e) => {\n            if (isEditingText) e.stopPropagation()\n          }}\n          onBlur={(e) => {\n            setIsEditingText(false)\n            onTextChange(e.currentTarget.textContent || 'Text')\n          }}\n        >\n          {node.data.name}\n        </div>\n      </div>\n    )\n  }\n\n  if (['Square', 'Diamond', 'Circle'].includes(node.type)) {\n    const w = node.width || 120,\n      h = node.height || 120\n    return (\n      <div\n        className={cn(\n          'absolute top-0 left-0 pointer-events-auto flex items-center justify-center z-10 group text-[#3D2B1F]',\n          selected && 'shadow-md',\n          !(currentlyDragging || isResizing) &&\n            'transition-transform duration-150',\n          currentlyDragging || isResizing\n            ? 'opacity-95 z-50 shadow-[0_25px_50px_-12px_rgba(0,0,0,0.25)] cursor-grabbing'\n            : isPanMode\n              ? 'cursor-grab'\n              : isSelectMode\n                ? 'cursor-pointer'\n                : '',\n        )}\n        style={{\n          transform: `translate3d(${node.x}px, ${node.y}px, 0) scale(${currentlyDragging || isResizing ? 1.02 : 1})`,\n          width: w,\n          height: h,\n          transformOrigin: 'center center',\n        }}\n        onPointerDown={handlePointerDown}\n        onMouseEnter={() => setIsHovered(true)}\n        onMouseLeave={() => setIsHovered(false)}\n        data-node-id={node.id}\n      >\n        <svg\n          className=\"absolute inset-0 w-full h-full overflow-visible pointer-events-none\"\n          viewBox={`0 0 ${w} ${h}`}\n        >\n          {node.type === 'Square' && (\n            <rect\n              x=\"0\"\n              y=\"0\"\n              width={w}\n              height={h}\n              rx={8}\n              fill={node.style?.fill || 'transparent'}\n              fillOpacity={node.style?.opacity ?? 1}\n              stroke={node.style?.stroke || '#3D2B1F'}\n              strokeWidth={node.style?.strokeWidth ?? 2}\n              strokeDasharray={\n                node.style?.strokeDasharray === 'none'\n                  ? undefined\n                  : node.style?.strokeDasharray\n              }\n              className={cn(\n                'pointer-events-auto',\n                selected && 'stroke-[#C2714F] drop-shadow-md',\n              )}\n              style={{ transition: isResizing ? 'none' : 'all 0.15s' }}\n            />\n          )}\n          {node.type === 'Circle' && (\n            <ellipse\n              cx={w / 2}\n              cy={h / 2}\n              rx={w / 2}\n              ry={h / 2}\n              fill={node.style?.fill || 'transparent'}\n              fillOpacity={node.style?.opacity ?? 1}\n              stroke={node.style?.stroke || '#3D2B1F'}\n              strokeWidth={node.style?.strokeWidth ?? 2}\n              strokeDasharray={\n                node.style?.strokeDasharray === 'none'\n                  ? undefined\n                  : node.style?.strokeDasharray\n              }\n              className={cn(\n                'pointer-events-auto',\n                selected && 'stroke-[#C2714F] drop-shadow-md',\n              )}\n              style={{ transition: isResizing ? 'none' : 'all 0.15s' }}\n            />\n          )}\n          {node.type === 'Diamond' && (\n            <polygon\n              points={`${w / 2},0 ${w},${h / 2} ${w / 2},${h} 0,${h / 2}`}\n              fill={node.style?.fill || 'transparent'}\n              fillOpacity={node.style?.opacity ?? 1}\n              stroke={node.style?.stroke || '#3D2B1F'}\n              strokeWidth={node.style?.strokeWidth ?? 2}\n              strokeDasharray={\n                node.style?.strokeDasharray === 'none'\n                  ? undefined\n                  : node.style?.strokeDasharray\n              }\n              strokeLinejoin=\"round\"\n              className={cn(\n                'pointer-events-auto',\n                selected && 'stroke-[#C2714F] drop-shadow-md',\n              )}\n              style={{ transition: isResizing ? 'none' : 'all 0.15s' }}\n            />\n          )}\n        </svg>\n        {selected && !isPanMode && isSelectMode && (\n          <>\n            <div className=\"absolute top-0 left-0 w-full h-full border border-[#C2714F]/50 pointer-events-none\" />\n            {['nw', 'ne', 'sw', 'se', 'n', 's', 'e', 'w'].map((corner) => (\n              <div\n                key={corner}\n                className={`resize-handle ${corner}-resize absolute w-3 h-3 bg-white border border-[#C2714F] rounded-sm z-30`}\n                style={{\n                  top: corner.includes('n')\n                    ? '-6px'\n                    : corner.includes('s')\n                      ? 'auto'\n                      : '50%',\n                  bottom: corner.includes('s') ? '-6px' : 'auto',\n                  left: corner.includes('w')\n                    ? '-6px'\n                    : corner.includes('e')\n                      ? 'auto'\n                      : '50%',\n                  right: corner.includes('e') ? '-6px' : 'auto',\n                  transform:\n                    corner.length === 1 ? 'translate(-50%, -50%)' : 'none',\n                  cursor: `${corner}-resize`,\n                }}\n                onPointerDown={(e) => handleResizeStart(e, corner)}\n              />\n            ))}\n          </>\n        )}\n      </div>\n    )\n  }\n\n  if (node.type === 'Text') {\n    return (\n      <div\n        className={cn(\n          'absolute top-0 left-0 pointer-events-auto min-w-[150px] max-w-[400px] p-4 bg-[#FAF7F2] rounded-xl shadow-sm border border-[#E8E2D9] text-[#3D2B1F] z-10 group',\n          selected && 'ring-2 ring-[#C2714F]/60 shadow-md',\n          !currentlyDragging && 'transition-transform duration-150',\n          currentlyDragging\n            ? 'opacity-95 z-50 cursor-grabbing shadow-xl ring-2 ring-[#C2714F]/50'\n            : isPanMode\n              ? 'cursor-grab'\n              : isSelectMode\n                ? isEditingText\n                  ? 'cursor-text'\n                  : 'cursor-pointer'\n                : '',\n        )}\n        style={{\n          transform: `translate3d(${node.x}px, ${node.y}px, 0) scale(${currentlyDragging ? 1.02 : 1})`,\n          transformOrigin: 'center center',\n        }}\n        onPointerDown={(e) => {\n          if (isEditingText) {\n            e.stopPropagation()\n            return\n          }\n          handlePointerDown(e)\n        }}\n        onDoubleClick={(e) => {\n          if (!isPanMode && isSelectMode) {\n            e.stopPropagation()\n            setIsEditingText(true)\n            setTimeout(() => textRef.current?.focus(), 0)\n          }\n        }}\n      >\n        <div\n          ref={textRef}\n          className=\"font-bold text-[15px] whitespace-pre-wrap outline-none cursor-text\"\n          contentEditable={isEditingText}\n          suppressContentEditableWarning\n          onPointerDown={(e) => {\n            if (isEditingText) e.stopPropagation()\n          }}\n          onBlur={(e) => {\n            setIsEditingText(false)\n            onTextChange(e.currentTarget.textContent || 'Text')\n          }}\n        >\n          {node.data.name}\n        </div>\n      </div>\n    )\n  }\n\n  if (node.type === 'Image') {\n    return (\n      <div\n        className={cn(\n          'absolute top-0 left-0 pointer-events-auto w-[300px] rounded-2xl shadow-sm border border-[#E8E2D9] bg-white z-10 overflow-hidden group',\n          selected && 'ring-4 ring-[#C2714F]/40 border-[#C2714F] shadow-md',\n          !currentlyDragging && 'transition-transform duration-150',\n          currentlyDragging\n            ? 'opacity-95 z-50 cursor-grabbing shadow-xl ring-4 ring-[#C2714F]/50'\n            : isPanMode\n              ? 'cursor-grab'\n              : isSelectMode\n                ? 'cursor-pointer'\n                : '',\n        )}\n        style={{\n          transform: `translate3d(${node.x}px, ${node.y}px, 0) scale(${currentlyDragging ? 1.02 : 1})`,\n          transformOrigin: 'center center',\n        }}\n        onPointerDown={handlePointerDown}\n        onDoubleClick={(e) => {\n          if (!isPanMode && isSelectMode) {\n            e.stopPropagation()\n            onOpenRightPanel('assets')\n          }\n        }}\n      >\n        <img\n          src={node.data.name}\n          alt=\"Canvas\"\n          className=\"w-full h-auto object-cover pointer-events-none select-none\"\n        />\n      </div>\n    )\n  }\n\n  const isTraffic = ['Ad', 'Traffic', 'Goal', 'Email'].includes(node.type)\n  const isFeatured = ['VSL', 'Webinar'].includes(node.type)\n  const isStandard = !isTraffic && !isFeatured\n  const customColor = node.data.color\n  const Icon = icons[node.type] || icons.Default\n\n  return (\n    <div\n      className={cn(\n        'absolute top-0 left-0 pointer-events-auto w-[280px] rounded-[1.25rem] p-5 z-10 flex flex-col gap-3 group select-none duration-200',\n        !currentlyDragging\n          ? 'transition-[box-shadow,background-color,border-color,opacity,transform]'\n          : 'transition-[box-shadow,background-color,border-color,opacity]',\n        !customColor &&\n          isTraffic &&\n          'bg-[#3D2B1F] border border-[#3D2B1F] shadow-lg',\n        !customColor &&\n          isFeatured &&\n          'bg-white border-2 border-[#C2714F] shadow-2xl',\n        !customColor &&\n          isStandard &&\n          'bg-white border border-[#E8E2D9] shadow-sm',\n        customColor && 'bg-white border shadow-md',\n        isHovered && !selected && !isFeatured && !customColor && 'shadow-md',\n        selected && 'ring-4 ring-[#C2714F]/20 border-[#C2714F] shadow-xl',\n        currentlyDragging && 'opacity-95 z-50 shadow-2xl',\n        node.data.isCompleted && 'opacity-70 grayscale-[30%]',\n      )}\n      style={{\n        transform: `translate3d(${node.x}px, ${node.y}px, 0) scale(${currentlyDragging ? 1.03 : 1})`,\n        cursor: isPanMode\n          ? 'grab'\n          : currentlyDragging\n            ? 'grabbing'\n            : isSelectMode\n              ? 'pointer'\n              : '',\n        transformOrigin: 'center center',\n        borderColor: customColor && !selected ? customColor : undefined,\n        borderWidth: customColor && !selected ? '2px' : undefined,\n      }}\n      onPointerDown={handlePointerDown}\n      onDoubleClick={(e) => {\n        if (!isPanMode && isSelectMode) {\n          e.stopPropagation()\n          onOpenRightPanel('details')\n        }\n      }}\n      onMouseEnter={() => setIsHovered(true)}\n      onMouseLeave={() => setIsHovered(false)}\n      onDragOver={(e) => {\n        e.preventDefault()\n        e.stopPropagation()\n      }}\n      onDrop={handleDrop}\n      data-node-id={node.id}\n    >\n      <div className=\"absolute -top-3.5 right-4 flex items-center gap-1.5 z-20\">\n        <div\n          className={cn(\n            'flex items-center gap-1.5 transition-opacity',\n            selected || isHovered\n              ? 'opacity-100'\n              : 'opacity-0 pointer-events-none',\n          )}\n        >\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <button\n                onClick={(e) => {\n                  e.stopPropagation()\n                  onOpenSettings()\n                }}\n                className=\"interactive-icon w-7 h-7 bg-white border border-[#E8E2D9] rounded-full flex items-center justify-center text-[#8C7B6C] hover:text-[#3D2B1F] shadow-sm transition-transform hover:scale-110\"\n              >\n                <Settings size={13} strokeWidth={2.5} />\n              </button>\n            </TooltipTrigger>\n            <TooltipContent>Configurações</TooltipContent>\n          </Tooltip>\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <button\n                onClick={(e) => {\n                  e.stopPropagation()\n                  onDelete()\n                }}\n                className=\"interactive-icon w-7 h-7 bg-white border border-[#E8E2D9] rounded-full flex items-center justify-center text-red-500 hover:text-red-700 shadow-sm transition-transform hover:scale-110\"\n              >\n                <Trash2 size={13} strokeWidth={2.5} />\n              </button>\n            </TooltipTrigger>\n            <TooltipContent>Excluir</TooltipContent>\n          </Tooltip>\n        </div>\n      </div>\n\n      <div className=\"flex items-center gap-3\">\n        <div\n          className={cn(\n            'w-10 h-10 rounded-xl flex items-center justify-center shrink-0 shadow-sm',\n            !customColor &&\n              (isTraffic\n                ? 'bg-[#C2714F] text-white'\n                : 'bg-[#FAF7F2] text-[#C2714F] border border-[#E8E2D9]'),\n          )}\n          style={\n            customColor\n              ? { backgroundColor: customColor, color: '#fff' }\n              : undefined\n          }\n        >\n          <Icon size={20} strokeWidth={2} />\n        </div>\n        <div className=\"flex flex-col min-w-0 flex-1\">\n          <h4\n            className={cn(\n              'font-bold text-[15px] truncate leading-tight transition-all',\n              isTraffic && !customColor ? 'text-white' : 'text-[#3D2B1F]',\n              node.data.isCompleted && 'line-through opacity-70',\n            )}\n          >\n            {node.data.name}\n          </h4>\n          <span\n            className={cn(\n              'text-[12px] mt-0.5 truncate font-medium',\n              isTraffic && !customColor ? 'text-white/70' : 'text-[#8C7B6C]',\n            )}\n          >\n            {node.data.subtitle || node.type}\n          </span>\n        </div>\n      </div>\n\n      {node.data.isTaskMode && (\n        <div className=\"mt-2 flex flex-col gap-1.5\">\n          {linkedTasks.length > 0 && (\n            <div\n              className={cn(\n                'h-px w-full my-1 rounded-full',\n                isTraffic && !customColor ? 'bg-white/10' : 'bg-[#E8E2D9]',\n              )}\n            />\n          )}\n          {linkedTasks.map((task) => (\n            <div\n              key={task.id}\n              className=\"flex items-start gap-2 group/task relative pr-4\"\n            >\n              <Checkbox\n                checked={task.status === 'Concluído'}\n                onCheckedChange={() => handleToggleTask(task)}\n                className={cn(\n                  'mt-0.5 w-3.5 h-3.5 rounded-[4px] border',\n                  isTraffic && !customColor\n                    ? 'border-white/30 data-[state=checked]:bg-white data-[state=checked]:text-[#3D2B1F]'\n                    : 'border-[#E8E2D9] data-[state=checked]:bg-[#C2714F] data-[state=checked]:border-[#C2714F]',\n                )}\n              />\n              <span\n                className={cn(\n                  'text-[12px] leading-tight font-bold flex-1 transition-all break-words',\n                  task.status === 'Concluído'\n                    ? isTraffic && !customColor\n                      ? 'text-white/40 line-through'\n                      : 'text-[#8C7B6C] line-through'\n                    : isTraffic && !customColor\n                      ? 'text-white'\n                      : 'text-[#3D2B1F]',\n                )}\n              >\n                {task.title}\n              </span>\n            </div>\n          ))}\n          {isAddingTask ? (\n            <div className=\"flex items-center gap-1.5 mt-1\">\n              <input\n                autoFocus\n                type=\"text\"\n                value={newTaskTitle}\n                onChange={(e) => setNewTaskTitle(e.target.value)}\n                onKeyDown={(e) => {\n                  if (e.key === 'Enter') {\n                    e.preventDefault()\n                    handleAddTask()\n                  }\n                  if (e.key === 'Escape') {\n                    setIsAddingTask(false)\n                    setNewTaskTitle('')\n                  }\n                }}\n                onBlur={() =>\n                  newTaskTitle.trim() ? handleAddTask() : setIsAddingTask(false)\n                }\n                placeholder=\"Nome da tarefa...\"\n                className={cn(\n                  'flex-1 text-[12px] border rounded px-2 py-1 outline-none transition-all w-full font-bold',\n                  isTraffic && !customColor\n                    ? 'bg-white/10 border-white/20 text-white placeholder:text-white/40 focus:border-white/50'\n                    : 'bg-[#FAF7F2] border-[#E8E2D9] text-[#3D2B1F] placeholder:text-[#8C7B6C] focus:border-[#C2714F]',\n                )}\n              />\n            </div>\n          ) : (\n            <button\n              onClick={(e) => {\n                e.stopPropagation()\n                setIsAddingTask(true)\n              }}\n              className={cn(\n                'flex items-center gap-1.5 mt-1 text-[12px] font-bold transition-colors w-full text-left py-0.5 rounded-sm interactive-icon',\n                isTraffic && !customColor\n                  ? 'text-white/50 hover:text-white'\n                  : 'text-[#8C7B6C] hover:text-[#C2714F]',\n              )}\n            >\n              <Plus size={12} strokeWidth={2.5} /> Adicionar tarefa\n            </button>\n          )}\n        </div>\n      )}\n\n      {!isPanMode && isSelectMode && (\n        <div\n          className=\"absolute -right-3 top-1/2 -translate-y-1/2 w-6 h-6 flex items-center justify-center cursor-crosshair z-20 group/port interactive-icon opacity-0 group-hover:opacity-100 transition-opacity\"\n          onPointerDown={(e) => {\n            e.stopPropagation()\n            onEdgeDragStart(node.id, e)\n          }}\n        >\n          <div className=\"w-3 h-3 rounded-full bg-white border-2 border-[#E8E2D9] group-hover/port:border-[#C2714F] group-hover/port:bg-[#C2714F] group-hover/port:scale-125 transition-all shadow-sm\" />\n        </div>\n      )}\n\n      <div className=\"absolute -bottom-4 left-1/2 -translate-x-1/2 z-20 opacity-0 group-hover:opacity-100 transition-opacity\">\n        <button\n          onClick={(e) => {\n            e.stopPropagation()\n            onAddChild()\n          }}\n          className=\"interactive-icon w-8 h-8 bg-white border border-[#E8E2D9] rounded-full shadow-sm flex items-center justify-center text-[#8C7B6C] hover:text-[#C2714F] hover:border-[#C2714F] transition-all\"\n        >\n          <Plus size={14} strokeWidth={2.5} />\n        </button>\n      </div>\n    </div>\n  )\n}\n","\"use client\";\n\n// src/switch.tsx\nimport * as React from \"react\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport { createContextScope } from \"@radix-ui/react-context\";\nimport { useControllableState } from \"@radix-ui/react-use-controllable-state\";\nimport { usePrevious } from \"@radix-ui/react-use-previous\";\nimport { useSize } from \"@radix-ui/react-use-size\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { jsx, jsxs } from \"react/jsx-runtime\";\nvar SWITCH_NAME = \"Switch\";\nvar [createSwitchContext, createSwitchScope] = createContextScope(SWITCH_NAME);\nvar [SwitchProvider, useSwitchContext] = createSwitchContext(SWITCH_NAME);\nvar Switch = React.forwardRef(\n  (props, forwardedRef) => {\n    const {\n      __scopeSwitch,\n      name,\n      checked: checkedProp,\n      defaultChecked,\n      required,\n      disabled,\n      value = \"on\",\n      onCheckedChange,\n      form,\n      ...switchProps\n    } = props;\n    const [button, setButton] = React.useState(null);\n    const composedRefs = useComposedRefs(forwardedRef, (node) => setButton(node));\n    const hasConsumerStoppedPropagationRef = React.useRef(false);\n    const isFormControl = button ? form || !!button.closest(\"form\") : true;\n    const [checked, setChecked] = useControllableState({\n      prop: checkedProp,\n      defaultProp: defaultChecked ?? false,\n      onChange: onCheckedChange,\n      caller: SWITCH_NAME\n    });\n    return /* @__PURE__ */ jsxs(SwitchProvider, { scope: __scopeSwitch, checked, disabled, children: [\n      /* @__PURE__ */ jsx(\n        Primitive.button,\n        {\n          type: \"button\",\n          role: \"switch\",\n          \"aria-checked\": checked,\n          \"aria-required\": required,\n          \"data-state\": getState(checked),\n          \"data-disabled\": disabled ? \"\" : void 0,\n          disabled,\n          value,\n          ...switchProps,\n          ref: composedRefs,\n          onClick: composeEventHandlers(props.onClick, (event) => {\n            setChecked((prevChecked) => !prevChecked);\n            if (isFormControl) {\n              hasConsumerStoppedPropagationRef.current = event.isPropagationStopped();\n              if (!hasConsumerStoppedPropagationRef.current) event.stopPropagation();\n            }\n          })\n        }\n      ),\n      isFormControl && /* @__PURE__ */ jsx(\n        SwitchBubbleInput,\n        {\n          control: button,\n          bubbles: !hasConsumerStoppedPropagationRef.current,\n          name,\n          value,\n          checked,\n          required,\n          disabled,\n          form,\n          style: { transform: \"translateX(-100%)\" }\n        }\n      )\n    ] });\n  }\n);\nSwitch.displayName = SWITCH_NAME;\nvar THUMB_NAME = \"SwitchThumb\";\nvar SwitchThumb = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeSwitch, ...thumbProps } = props;\n    const context = useSwitchContext(THUMB_NAME, __scopeSwitch);\n    return /* @__PURE__ */ jsx(\n      Primitive.span,\n      {\n        \"data-state\": getState(context.checked),\n        \"data-disabled\": context.disabled ? \"\" : void 0,\n        ...thumbProps,\n        ref: forwardedRef\n      }\n    );\n  }\n);\nSwitchThumb.displayName = THUMB_NAME;\nvar BUBBLE_INPUT_NAME = \"SwitchBubbleInput\";\nvar SwitchBubbleInput = React.forwardRef(\n  ({\n    __scopeSwitch,\n    control,\n    checked,\n    bubbles = true,\n    ...props\n  }, forwardedRef) => {\n    const ref = React.useRef(null);\n    const composedRefs = useComposedRefs(ref, forwardedRef);\n    const prevChecked = usePrevious(checked);\n    const controlSize = useSize(control);\n    React.useEffect(() => {\n      const input = ref.current;\n      if (!input) return;\n      const inputProto = window.HTMLInputElement.prototype;\n      const descriptor = Object.getOwnPropertyDescriptor(\n        inputProto,\n        \"checked\"\n      );\n      const setChecked = descriptor.set;\n      if (prevChecked !== checked && setChecked) {\n        const event = new Event(\"click\", { bubbles });\n        setChecked.call(input, checked);\n        input.dispatchEvent(event);\n      }\n    }, [prevChecked, checked, bubbles]);\n    return /* @__PURE__ */ jsx(\n      \"input\",\n      {\n        type: \"checkbox\",\n        \"aria-hidden\": true,\n        defaultChecked: checked,\n        ...props,\n        tabIndex: -1,\n        ref: composedRefs,\n        style: {\n          ...props.style,\n          ...controlSize,\n          position: \"absolute\",\n          pointerEvents: \"none\",\n          opacity: 0,\n          margin: 0\n        }\n      }\n    );\n  }\n);\nSwitchBubbleInput.displayName = BUBBLE_INPUT_NAME;\nfunction getState(checked) {\n  return checked ? \"checked\" : \"unchecked\";\n}\nvar Root = Switch;\nvar Thumb = SwitchThumb;\nexport {\n  Root,\n  Switch,\n  SwitchThumb,\n  Thumb,\n  createSwitchScope\n};\n//# sourceMappingURL=index.mjs.map\n","import * as React from 'react'\nimport * as SwitchPrimitives from '@radix-ui/react-switch'\n\nimport { cn } from '@/lib/utils'\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      'peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-[#C2714F] data-[state=unchecked]:bg-[#E8E2D9]',\n      className,\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        'pointer-events-none block h-5 w-5 rounded-full bg-white shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0',\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","import { Node, Funnel, Task, Resource } from '@/types'\nimport { generateId } from '@/lib/generateId'\nimport { useState, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport {\n  X,\n  FileText,\n  CheckSquare,\n  Image as ImageIcon,\n  Plus,\n} from 'lucide-react'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport useDocumentStore from '@/stores/useDocumentStore'\nimport useTaskStore from '@/stores/useTaskStore'\nimport useResourceStore from '@/stores/useResourceStore'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { Dialog, DialogContent, DialogTitle } from '@/components/ui/dialog'\nimport { Switch } from '@/components/ui/switch'\nimport { cn } from '@/lib/utils'\n\nexport default function RightPanel({\n  node,\n  funnel,\n  defaultTab = 'details',\n  hideHeader,\n  onChange,\n  onClose,\n}: {\n  node: Node\n  funnel: Funnel\n  defaultTab?: string\n  hideHeader?: boolean\n  onChange: (n: Node) => void\n  onClose: () => void\n}) {\n  const [docs, setDocs] = useDocumentStore()\n  const [tasks, setTasks] = useTaskStore()\n  const [resources, setResources] = useResourceStore()\n  const [activeTab, setActiveTab] = useState(defaultTab)\n  const [inspectResource, setInspectResource] = useState<Resource | null>(null)\n\n  // Local state for Conf tab properties\n  const [name, setName] = useState(node.data.name || '')\n  const [subtitle, setSubtitle] = useState(node.data.subtitle || '')\n  const [isTaskMode, setIsTaskMode] = useState(node.data.isTaskMode || false)\n  const [notes, setNotes] = useState(node.data.notes || '')\n\n  useEffect(() => {\n    setActiveTab(defaultTab)\n  }, [defaultTab, node.id])\n\n  useEffect(() => {\n    setName(node.data.name || '')\n    setSubtitle(node.data.subtitle || '')\n    setIsTaskMode(node.data.isTaskMode || false)\n    setNotes(node.data.notes || '')\n  }, [node])\n\n  const handleSave = () => {\n    onChange({\n      ...node,\n      data: {\n        ...node.data,\n        name,\n        subtitle,\n        isTaskMode,\n        notes,\n      },\n    })\n    onClose()\n  }\n\n  const linkedDocs = docs.filter((d) =>\n    node.data.linkedDocumentIds?.includes(d.id),\n  )\n  const linkedTasks = tasks.filter(\n    (t) => t.nodeId === node.id || node.data.linkedTaskIds?.includes(t.id),\n  )\n  const linkedResources = resources.filter((a) =>\n    node.data.linkedAssetIds?.includes(a.id),\n  )\n\n  const projDocs = docs.filter(\n    (d) =>\n      d.projectId === funnel.projectId &&\n      !node.data.linkedDocumentIds?.includes(d.id),\n  )\n  const projTasks = tasks.filter(\n    (t) =>\n      t.projectId === funnel.projectId &&\n      t.nodeId !== node.id &&\n      !node.data.linkedTaskIds?.includes(t.id),\n  )\n  const projResources = resources.filter(\n    (a) =>\n      a.projectId === funnel.projectId &&\n      !node.data.linkedAssetIds?.includes(a.id),\n  )\n\n  const linkResource = (type: 'doc' | 'task' | 'asset', id: string) => {\n    const key =\n      type === 'doc'\n        ? 'linkedDocumentIds'\n        : type === 'task'\n          ? 'linkedTaskIds'\n          : 'linkedAssetIds'\n    onChange({\n      ...node,\n      data: {\n        ...node.data,\n        name,\n        subtitle,\n        isTaskMode,\n        notes,\n        [key]: [\n          ...((node.data[key as keyof typeof node.data] as string[]) || []),\n          id,\n        ],\n      },\n    })\n    if (type === 'doc')\n      setDocs(\n        docs.map((d) =>\n          d.id === id ? { ...d, funnelId: funnel.id, nodeId: node.id } : d,\n        ),\n      )\n    if (type === 'task')\n      setTasks(\n        tasks.map((t) =>\n          t.id === id ? { ...t, funnelId: funnel.id, nodeId: node.id } : t,\n        ),\n      )\n  }\n\n  const handleCreateTask = () => {\n    const newTask: Task = {\n      id: generateId('t'),\n      title: 'Nova Tarefa do Nó',\n      projectId: funnel.projectId,\n      funnelId: funnel.id,\n      nodeId: node.id,\n      priority: 'Média',\n      status: 'A Fazer',\n      deadline: new Date(Date.now() + 86400000).toISOString(),\n    }\n    setTasks([...tasks, newTask])\n    onChange({\n      ...node,\n      data: {\n        ...node.data,\n        name,\n        subtitle,\n        isTaskMode,\n        notes,\n        linkedTaskIds: [...(node.data.linkedTaskIds || []), newTask.id],\n      },\n    })\n  }\n\n  return (\n    <div\n      className={cn(\n        'w-80 bg-white border-l border-[#E8E2D9] flex flex-col shadow-2xl z-30 shrink-0 absolute right-0 bottom-0 rounded-tl-2xl transition-all',\n        hideHeader ? 'top-0' : 'top-20',\n      )}\n    >\n      <div className=\"px-6 py-6 border-b border-[#E8E2D9] shrink-0\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <span className=\"text-[11px] font-bold text-[#8C7B6C] uppercase tracking-widest\">\n            Propriedades do Nó\n          </span>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={onClose}\n            className=\"text-[#8C7B6C] hover:text-[#3D2B1F] hover:bg-[#FAF7F2] w-8 h-8 rounded-full\"\n          >\n            <X size={16} />\n          </Button>\n        </div>\n        <input\n          className=\"w-full bg-transparent text-2xl font-black text-[#3D2B1F] outline-none placeholder:text-[#8C7B6C]\"\n          value={name}\n          onChange={(e) => setName(e.target.value)}\n          placeholder=\"Nome do Nó\"\n        />\n      </div>\n\n      <Tabs\n        value={activeTab}\n        onValueChange={setActiveTab}\n        className=\"flex-1 flex flex-col min-h-0 overflow-hidden\"\n      >\n        <TabsList className=\"mx-6 mt-6 grid grid-cols-4 bg-[#FAF7F2] p-1 rounded-xl border border-[#E8E2D9]\">\n          <TabsTrigger\n            value=\"details\"\n            className=\"text-[11px] font-bold rounded-lg data-[state=active]:bg-white data-[state=active]:text-[#C2714F] data-[state=active]:shadow-sm\"\n          >\n            Conf\n          </TabsTrigger>\n          <TabsTrigger\n            value=\"content\"\n            className=\"text-[11px] font-bold rounded-lg data-[state=active]:bg-white data-[state=active]:text-[#C2714F] data-[state=active]:shadow-sm\"\n          >\n            Docs\n          </TabsTrigger>\n          <TabsTrigger\n            value=\"tasks\"\n            className=\"text-[11px] font-bold rounded-lg data-[state=active]:bg-white data-[state=active]:text-[#C2714F] data-[state=active]:shadow-sm\"\n          >\n            Tasks\n          </TabsTrigger>\n          <TabsTrigger\n            value=\"resources\"\n            className=\"text-[11px] font-bold rounded-lg data-[state=active]:bg-white data-[state=active]:text-[#C2714F] data-[state=active]:shadow-sm\"\n          >\n            Assets\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent\n          value=\"details\"\n          className=\"flex-1 overflow-auto p-6 space-y-6 m-0 border-none outline-none no-scrollbar\"\n        >\n          <div className=\"space-y-2\">\n            <Label className=\"text-[11px] font-bold text-[#8C7B6C] uppercase tracking-widest block mb-1.5\">\n              Subtítulo\n            </Label>\n            <Input\n              className=\"h-12 bg-[#FAF7F2] border-[#E8E2D9] rounded-xl px-4 text-sm font-bold text-[#3D2B1F] shadow-none focus-visible:ring-[#C2714F]/20\"\n              value={subtitle}\n              onChange={(e) => setSubtitle(e.target.value)}\n              placeholder=\"+1 filter\"\n            />\n          </div>\n\n          <div className=\"flex items-center justify-between p-4 bg-[#FAF7F2] border border-[#E8E2D9] rounded-xl\">\n            <div className=\"flex flex-col space-y-0.5\">\n              <Label className=\"text-[14px] font-bold text-[#3D2B1F]\">\n                Modo Tarefa\n              </Label>\n              <span className=\"text-[12px] font-medium text-[#8C7B6C]\">\n                Habilitar checklist\n              </span>\n            </div>\n            <Switch checked={isTaskMode} onCheckedChange={setIsTaskMode} />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label className=\"text-[11px] font-bold text-[#8C7B6C] uppercase tracking-widest block mb-1.5\">\n              Notas Adicionais\n            </Label>\n            <Textarea\n              value={notes}\n              onChange={(e) => setNotes(e.target.value)}\n              placeholder=\"Adicione contexto aqui...\"\n              className=\"min-h-[160px] bg-[#FAF7F2] border border-[#E8E2D9] shadow-none focus-visible:ring-[#C2714F]/20 rounded-xl p-4 resize-none text-sm font-medium text-[#3D2B1F]\"\n            />\n          </div>\n        </TabsContent>\n\n        <TabsContent\n          value=\"content\"\n          className=\"flex-1 overflow-auto p-6 space-y-6 m-0 border-none outline-none no-scrollbar\"\n        >\n          <div className=\"flex items-center gap-2\">\n            <Select onValueChange={(val) => linkResource('doc', val)}>\n              <SelectTrigger className=\"flex-1 bg-[#FAF7F2] border-[#E8E2D9] rounded-xl text-[#3D2B1F] font-bold h-11\">\n                <SelectValue placeholder=\"Vincular Documento...\" />\n              </SelectTrigger>\n              <SelectContent className=\"rounded-xl border-[#E8E2D9]\">\n                {projDocs.map((d) => (\n                  <SelectItem\n                    key={d.id}\n                    value={d.id}\n                    className=\"font-bold text-[#3D2B1F]\"\n                  >\n                    <div className=\"flex items-center gap-2\">\n                      <FileText size={14} className=\"text-[#8C7B6C]\" />\n                      {d.title}\n                    </div>\n                  </SelectItem>\n                ))}\n                {projDocs.length === 0 && (\n                  <div className=\"p-2 text-sm text-[#8C7B6C] text-center font-bold\">\n                    Nenhum documento\n                  </div>\n                )}\n              </SelectContent>\n            </Select>\n          </div>\n          {linkedDocs.map((doc) => (\n            <div\n              key={doc.id}\n              className=\"space-y-3 border border-[#E8E2D9] rounded-xl p-4 bg-white shadow-sm\"\n            >\n              <div className=\"font-black text-[#3D2B1F] flex items-center gap-2 border-b border-[#E8E2D9] pb-3\">\n                <FileText size={16} className=\"text-[#C2714F]\" /> {doc.title}\n              </div>\n              <div\n                contentEditable\n                className=\"min-h-[150px] outline-none text-sm text-[#8C7B6C] font-medium\"\n                dangerouslySetInnerHTML={{ __html: doc.content }}\n                onBlur={(e) =>\n                  setDocs(\n                    docs.map((d) =>\n                      d.id === doc.id\n                        ? { ...d, content: e.currentTarget.innerHTML }\n                        : d,\n                    ),\n                  )\n                }\n              />\n            </div>\n          ))}\n        </TabsContent>\n\n        <TabsContent\n          value=\"tasks\"\n          className=\"flex-1 overflow-auto p-6 space-y-6 m-0 border-none outline-none no-scrollbar\"\n        >\n          <div className=\"flex items-center gap-2\">\n            <Select onValueChange={(val) => linkResource('task', val)}>\n              <SelectTrigger className=\"flex-1 bg-[#FAF7F2] border-[#E8E2D9] rounded-xl text-[#3D2B1F] font-bold h-11\">\n                <SelectValue placeholder=\"Importar Tarefa...\" />\n              </SelectTrigger>\n              <SelectContent className=\"rounded-xl border-[#E8E2D9]\">\n                {projTasks.map((t) => (\n                  <SelectItem\n                    key={t.id}\n                    value={t.id}\n                    className=\"font-bold text-[#3D2B1F]\"\n                  >\n                    <div className=\"flex items-center gap-2\">\n                      <CheckSquare size={14} className=\"text-[#8C7B6C]\" />\n                      {t.title}\n                    </div>\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n            <Button\n              className=\"bg-[#FAF7F2] text-[#3D2B1F] hover:bg-[#E8E2D9] border border-[#E8E2D9] rounded-xl w-11 h-11 p-0 shrink-0\"\n              onClick={handleCreateTask}\n            >\n              <Plus size={16} />\n            </Button>\n          </div>\n          <div className=\"space-y-3\">\n            {linkedTasks.map((t) => (\n              <div\n                key={t.id}\n                className=\"p-4 border border-[#E8E2D9] rounded-xl bg-[#FAF7F2] flex flex-col gap-3\"\n              >\n                <div className=\"flex justify-between items-start\">\n                  <span className=\"font-bold text-sm text-[#3D2B1F] leading-tight\">\n                    {t.title}\n                  </span>\n                  <Badge\n                    variant=\"outline\"\n                    className=\"border-[#C2714F] text-[#C2714F] shrink-0 ml-2\"\n                  >\n                    {t.status}\n                  </Badge>\n                </div>\n              </div>\n            ))}\n          </div>\n        </TabsContent>\n\n        <TabsContent\n          value=\"resources\"\n          className=\"flex-1 overflow-auto p-6 space-y-6 m-0 border-none outline-none no-scrollbar\"\n        >\n          <div className=\"flex items-center gap-2\">\n            <Select onValueChange={(val) => linkResource('asset', val)}>\n              <SelectTrigger className=\"flex-1 bg-[#FAF7F2] border-[#E8E2D9] rounded-xl text-[#3D2B1F] font-bold h-11\">\n                <SelectValue placeholder=\"Vincular Recurso...\" />\n              </SelectTrigger>\n              <SelectContent className=\"rounded-xl border-[#E8E2D9]\">\n                {projResources.map((a) => (\n                  <SelectItem\n                    key={a.id}\n                    value={a.id}\n                    className=\"font-bold text-[#3D2B1F]\"\n                  >\n                    <div className=\"flex items-center gap-2\">\n                      <ImageIcon size={14} className=\"text-[#8C7B6C]\" />\n                      {a.title}\n                    </div>\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n          <div className=\"flex flex-col gap-4\">\n            {linkedResources.map((a) => (\n              <div\n                key={a.id}\n                className=\"rounded-xl overflow-hidden border border-[#E8E2D9] bg-white cursor-pointer hover:border-[#C2714F] transition-colors\"\n                onClick={() => a.type === 'image' && setInspectResource(a)}\n              >\n                {a.type === 'image' ? (\n                  <img\n                    src={a.content}\n                    alt={a.title}\n                    className=\"w-full aspect-video object-cover\"\n                  />\n                ) : (\n                  <div className=\"p-4 text-sm font-medium text-[#8C7B6C] bg-[#FAF7F2]\">\n                    {a.content}\n                  </div>\n                )}\n                <div className=\"p-3 text-[13px] font-bold text-[#3D2B1F] border-t border-[#E8E2D9]\">\n                  {a.title}\n                </div>\n              </div>\n            ))}\n          </div>\n        </TabsContent>\n      </Tabs>\n\n      <div className=\"p-6 border-t border-[#E8E2D9] shrink-0 bg-white\">\n        <Button\n          className=\"w-full bg-[#C2714F] hover:bg-[#a65d3f] text-white rounded-xl h-12 font-bold shadow-md transition-transform active:scale-[0.98]\"\n          onClick={handleSave}\n        >\n          Salvar Alterações\n        </Button>\n      </div>\n\n      <Dialog\n        open={!!inspectResource}\n        onOpenChange={(open) => !open && setInspectResource(null)}\n      >\n        <DialogContent className=\"max-w-7xl w-full h-[90vh] p-0 bg-black/95 border-none shadow-2xl flex flex-col overflow-hidden rounded-none sm:rounded-none\">\n          <DialogTitle className=\"sr-only\">Inspeção de Recurso</DialogTitle>\n          <div className=\"absolute top-6 left-6 text-white font-bold text-xl z-10 drop-shadow-md\">\n            {inspectResource?.title}\n          </div>\n          <div className=\"flex-1 flex items-center justify-center p-8 overflow-auto\">\n            <img\n              src={inspectResource?.content}\n              alt={inspectResource?.title}\n              className=\"max-w-full max-h-full object-contain rounded-xl\"\n            />\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  )\n}\n","import { useState, useEffect } from 'react'\nimport { Node, NodeData, Task } from '@/types'\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from '@/components/ui/dialog'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Switch } from '@/components/ui/switch'\nimport { Label } from '@/components/ui/label'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { Checkbox } from '@/components/ui/checkbox'\nimport {\n  X,\n  Plus,\n  Trash2,\n  FileText,\n  Link as LinkIcon,\n  Image as ImageIcon,\n} from 'lucide-react'\nimport { generateId } from '@/lib/generateId'\nimport { cn } from '@/lib/utils'\nimport useDocumentStore from '@/stores/useDocumentStore'\nimport useResourceStore from '@/stores/useResourceStore'\nimport useTaskStore from '@/stores/useTaskStore'\nimport useFunnelStore from '@/stores/useFunnelStore'\n\ntype NodeSettingsModalProps = {\n  node: Node | null\n  isOpen: boolean\n  onClose: () => void\n  onSave: (id: string, updates: Partial<NodeData>) => void\n}\n\nexport function NodeSettingsModal({\n  node,\n  isOpen,\n  onClose,\n  onSave,\n}: NodeSettingsModalProps) {\n  const [name, setName] = useState('')\n  const [subtitle, setSubtitle] = useState('')\n  const [description, setDescription] = useState('')\n  const [isTaskMode, setIsTaskMode] = useState(false)\n  const [linkedDocs, setLinkedDocs] = useState<string[]>([])\n  const [linkedAssets, setLinkedAssets] = useState<string[]>([])\n\n  const [docs] = useDocumentStore()\n  const [resources] = useResourceStore()\n  const [tasks, setTasks] = useTaskStore()\n  const [funnels] = useFunnelStore()\n\n  const currentFunnel = funnels.find((f) =>\n    f.nodes.some((n) => n.id === node?.id),\n  )\n  const nodeTasks = tasks.filter(\n    (t) => t.nodeId === node?.id || node?.data.linkedTaskIds?.includes(t.id),\n  )\n\n  useEffect(() => {\n    if (isOpen && node) {\n      setName(node.data.name || '')\n      setSubtitle(node.data.subtitle || '')\n      setDescription(node.data.description || '')\n      setIsTaskMode(node.data.isTaskMode || false)\n      setLinkedDocs(node.data.linkedDocumentIds || [])\n      setLinkedAssets(node.data.linkedAssetIds || [])\n    }\n  }, [isOpen, node])\n\n  if (!node) return null\n\n  const handleSave = () => {\n    onSave(node.id, {\n      subtitle,\n      description,\n      isTaskMode,\n      linkedDocumentIds: linkedDocs,\n      linkedAssetIds: linkedAssets,\n    })\n    onClose()\n  }\n\n  const addTask = () => {\n    const newTask: Task = {\n      id: generateId('t'),\n      title: 'Nova Tarefa',\n      nodeId: node.id,\n      funnelId: currentFunnel?.id,\n      priority: 'Média',\n      status: 'Pendente',\n    }\n    setTasks([...tasks, newTask])\n  }\n  const updateTask = (id: string, updates: Partial<Task>) =>\n    setTasks(tasks.map((t) => (t.id === id ? { ...t, ...updates } : t)))\n  const removeTask = (id: string) => setTasks(tasks.filter((t) => t.id !== id))\n\n  return (\n    <Dialog open={isOpen} onOpenChange={(open) => !open && onClose()}>\n      <DialogContent className=\"sm:max-w-[500px] max-h-[85vh] overflow-y-auto p-6 flex flex-col gap-6 bg-white border-[#E8E2D9] shadow-xl sm:rounded-[2rem]\">\n        <DialogHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n          <DialogTitle className=\"text-[28px] font-black tracking-tight text-[#3D2B1F]\">\n            {name || 'Node'}\n          </DialogTitle>\n        </DialogHeader>\n\n        <Tabs defaultValue=\"conf\" className=\"w-full flex-1\">\n          <TabsList className=\"flex w-full bg-[#FAF7F2] rounded-full p-1.5 mb-6 h-auto\">\n            <TabsTrigger\n              value=\"conf\"\n              className=\"flex-1 rounded-full text-xs py-2 font-bold text-[#8C7B6C] data-[state=active]:bg-white data-[state=active]:text-[#3D2B1F] data-[state=active]:shadow-sm transition-all\"\n            >\n              Conf\n            </TabsTrigger>\n            <TabsTrigger\n              value=\"docs\"\n              className=\"flex-1 rounded-full text-xs py-2 font-bold text-[#8C7B6C] data-[state=active]:bg-white data-[state=active]:text-[#3D2B1F] data-[state=active]:shadow-sm transition-all\"\n            >\n              Docs\n            </TabsTrigger>\n            <TabsTrigger\n              value=\"tasks\"\n              className=\"flex-1 rounded-full text-xs py-2 font-bold text-[#8C7B6C] data-[state=active]:bg-white data-[state=active]:text-[#3D2B1F] data-[state=active]:shadow-sm transition-all\"\n            >\n              Tasks\n            </TabsTrigger>\n            <TabsTrigger\n              value=\"assets\"\n              className=\"flex-1 rounded-full text-xs py-2 font-bold text-[#8C7B6C] data-[state=active]:bg-white data-[state=active]:text-[#3D2B1F] data-[state=active]:shadow-sm transition-all\"\n            >\n              Assets\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"conf\" className=\"space-y-6 outline-none\">\n            <div className=\"space-y-2\">\n              <Label className=\"text-[11px] font-bold text-[#8C7B6C] tracking-widest uppercase\">\n                SUBTÍTULO\n              </Label>\n              <Input\n                value={subtitle}\n                onChange={(e) => setSubtitle(e.target.value)}\n                className=\"h-12 rounded-xl bg-[#FAF7F2] border-[#E8E2D9] font-bold text-[#3D2B1F] px-4 shadow-none focus-visible:ring-[#C2714F]/20\"\n                placeholder=\"+1 filter\"\n              />\n            </div>\n\n            <div className=\"flex flex-row items-center justify-between rounded-2xl border border-[#E8E2D9] bg-[#FAF7F2] p-4\">\n              <div className=\"space-y-0.5\">\n                <Label className=\"text-[15px] font-bold text-[#3D2B1F]\">\n                  Modo Tarefa\n                </Label>\n                <p className=\"text-[13px] text-[#8C7B6C] font-medium\">\n                  Habilitar checklist\n                </p>\n              </div>\n              <Switch checked={isTaskMode} onCheckedChange={setIsTaskMode} />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label className=\"text-[11px] font-bold text-[#8C7B6C] tracking-widest uppercase\">\n                NOTAS ADICIONAIS\n              </Label>\n              <Textarea\n                value={description}\n                onChange={(e) => setDescription(e.target.value)}\n                className=\"min-h-[120px] rounded-xl bg-[#FAF7F2] border-[#E8E2D9] font-medium text-[#3D2B1F] resize-none p-4 shadow-none focus-visible:ring-[#C2714F]/20\"\n                placeholder=\"Adicione contexto aqui...\"\n              />\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"docs\" className=\"space-y-4 outline-none\">\n            <div className=\"space-y-3\">\n              <Label className=\"text-sm font-semibold text-[#3D2B1F]\">\n                Documentos Vinculados\n              </Label>\n              <Select\n                onValueChange={(val) =>\n                  !linkedDocs.includes(val) &&\n                  setLinkedDocs([...linkedDocs, val])\n                }\n              >\n                <SelectTrigger className=\"h-11 rounded-xl bg-[#FAF7F2] border-[#E8E2D9] font-medium\">\n                  <SelectValue placeholder=\"Buscar documento...\" />\n                </SelectTrigger>\n                <SelectContent className=\"rounded-xl border-[#E8E2D9] shadow-lg\">\n                  {docs\n                    .filter((d) => !linkedDocs.includes(d.id))\n                    .map((d) => (\n                      <SelectItem\n                        key={d.id}\n                        value={d.id}\n                        className=\"font-medium\"\n                      >\n                        {d.title}\n                      </SelectItem>\n                    ))}\n                </SelectContent>\n              </Select>\n              <div className=\"flex flex-wrap gap-2\">\n                {linkedDocs.map((id) => {\n                  const d = docs.find((doc) => doc.id === id)\n                  if (!d) return null\n                  return (\n                    <Badge\n                      key={id}\n                      variant=\"outline\"\n                      className=\"pl-2 pr-1.5 py-1.5 bg-white border-[#E8E2D9] rounded-lg gap-1.5 flex items-center shadow-sm\"\n                    >\n                      <FileText size={14} className=\"text-[#C2714F]\" />{' '}\n                      <span className=\"text-xs font-semibold text-[#3D2B1F]\">\n                        {d.title}\n                      </span>\n                      <button\n                        onClick={() =>\n                          setLinkedDocs(linkedDocs.filter((l) => l !== id))\n                        }\n                        className=\"text-[#8C7B6C] hover:text-[#C2714F] ml-1 transition-colors\"\n                      >\n                        <X size={14} />\n                      </button>\n                    </Badge>\n                  )\n                })}\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"assets\" className=\"space-y-4 outline-none\">\n            <div className=\"space-y-3\">\n              <Label className=\"text-sm font-semibold text-[#3D2B1F]\">\n                Ativos da Biblioteca\n              </Label>\n              <Select\n                onValueChange={(val) =>\n                  !linkedAssets.includes(val) &&\n                  setLinkedAssets([...linkedAssets, val])\n                }\n              >\n                <SelectTrigger className=\"h-11 rounded-xl bg-[#FAF7F2] border-[#E8E2D9] font-medium\">\n                  <SelectValue placeholder=\"Buscar ativo...\" />\n                </SelectTrigger>\n                <SelectContent className=\"rounded-xl border-[#E8E2D9] shadow-lg\">\n                  {resources\n                    .filter((a) => !linkedAssets.includes(a.id))\n                    .map((a) => (\n                      <SelectItem\n                        key={a.id}\n                        value={a.id}\n                        className=\"font-medium\"\n                      >\n                        {a.title}\n                      </SelectItem>\n                    ))}\n                </SelectContent>\n              </Select>\n              <div className=\"flex flex-wrap gap-2\">\n                {linkedAssets.map((id) => {\n                  const a = resources.find((asset) => asset.id === id)\n                  if (!a) return null\n                  return (\n                    <Badge\n                      key={id}\n                      variant=\"outline\"\n                      className=\"pl-2 pr-1.5 py-1.5 bg-white border-[#E8E2D9] rounded-lg gap-1.5 flex items-center shadow-sm\"\n                    >\n                      {a.type === 'link' ? (\n                        <LinkIcon size={14} className=\"text-[#C2714F]\" />\n                      ) : (\n                        <ImageIcon size={14} className=\"text-[#C2714F]\" />\n                      )}\n                      <span className=\"text-xs font-semibold text-[#3D2B1F]\">\n                        {a.title}\n                      </span>\n                      <button\n                        onClick={() =>\n                          setLinkedAssets(linkedAssets.filter((l) => l !== id))\n                        }\n                        className=\"text-[#8C7B6C] hover:text-[#C2714F] ml-1 transition-colors\"\n                      >\n                        <X size={14} />\n                      </button>\n                    </Badge>\n                  )\n                })}\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"tasks\" className=\"space-y-4 outline-none\">\n            <div className=\"space-y-3 max-h-[300px] overflow-y-auto pr-2 scrollbar-thin scrollbar-thumb-[#E8E2D9]\">\n              {nodeTasks.map((t) => (\n                <div\n                  key={t.id}\n                  className=\"flex flex-col gap-3 bg-[#FAF7F2] p-3.5 rounded-xl border border-[#E8E2D9]\"\n                >\n                  <div className=\"flex gap-3 items-center\">\n                    <Checkbox\n                      checked={t.status === 'Concluído'}\n                      onCheckedChange={(c) =>\n                        updateTask(t.id, {\n                          status: c ? 'Concluído' : 'Pendente',\n                        })\n                      }\n                      className=\"w-5 h-5 rounded-[6px] border-[#8C7B6C]/30 data-[state=checked]:bg-[#C2714F] data-[state=checked]:border-[#C2714F]\"\n                    />\n                    <Input\n                      value={t.title}\n                      onChange={(e) =>\n                        updateTask(t.id, { title: e.target.value })\n                      }\n                      className={cn(\n                        'h-9 rounded-lg bg-white font-semibold text-[13px] border-[#E8E2D9] text-[#3D2B1F] shadow-sm focus-visible:ring-[#C2714F]/20',\n                        t.status === 'Concluído' &&\n                          'line-through text-[#8C7B6C] opacity-70',\n                      )}\n                    />\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      onClick={() => removeTask(t.id)}\n                      className=\"h-9 w-9 text-[#8C7B6C] hover:text-red-500 hover:bg-white shrink-0 rounded-lg\"\n                    >\n                      <Trash2 size={16} />\n                    </Button>\n                  </div>\n                  <div className=\"flex gap-2 pl-8\">\n                    <Select\n                      value={t.priority}\n                      onValueChange={(v) =>\n                        updateTask(t.id, { priority: v as any })\n                      }\n                    >\n                      <SelectTrigger className=\"h-8 rounded-lg text-xs w-[110px] bg-white border-[#E8E2D9] text-[#3D2B1F] font-semibold shadow-sm\">\n                        <SelectValue placeholder=\"Prioridade\" />\n                      </SelectTrigger>\n                      <SelectContent className=\"rounded-xl border-[#E8E2D9] shadow-lg\">\n                        <SelectItem value=\"Baixa\" className=\"font-medium\">\n                          Baixa\n                        </SelectItem>\n                        <SelectItem value=\"Média\" className=\"font-medium\">\n                          Média\n                        </SelectItem>\n                        <SelectItem value=\"Alta\" className=\"font-medium\">\n                          Alta\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <Input\n                      type=\"date\"\n                      value={t.deadline ? t.deadline.split('T')[0] : ''}\n                      onChange={(e) =>\n                        updateTask(t.id, {\n                          deadline: e.target.value\n                            ? new Date(e.target.value).toISOString()\n                            : undefined,\n                        })\n                      }\n                      className=\"h-8 rounded-lg text-xs bg-white border-[#E8E2D9] text-[#3D2B1F] font-semibold flex-1 shadow-sm focus-visible:ring-[#C2714F]/20\"\n                    />\n                  </div>\n                </div>\n              ))}\n              {nodeTasks.length === 0 && (\n                <div className=\"text-sm text-[#8C7B6C] text-center py-8 font-medium bg-[#FAF7F2] rounded-xl border border-dashed border-[#E8E2D9]\">\n                  Nenhuma tarefa vinculada.\n                </div>\n              )}\n            </div>\n            <Button\n              onClick={addTask}\n              variant=\"outline\"\n              className=\"w-full rounded-xl border-dashed border-[#E8E2D9] bg-white text-[#3D2B1F] font-bold hover:text-[#C2714F] hover:border-[#C2714F] h-12 gap-2 hover:bg-[#FAF7F2] transition-colors\"\n            >\n              <Plus size={18} /> Nova Tarefa\n            </Button>\n          </TabsContent>\n        </Tabs>\n\n        <DialogFooter className=\"mt-4 sm:justify-end gap-3 pt-4 border-t border-[#E8E2D9]/60\">\n          <Button\n            onClick={handleSave}\n            className=\"w-full rounded-full h-12 text-[15px] font-bold bg-[#C2714F] hover:bg-[#a65d3f] text-white shadow-md transition-transform hover:scale-[1.02] active:scale-[0.98]\"\n          >\n            Salvar Alterações\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n","import { useState, useCallback, useRef } from 'react'\nimport { Funnel } from '@/types'\n\nconst MAX_HISTORY = 50\n\nexport function useCanvasHistory(initialFunnel: Funnel) {\n  const pastRef = useRef<string[]>([])\n  const futureRef = useRef<string[]>([])\n  const [, forceUpdate] = useState(0)\n\n  const pushState = useCallback((funnel: Funnel) => {\n    const snapshot = JSON.stringify({\n      nodes: funnel.nodes,\n      edges: funnel.edges,\n    })\n    pastRef.current.push(snapshot)\n    if (pastRef.current.length > MAX_HISTORY) {\n      pastRef.current.shift()\n    }\n    futureRef.current = []\n    forceUpdate((c) => c + 1)\n  }, [])\n\n  const undo = useCallback(\n    (currentFunnel: Funnel, onChange: (f: Funnel) => void) => {\n      if (pastRef.current.length === 0) return\n      const currentSnapshot = JSON.stringify({\n        nodes: currentFunnel.nodes,\n        edges: currentFunnel.edges,\n      })\n      futureRef.current.push(currentSnapshot)\n      const prev = pastRef.current.pop()!\n      const parsed = JSON.parse(prev)\n      onChange({ ...currentFunnel, nodes: parsed.nodes, edges: parsed.edges })\n      forceUpdate((c) => c + 1)\n    },\n    [],\n  )\n\n  const redo = useCallback(\n    (currentFunnel: Funnel, onChange: (f: Funnel) => void) => {\n      if (futureRef.current.length === 0) return\n      const currentSnapshot = JSON.stringify({\n        nodes: currentFunnel.nodes,\n        edges: currentFunnel.edges,\n      })\n      pastRef.current.push(currentSnapshot)\n      const next = futureRef.current.pop()!\n      const parsed = JSON.parse(next)\n      onChange({ ...currentFunnel, nodes: parsed.nodes, edges: parsed.edges })\n      forceUpdate((c) => c + 1)\n    },\n    [],\n  )\n\n  const canUndo = pastRef.current.length > 0\n  const canRedo = futureRef.current.length > 0\n\n  return { pushState, undo, redo, canUndo, canRedo }\n}\n","import { useState, useRef, useEffect } from 'react'\n\nexport function useCanvasTransform(initialScale = 1, hideHeader = false) {\n  const [transform, setTransform] = useState({\n    x: hideHeader ? 300 : 400,\n    y: 150,\n    scale: initialScale,\n  })\n  const [isPanning, setIsPanning] = useState(false)\n  const lastPan = useRef({ x: 0, y: 0 })\n\n  const zoomIn = () =>\n    setTransform((p) => ({ ...p, scale: Math.min(3, p.scale + 0.1) }))\n  const zoomOut = () =>\n    setTransform((p) => ({ ...p, scale: Math.max(0.1, p.scale - 0.1) }))\n  const resetZoom = () => setTransform({ x: 400, y: 150, scale: 1 })\n\n  return {\n    transform,\n    setTransform,\n    isPanning,\n    setIsPanning,\n    lastPan,\n    zoomIn,\n    zoomOut,\n    resetZoom,\n  }\n}\n","import { useState } from 'react'\n\nexport function useCanvasSelection() {\n  const [selectedNodes, setSelectedNodes] = useState<string[]>([])\n  const [selectedEdge, setSelectedEdge] = useState<string | null>(null)\n  const [selectionBox, setSelectionBox] = useState<{\n    startX: number\n    startY: number\n    currentX: number\n    currentY: number\n  } | null>(null)\n\n  return {\n    selectedNodes,\n    setSelectedNodes,\n    selectedEdge,\n    setSelectedEdge,\n    selectionBox,\n    setSelectionBox,\n  }\n}\n","import { useState, useRef, useEffect, useCallback, memo, useMemo } from 'react'\nimport { useNavigate, useSearchParams } from 'react-router-dom'\nimport { Funnel, Node, Edge, NodeData, Resource } from '@/types'\nimport { generateId } from '@/lib/generateId'\nimport BlockPalette from './BlockPalette'\nimport NodeItem from './NodeItem'\nimport RightPanel from './RightPanel'\nimport { NodeSettingsModal } from './NodeSettingsModal'\nimport { useCanvasHistory } from '@/hooks/useCanvasHistory'\nimport { useCanvasTransform } from '@/hooks/useCanvasTransform'\nimport { useCanvasSelection } from '@/hooks/useCanvasSelection'\nimport { ConfirmDialog } from '@/components/ConfirmDialog'\nimport {\n  Plus,\n  Minus,\n  Map as MapIcon,\n  Grid,\n  Image as ImageIcon,\n  MousePointer2,\n  Hand,\n  Type,\n  ArrowLeft,\n  MessageCircle,\n} from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport {\n  Tooltip,\n  TooltipTrigger,\n  TooltipContent,\n} from '@/components/ui/tooltip'\nimport { cn } from '@/lib/utils'\nimport useTaskStore from '@/stores/useTaskStore'\nimport useDocumentStore from '@/stores/useDocumentStore'\nimport useResourceStore from '@/stores/useResourceStore'\nimport { useToast } from '@/hooks/use-toast'\nimport { format } from 'date-fns'\n\nconst getRightPortCoords = (node: Node, x: number, y: number) => {\n  const w = node.width || 120\n  const h = node.height || 120\n  if (['Square', 'Diamond', 'Circle'].includes(node.type))\n    return { x: x + w, y: y + h / 2 }\n  if (node.type === 'FloatingText') {\n    const textLen = (node.data.name || '').length\n    const approxW = Math.max(40, textLen * 8.5 + 16)\n    return { x: x + approxW, y: y + 20 }\n  }\n  if (node.type === 'Image') return { x: x + 300, y: y + 100 }\n  if (node.type === 'Text') return { x: x + 150, y: y + 30 }\n  return { x: x + 280, y: y + 44 }\n}\n\nconst getLeftPortCoords = (node: Node, x: number, y: number) => {\n  const h = node.height || 120\n  if (['Square', 'Diamond', 'Circle'].includes(node.type))\n    return { x, y: y + h / 2 }\n  if (node.type === 'FloatingText') return { x, y: y + 20 }\n  if (node.type === 'Image') return { x, y: y + 100 }\n  if (node.type === 'Text') return { x, y: y + 30 }\n  return { x, y: y + 44 }\n}\n\nconst getApproxBounds = (n: Node) => {\n  let w = n.width || 280\n  let h = n.height || 120\n  if (n.type === 'FloatingText') {\n    w = 150\n    h = 40\n  } else if (n.type === 'Text') {\n    w = 200\n    h = 80\n  } else if (n.type === 'Image') {\n    w = 300\n    h = 200\n  } else if (['Square', 'Diamond', 'Circle'].includes(n.type)) {\n    w = n.width || 120\n    h = n.height || 120\n  }\n  return { x: n.x, y: n.y, w, h }\n}\n\nconst EdgeItem = memo(\n  ({\n    edge,\n    sourceNode,\n    targetNode,\n    isSelected,\n    activeTool,\n    onSelect,\n  }: {\n    edge: Edge\n    sourceNode: Node\n    targetNode: Node\n    isSelected: boolean\n    activeTool: string\n    onSelect: (e: React.PointerEvent) => void\n  }) => {\n    const sourceCoords = getRightPortCoords(\n      sourceNode,\n      sourceNode.x,\n      sourceNode.y,\n    )\n    const targetCoords = getLeftPortCoords(\n      targetNode,\n      targetNode.x,\n      targetNode.y,\n    )\n\n    const d = `M ${sourceCoords.x} ${sourceCoords.y} C ${sourceCoords.x + 80} ${sourceCoords.y}, ${targetCoords.x - 80} ${targetCoords.y}, ${targetCoords.x} ${targetCoords.y}`\n\n    const strokeColor =\n      edge.style?.stroke || (isSelected ? '#C2714F' : 'url(#edge-gradient)')\n    const strokeWidth = edge.style?.strokeWidth || (isSelected ? 4 : 3)\n    const strokeDasharray = edge.style?.strokeDasharray || 'none'\n\n    return (\n      <path\n        d={d}\n        stroke={strokeColor}\n        strokeWidth={strokeWidth}\n        strokeDasharray={strokeDasharray}\n        fill=\"none\"\n        strokeLinecap=\"round\"\n        className={cn(\n          'transition-colors cursor-pointer pointer-events-auto',\n          !isSelected && 'hover:stroke-[#C2714F]/70',\n        )}\n        onClick={onSelect}\n      />\n    )\n  },\n  (prev, next) => {\n    return (\n      prev.edge === next.edge &&\n      prev.sourceNode === next.sourceNode &&\n      prev.targetNode === next.targetNode &&\n      prev.isSelected === next.isSelected &&\n      prev.activeTool === next.activeTool\n    )\n  },\n)\n\nconst MemoizedNodeItem = memo(NodeItem, (prev, next) => {\n  return (\n    prev.node === next.node &&\n    prev.selected === next.selected &&\n    prev.snapToGrid === next.snapToGrid &&\n    prev.activeTool === next.activeTool &&\n    prev.isNodeDragging === next.isNodeDragging &&\n    prev.taskProgress.total === next.taskProgress.total &&\n    prev.taskProgress.completed === next.taskProgress.completed &&\n    prev.scale === next.scale\n  )\n})\n\nexport default function CanvasBoard({\n  funnel,\n  onChange,\n  hideHeader,\n  onBack,\n}: {\n  funnel: Funnel\n  onChange: (f: Funnel) => void\n  hideHeader?: boolean\n  onBack?: () => void\n}) {\n  const navigate = useNavigate()\n  const [searchParams, setSearchParams] = useSearchParams()\n  const [tasks, setTasks] = useTaskStore()\n  const [docs, setDocs] = useDocumentStore()\n  const [resources, setResources] = useResourceStore()\n  const { toast } = useToast()\n  const { pushState, undo, redo } = useCanvasHistory(funnel)\n  const [nodeToDelete, setNodeToDelete] = useState<string | 'selected' | null>(\n    null,\n  )\n\n  const onChangeWithHistory = useCallback(\n    (newFunnel: Funnel) => {\n      pushState(funnel)\n      onChange(newFunnel)\n    },\n    [funnel, onChange, pushState],\n  )\n\n  const {\n    selectedNodes,\n    setSelectedNodes,\n    selectedEdge,\n    setSelectedEdge,\n    selectionBox,\n    setSelectionBox,\n  } = useCanvasSelection()\n\n  const {\n    transform,\n    setTransform,\n    isPanning,\n    setIsPanning,\n    lastPan,\n    zoomIn,\n    zoomOut,\n    resetZoom,\n  } = useCanvasTransform(1, hideHeader)\n\n  const [rightPanelState, setRightPanelState] = useState<{\n    nodeId: string\n    tab: string\n  } | null>(null)\n  const [isSpacePressed, setIsSpacePressed] = useState(false)\n  const [activeTool, setActiveTool] = useState<\n    'Select' | 'Pan' | 'Square' | 'Diamond' | 'Circle'\n  >('Select')\n  const [showMinimap, setShowMinimap] = useState(false)\n  const [snapToGrid, setSnapToGrid] = useState(false)\n\n  const [dragState, setDragState] = useState<{\n    isDragging: boolean\n    dx: number\n    dy: number\n  } | null>(null)\n  const [resizingNode, setResizingNode] = useState<{\n    id: string\n    x: number\n    y: number\n    width?: number\n    height?: number\n  } | null>(null)\n  const [drawingEdge, setDrawingEdge] = useState<{\n    source: string\n    currentX: number\n    currentY: number\n  } | null>(null)\n  const [creatingShape, setCreatingShape] = useState<{\n    type: string\n    startX: number\n    startY: number\n    currentX: number\n    currentY: number\n  } | null>(null)\n\n  const [settingsNodeId, setSettingsNodeId] = useState<string | null>(null)\n  const boardRef = useRef<HTMLDivElement>(null)\n\n  const latest = useRef({\n    funnel,\n    selectedNodes,\n    snapToGrid,\n    transform,\n    rightPanelState,\n    settingsNodeId,\n    docs,\n    tasks,\n    resources,\n    activeTool,\n  })\n  latest.current = {\n    funnel,\n    selectedNodes,\n    snapToGrid,\n    transform,\n    rightPanelState,\n    settingsNodeId,\n    docs,\n    tasks,\n    resources,\n    activeTool,\n  }\n\n  const targetNodeId = searchParams.get('nodeId')\n  useEffect(() => {\n    if (targetNodeId && funnel.nodes.length > 0) {\n      const node = funnel.nodes.find((n) => n.id === targetNodeId)\n      if (node && boardRef.current) {\n        const rect = boardRef.current.getBoundingClientRect()\n        setTransform({\n          x: rect.width / 2 - node.x * 1.5 - 195,\n          y: rect.height / 2 - node.y * 1.5 - 60,\n          scale: 1.5,\n        })\n        setSelectedNodes([node.id])\n        setRightPanelState({ nodeId: node.id, tab: 'details' })\n        searchParams.delete('nodeId')\n        setSearchParams(searchParams, { replace: true })\n      }\n    }\n  }, [\n    targetNodeId,\n    funnel.nodes,\n    searchParams,\n    setSearchParams,\n    setSelectedNodes,\n    setTransform,\n  ])\n\n  const handleGroupSelected = useCallback(() => {\n    const { funnel, selectedNodes } = latest.current\n    if (selectedNodes.length < 2) return\n    const groupId = generateId('g')\n    onChangeWithHistory({\n      ...funnel,\n      nodes: funnel.nodes.map((n) =>\n        selectedNodes.includes(n.id) ? { ...n, groupId } : n,\n      ),\n    })\n    toast({ title: 'Elementos agrupados.' })\n  }, [onChangeWithHistory, toast])\n\n  const handleDeleteSelected = useCallback(() => {\n    const { funnel, selectedNodes, rightPanelState, settingsNodeId } =\n      latest.current\n    if (selectedNodes.length === 0) return\n    onChangeWithHistory({\n      ...funnel,\n      nodes: funnel.nodes.filter((n) => !selectedNodes.includes(n.id)),\n      edges: funnel.edges.filter(\n        (e) =>\n          !selectedNodes.includes(e.source) &&\n          !selectedNodes.includes(e.target),\n      ),\n    })\n    setSelectedNodes([])\n    if (rightPanelState && selectedNodes.includes(rightPanelState.nodeId))\n      setRightPanelState(null)\n    if (settingsNodeId && selectedNodes.includes(settingsNodeId))\n      setSettingsNodeId(null)\n  }, [onChangeWithHistory, setSelectedNodes])\n\n  const handleConfirmDelete = useCallback(() => {\n    const { funnel, rightPanelState, settingsNodeId } = latest.current\n    if (nodeToDelete === 'selected') {\n      handleDeleteSelected()\n    } else if (nodeToDelete && nodeToDelete !== 'selected') {\n      onChangeWithHistory({\n        ...funnel,\n        nodes: funnel.nodes.filter((x) => x.id !== nodeToDelete),\n        edges: funnel.edges.filter(\n          (e) => e.source !== nodeToDelete && e.target !== nodeToDelete,\n        ),\n      })\n      if (rightPanelState?.nodeId === nodeToDelete) setRightPanelState(null)\n      if (settingsNodeId === nodeToDelete) setSettingsNodeId(null)\n    }\n    setNodeToDelete(null)\n  }, [nodeToDelete, handleDeleteSelected, onChangeWithHistory])\n\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (\n        e.target instanceof HTMLInputElement ||\n        e.target instanceof HTMLTextAreaElement ||\n        (e.target as HTMLElement).isContentEditable\n      )\n        return\n      if (e.code === 'Space') {\n        e.preventDefault()\n        setIsSpacePressed(true)\n        return\n      }\n      switch (e.key.toLowerCase()) {\n        case '1':\n        case 'v':\n          setActiveTool('Select')\n          break\n        case '2':\n          setActiveTool('Square')\n          break\n        case '3':\n          setActiveTool('Diamond')\n          break\n        case '4':\n          setActiveTool('Circle')\n          break\n        case 'h':\n          setActiveTool('Pan')\n          break\n        case 'delete':\n        case 'backspace':\n          if (latest.current.selectedNodes.length > 0)\n            setNodeToDelete('selected')\n          break\n        case 'g':\n          if (e.ctrlKey || e.metaKey) {\n            e.preventDefault()\n            handleGroupSelected()\n          }\n          break\n        case 'z':\n          if (e.ctrlKey || e.metaKey) {\n            e.preventDefault()\n            if (e.shiftKey) {\n              redo(latest.current.funnel, onChange)\n            } else {\n              undo(latest.current.funnel, onChange)\n            }\n          }\n          break\n      }\n    }\n    const handleKeyUp = (e: KeyboardEvent) => {\n      if (e.code === 'Space') {\n        setIsSpacePressed(false)\n      }\n    }\n    window.addEventListener('keydown', handleKeyDown)\n    window.addEventListener('keyup', handleKeyUp)\n    return () => {\n      window.removeEventListener('keydown', handleKeyDown)\n      window.removeEventListener('keyup', handleKeyUp)\n    }\n  }, [handleGroupSelected, undo, redo, onChange])\n\n  useEffect(() => {\n    const handlePaste = (e: ClipboardEvent) => {\n      const items = e.clipboardData?.items\n      if (!items) return\n      for (let i = 0; i < items.length; i++) {\n        if (items[i].type.indexOf('image') !== -1) {\n          const { funnel, transform } = latest.current\n          const newAsset: Resource = {\n            id: generateId('a'),\n            projectId: funnel.projectId,\n            title: 'Pasted Image ' + format(new Date(), 'HH:mm:ss'),\n            content:\n              'https://img.usecurling.com/p/800/600?q=wireframe&color=gray',\n            type: 'image',\n            tags: ['pasted', 'canvas'],\n            folderId: null,\n            isPinned: false,\n            createdAt: new Date().toISOString(),\n          }\n          setResources((prev) => [newAsset, ...prev])\n\n          const newNode: Node = {\n            id: generateId('n'),\n            type: 'Image',\n            x: -transform.x / transform.scale + 400,\n            y: -transform.y / transform.scale + 200,\n            data: {\n              name: newAsset.content,\n              status: '',\n              subtitle: '',\n              linkedAssetIds: [newAsset.id],\n            },\n          }\n          onChangeWithHistory({ ...funnel, nodes: [...funnel.nodes, newNode] })\n          setSelectedNodes([newNode.id])\n          toast({ title: 'Imagem colada no canvas!' })\n        }\n      }\n    }\n    window.addEventListener('paste', handlePaste)\n    return () => window.removeEventListener('paste', handlePaste)\n  }, [setResources, onChangeWithHistory, setSelectedNodes, toast])\n\n  useEffect(() => {\n    const el = boardRef.current\n    if (!el) return\n    const onWheel = (e: WheelEvent) => {\n      e.preventDefault()\n      if (e.ctrlKey || e.metaKey) {\n        setTransform((prev) => {\n          let newScale = prev.scale * Math.exp(e.deltaY * -0.005)\n          newScale = Math.min(Math.max(0.1, newScale), 3)\n          const rect = el.getBoundingClientRect()\n          const mouseX = e.clientX - rect.left,\n            mouseY = e.clientY - rect.top\n          return {\n            x: mouseX - (mouseX - prev.x) * (newScale / prev.scale),\n            y: mouseY - (mouseY - prev.y) * (newScale / prev.scale),\n            scale: newScale,\n          }\n        })\n      } else {\n        setTransform((prev) => ({\n          ...prev,\n          x: prev.x - e.deltaX,\n          y: prev.y - e.deltaY,\n        }))\n      }\n    }\n    el.addEventListener('wheel', onWheel, { passive: false })\n    return () => el.removeEventListener('wheel', onWheel)\n  }, [setTransform])\n\n  const handlePointerDown = (e: React.PointerEvent) => {\n    const isCanvasBg =\n      e.target === boardRef.current ||\n      (e.target as HTMLElement).classList.contains('canvas-container') ||\n      (e.target as HTMLElement).tagName === 'svg'\n    const rect = boardRef.current?.getBoundingClientRect()\n    if (!rect) return\n\n    const isMiddleClick = e.button === 1\n    const isSpaceRightClick = isSpacePressed && e.button === 2\n\n    if (activeTool === 'Pan' || isMiddleClick || isSpaceRightClick) {\n      setIsPanning(true)\n      lastPan.current = { x: e.clientX, y: e.clientY }\n      ;(e.target as HTMLElement).setPointerCapture(e.pointerId)\n      document.body.style.userSelect = 'none'\n      return\n    }\n\n    if (isCanvasBg && e.button === 0) {\n      if (['Square', 'Diamond', 'Circle'].includes(activeTool)) {\n        let x = (e.clientX - rect.left - transform.x) / transform.scale\n        let y = (e.clientY - rect.top - transform.y) / transform.scale\n        if (snapToGrid) {\n          x = Math.round(x / 28) * 28\n          y = Math.round(y / 28) * 28\n        }\n        setCreatingShape({\n          type: activeTool,\n          startX: x,\n          startY: y,\n          currentX: x,\n          currentY: y,\n        })\n        ;(e.target as HTMLElement).setPointerCapture(e.pointerId)\n        e.stopPropagation()\n        return\n      }\n\n      if (activeTool === 'Select') {\n        setSelectedNodes([])\n        setSelectedEdge(null)\n        let x = (e.clientX - rect.left - transform.x) / transform.scale\n        let y = (e.clientY - rect.top - transform.y) / transform.scale\n        setSelectionBox({ startX: x, startY: y, currentX: x, currentY: y })\n        ;(e.target as HTMLElement).setPointerCapture(e.pointerId)\n      }\n    }\n  }\n\n  const handlePointerMove = (e: React.PointerEvent) => {\n    const rect = boardRef.current?.getBoundingClientRect()\n    if (!rect) return\n\n    if (creatingShape) {\n      let x = (e.clientX - rect.left - transform.x) / transform.scale\n      let y = (e.clientY - rect.top - transform.y) / transform.scale\n      if (snapToGrid) {\n        x = Math.round(x / 28) * 28\n        y = Math.round(y / 28) * 28\n      }\n      setCreatingShape((prev) =>\n        prev ? { ...prev, currentX: x, currentY: y } : null,\n      )\n      return\n    }\n\n    if (selectionBox) {\n      let x = (e.clientX - rect.left - transform.x) / transform.scale\n      let y = (e.clientY - rect.top - transform.y) / transform.scale\n      setSelectionBox((prev) =>\n        prev ? { ...prev, currentX: x, currentY: y } : null,\n      )\n\n      const minX = Math.min(selectionBox.startX, x)\n      const maxX = Math.max(selectionBox.startX, x)\n      const minY = Math.min(selectionBox.startY, y)\n      const maxY = Math.max(selectionBox.startY, y)\n\n      const newSelected = funnel.nodes\n        .filter((n) => {\n          const bounds = getApproxBounds(n)\n          return (\n            bounds.x < maxX &&\n            bounds.x + bounds.w > minX &&\n            bounds.y < maxY &&\n            bounds.y + bounds.h > minY\n          )\n        })\n        .map((n) => n.id)\n      setSelectedNodes(newSelected)\n      return\n    }\n\n    if (isPanning) {\n      setTransform((prev) => ({\n        ...prev,\n        x: prev.x + (e.clientX - lastPan.current.x),\n        y: prev.y + (e.clientY - lastPan.current.y),\n      }))\n      lastPan.current = { x: e.clientX, y: e.clientY }\n    }\n  }\n\n  const handlePointerUp = (e: React.PointerEvent) => {\n    if (creatingShape) {\n      const width = Math.abs(creatingShape.currentX - creatingShape.startX)\n      const height = Math.abs(creatingShape.currentY - creatingShape.startY)\n      const x = Math.min(creatingShape.startX, creatingShape.currentX)\n      const y = Math.min(creatingShape.startY, creatingShape.currentY)\n\n      if (width > 10 && height > 10) {\n        const newNodeId = generateId('n')\n        onChangeWithHistory({\n          ...funnel,\n          nodes: [\n            ...funnel.nodes,\n            {\n              id: newNodeId,\n              type: creatingShape.type,\n              x,\n              y,\n              width,\n              height,\n              data: { name: '', status: '', subtitle: '' },\n              style: {\n                fill: 'transparent',\n                opacity: 1,\n                stroke: '#1e293b',\n                strokeWidth: 2,\n                strokeDasharray: 'none',\n              },\n            },\n          ],\n        })\n        setSelectedNodes([newNodeId])\n      }\n      setCreatingShape(null)\n      setActiveTool('Select')\n      try {\n        ;(e.target as HTMLElement).releasePointerCapture(e.pointerId)\n      } catch (err) {\n        /* ignore */\n      }\n      return\n    }\n\n    if (selectionBox) {\n      setSelectionBox(null)\n      try {\n        ;(e.target as HTMLElement).releasePointerCapture(e.pointerId)\n      } catch (err) {\n        /* ignore */\n      }\n      return\n    }\n\n    if (isPanning) {\n      setIsPanning(false)\n      try {\n        ;(e.target as HTMLElement).releasePointerCapture(e.pointerId)\n      } catch (err) {\n        /* ignore */\n      }\n      document.body.style.userSelect = ''\n    }\n  }\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault()\n    const type = e.dataTransfer.getData('blockType')\n    if (!type) return\n    const rect = boardRef.current?.getBoundingClientRect()\n    if (!rect) return\n    let x = (e.clientX - rect.left - transform.x) / transform.scale - 130\n    let y = (e.clientY - rect.top - transform.y) / transform.scale - 40\n    if (snapToGrid) {\n      x = Math.round(x / 28) * 28\n      y = Math.round(y / 28) * 28\n    }\n    const newNodeId = generateId('n')\n    onChangeWithHistory({\n      ...funnel,\n      nodes: [\n        ...funnel.nodes,\n        {\n          id: newNodeId,\n          type,\n          x,\n          y,\n          data: { name: type, status: 'A Fazer', subtitle: '+1 filter' },\n        },\n      ],\n    })\n    setSelectedNodes([newNodeId])\n  }\n\n  const handleEdgeDragStart = useCallback(\n    (nodeId: string, e: React.PointerEvent) => {\n      if (e.button !== 0) return\n      const rect = boardRef.current?.getBoundingClientRect()\n      if (!rect) return\n      const getCoords = (cx: number, cy: number) => {\n        const { transform } = latest.current\n        return {\n          x: (cx - rect.left - transform.x) / transform.scale,\n          y: (cy - rect.top - transform.y) / transform.scale,\n        }\n      }\n      const coords = getCoords(e.clientX, e.clientY)\n      setDrawingEdge({ source: nodeId, currentX: coords.x, currentY: coords.y })\n\n      const onMove = (ev: PointerEvent) => {\n        const coords = getCoords(ev.clientX, ev.clientY)\n        setDrawingEdge((prev) =>\n          prev ? { ...prev, currentX: coords.x, currentY: coords.y } : null,\n        )\n      }\n      const onUp = (ev: PointerEvent) => {\n        const targetNodeEl = document\n          .elementFromPoint(ev.clientX, ev.clientY)\n          ?.closest('[data-node-id]')\n        if (targetNodeEl) {\n          const targetId = targetNodeEl.getAttribute('data-node-id')\n          const { funnel } = latest.current\n          if (\n            targetId &&\n            targetId !== nodeId &&\n            !funnel.edges.some(\n              (edge) => edge.source === nodeId && edge.target === targetId,\n            )\n          ) {\n            onChangeWithHistory({\n              ...funnel,\n              edges: [\n                ...funnel.edges,\n                { id: generateId('e'), source: nodeId, target: targetId },\n              ],\n            })\n          }\n        }\n        setDrawingEdge(null)\n        window.removeEventListener('pointermove', onMove)\n        window.removeEventListener('pointerup', onUp)\n        window.removeEventListener('pointercancel', onUp)\n      }\n      window.addEventListener('pointermove', onMove)\n      window.addEventListener('pointerup', onUp)\n      window.addEventListener('pointercancel', onUp)\n    },\n    [onChangeWithHistory],\n  )\n\n  const handleAddChild = useCallback(\n    (parentId: string) => {\n      const { funnel, snapToGrid } = latest.current\n      const parent = funnel.nodes.find((n) => n.id === parentId)\n      if (!parent) return\n      const newId = generateId('n')\n      let newX = parent.x + 350,\n        newY = parent.y\n      if (snapToGrid) {\n        newX = Math.round(newX / 28) * 28\n        newY = Math.round(newY / 28) * 28\n      }\n      onChangeWithHistory({\n        ...funnel,\n        nodes: [\n          ...funnel.nodes,\n          {\n            id: newId,\n            type: 'Default',\n            x: newX,\n            y: newY,\n            data: {\n              name: 'New Step',\n              status: 'A Fazer',\n              subtitle: '+1 filter',\n            },\n          },\n        ],\n        edges: [\n          ...funnel.edges,\n          { id: generateId('e'), source: parentId, target: newId },\n        ],\n      })\n    },\n    [onChangeWithHistory],\n  )\n\n  const handleAddAnnotation = (type: 'Text' | 'Image', name: string) => {\n    const newNodeId = generateId('n')\n    onChangeWithHistory({\n      ...funnel,\n      nodes: [\n        ...funnel.nodes,\n        {\n          id: newNodeId,\n          type,\n          x: -transform.x / transform.scale + 400,\n          y: -transform.y / transform.scale + 200,\n          data: { name, status: '', subtitle: '' },\n          style: type === 'Text' ? { color: '#3D2B1F' } : undefined,\n        },\n      ],\n    })\n    setSelectedNodes([newNodeId])\n  }\n\n  const handleDropResource = useCallback(\n    (nodeId: string, type: string, id: string) => {\n      const { funnel, docs, tasks, resources } = latest.current\n      const updatedNodes = funnel.nodes.map((n) => {\n        if (n.id === nodeId) {\n          const key =\n            type === 'document'\n              ? 'linkedDocumentIds'\n              : type === 'task'\n                ? 'linkedTaskIds'\n                : 'linkedAssetIds'\n          const currentIds = (n.data[key as keyof NodeData] as string[]) || []\n          if (!currentIds.includes(id))\n            return { ...n, data: { ...n.data, [key]: [...currentIds, id] } }\n        }\n        return n\n      })\n      onChangeWithHistory({ ...funnel, nodes: updatedNodes })\n\n      if (type === 'document')\n        setDocs(\n          docs.map((d) =>\n            d.id === id ? { ...d, funnelId: funnel.id, nodeId } : d,\n          ),\n        )\n      else if (type === 'task')\n        setTasks(\n          tasks.map((t) =>\n            t.id === id ? { ...t, funnelId: funnel.id, nodeId } : t,\n          ),\n        )\n      else if (type === 'asset')\n        setResources(\n          resources.map((a) =>\n            a.id === id ? { ...a, projectId: funnel.projectId } : a,\n          ),\n        )\n    },\n    [onChangeWithHistory, setDocs, setTasks, setResources],\n  )\n\n  const updateEdgeStyle = (styleUpdates: Partial<Edge['style']>) => {\n    if (selectedEdge) {\n      onChangeWithHistory({\n        ...funnel,\n        edges: funnel.edges.map((e) =>\n          e.id === selectedEdge\n            ? { ...e, style: { ...e.style, ...styleUpdates } }\n            : e,\n        ),\n      })\n    }\n  }\n\n  const updateNodeStyle = (updates: Partial<Node['style']>) => {\n    if (selectedNodes.length > 0) {\n      onChangeWithHistory({\n        ...funnel,\n        nodes: funnel.nodes.map((n) =>\n          selectedNodes.includes(n.id)\n            ? { ...n, style: { ...n.style, ...updates } }\n            : n,\n        ),\n      })\n    }\n  }\n\n  const handleNodePointerDown = useCallback(\n    (id: string, shiftKey: boolean) => {\n      const { funnel, selectedNodes } = latest.current\n      const n = funnel.nodes.find((x) => x.id === id)\n      if (!n) return\n      const groupMembers = n.groupId\n        ? funnel.nodes.filter((x) => x.groupId === n.groupId).map((x) => x.id)\n        : [id]\n      if (!selectedNodes.includes(id)) {\n        if (shiftKey)\n          setSelectedNodes([...new Set([...selectedNodes, ...groupMembers])])\n        else setSelectedNodes(groupMembers)\n        setSelectedEdge(null)\n      } else if (shiftKey) {\n        setSelectedNodes(selectedNodes.filter((x) => !groupMembers.includes(x)))\n      }\n    },\n    [setSelectedNodes, setSelectedEdge],\n  )\n\n  const rightOffset = rightPanelState ? 'right-80' : 'right-6'\n  const canvasTools = [\n    { id: 'Select', icon: MousePointer2, label: 'Cursor (1)', key: '1' },\n    { id: 'Pan', icon: Hand, label: 'Hand (H)', key: 'H' },\n    { id: 'divider' },\n    {\n      id: 'Text',\n      icon: Type,\n      label: 'Text',\n      action: () => handleAddAnnotation('Text', 'Add text here...'),\n    },\n    {\n      id: 'Image',\n      icon: ImageIcon,\n      label: 'Image',\n      action: () =>\n        handleAddAnnotation(\n          'Image',\n          'https://img.usecurling.com/p/400/300?q=marketing',\n        ),\n    },\n    { id: 'Chat', icon: MessageCircle, label: 'Comment' },\n  ]\n\n  const isMultiSelect = selectedNodes.length > 1\n  const selectedNodeObj =\n    selectedNodes.length > 0\n      ? funnel.nodes.find((n) => n.id === selectedNodes[0])\n      : undefined\n  const selectedEdgeObj = funnel.edges.find((e) => e.id === selectedEdge)\n\n  const effectiveNodesMap = useMemo(() => {\n    const map = new Map<string, Node>()\n    funnel.nodes.forEach((n) => {\n      let eff = n\n      if (resizingNode?.id === n.id) {\n        eff = {\n          ...n,\n          x: resizingNode.x,\n          y: resizingNode.y,\n          width: resizingNode.width,\n          height: resizingNode.height,\n        }\n      } else if (selectedNodes.includes(n.id) && dragState) {\n        eff = { ...n, x: n.x + dragState.dx, y: n.y + dragState.dy }\n      }\n      map.set(n.id, eff)\n    })\n    return map\n  }, [funnel.nodes, resizingNode, selectedNodes, dragState])\n\n  const minimapNodes = useMemo(() => {\n    return funnel.nodes.map((n) => (\n      <div\n        key={n.id}\n        className=\"absolute bg-[#8C7B6C] rounded-xl opacity-50\"\n        style={{\n          left: n.x,\n          top: n.y,\n          width:\n            n.width || (n.type === 'Text' || n.type === 'Image' ? 200 : 280),\n          height: n.height || 100,\n        }}\n      />\n    ))\n  }, [funnel.nodes])\n\n  return (\n    <div className=\"flex-1 flex relative overflow-hidden bg-transparent\">\n      {!hideHeader && (\n        <header className=\"absolute top-0 left-0 right-0 h-20 bg-white border-b border-[#E8E2D9] px-6 flex items-center justify-between z-40\">\n          <div className=\"flex items-center gap-4\">\n            {onBack && (\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"text-[#8C7B6C] hover:text-[#3D2B1F]\"\n                onClick={onBack}\n              >\n                <ArrowLeft size={18} />\n              </Button>\n            )}\n            <h1 className=\"font-bold text-lg text-[#3D2B1F]\">{funnel.name}</h1>\n            <span className=\"bg-[#FAF7F2] text-[#C2714F] px-2.5 py-1 rounded-md text-xs font-bold border border-[#E8E2D9]\">\n              Publicado\n            </span>\n          </div>\n\n          <div className=\"flex bg-[#FAF7F2] p-1 rounded-lg border border-[#E8E2D9]\">\n            <button className=\"px-4 py-1.5 rounded-md bg-white text-[#C2714F] text-sm font-bold shadow-sm\">\n              Editar\n            </button>\n            <button className=\"px-4 py-1.5 rounded-md text-[#8C7B6C] text-sm font-bold hover:text-[#3D2B1F] transition-colors\">\n              Analytics\n            </button>\n          </div>\n\n          <div className=\"flex items-center gap-4\">\n            <div className=\"flex -space-x-2\">\n              <img\n                src=\"https://img.usecurling.com/ppl/thumbnail?gender=female&seed=1\"\n                className=\"w-8 h-8 rounded-full border-2 border-white shadow-sm\"\n                alt=\"Team 1\"\n              />\n              <img\n                src=\"https://img.usecurling.com/ppl/thumbnail?gender=male&seed=2\"\n                className=\"w-8 h-8 rounded-full border-2 border-white shadow-sm\"\n                alt=\"Team 2\"\n              />\n            </div>\n            <Button className=\"bg-[#3D2B1F] hover:bg-[#3D2B1F]/90 text-white rounded-full font-bold shadow-md\">\n              Exportar\n            </Button>\n          </div>\n        </header>\n      )}\n\n      {/* Left Toolbar */}\n      <div\n        className={cn(\n          'absolute left-6 flex flex-col items-center p-1.5 bg-white rounded-2xl shadow-sm border border-[#E8E2D9] z-30 gap-1.5',\n          hideHeader ? 'top-6' : 'top-28',\n        )}\n      >\n        {canvasTools.map((t) => {\n          if (t.id === 'divider')\n            return <div key={t.id} className=\"w-6 h-px bg-[#E8E2D9] my-1\" />\n          return (\n            <Tooltip key={t.id}>\n              <TooltipTrigger asChild>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className={cn(\n                    'w-10 h-10 rounded-xl transition-all relative',\n                    activeTool === t.id &&\n                      t.id !== 'Text' &&\n                      t.id !== 'Image' &&\n                      t.id !== 'Chat'\n                      ? 'bg-[#C2714F]/10 text-[#C2714F] shadow-sm'\n                      : 'text-[#8C7B6C] hover:text-[#3D2B1F] hover:bg-[#FAF7F2]',\n                  )}\n                  onClick={() =>\n                    t.action ? t.action() : setActiveTool(t.id as any)\n                  }\n                >\n                  <t.icon size={20} strokeWidth={2} />\n                  {t.key && t.id !== 'Pan' && (\n                    <span className=\"absolute bottom-1 right-1.5 text-[9px] font-bold opacity-60\">\n                      {t.key}\n                    </span>\n                  )}\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent side=\"right\">{t.label}</TooltipContent>\n            </Tooltip>\n          )\n        })}\n      </div>\n\n      {/* Zoom and Minimap */}\n      <div className=\"absolute left-6 bottom-6 flex flex-col items-center p-1.5 bg-white rounded-2xl shadow-sm border border-[#E8E2D9] z-30 gap-1.5\">\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"w-10 h-10 rounded-xl text-[#8C7B6C] hover:text-[#3D2B1F] hover:bg-[#FAF7F2]\"\n              onClick={zoomIn}\n            >\n              <Plus size={18} />\n            </Button>\n          </TooltipTrigger>\n          <TooltipContent side=\"right\">Zoom In</TooltipContent>\n        </Tooltip>\n\n        <button\n          onClick={resetZoom}\n          className=\"text-[11px] font-bold text-[#3D2B1F] h-8 min-w-[2.5rem] hover:text-[#C2714F] transition-colors text-center\"\n        >\n          {Math.round(transform.scale * 100)}%\n        </button>\n\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"w-10 h-10 rounded-xl text-[#8C7B6C] hover:text-[#3D2B1F] hover:bg-[#FAF7F2]\"\n              onClick={zoomOut}\n            >\n              <Minus size={18} />\n            </Button>\n          </TooltipTrigger>\n          <TooltipContent side=\"right\">Zoom Out</TooltipContent>\n        </Tooltip>\n\n        <div className=\"w-6 h-px bg-[#E8E2D9] my-1\" />\n\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className={cn(\n                'w-10 h-10 rounded-xl text-[#8C7B6C] hover:text-[#3D2B1F] hover:bg-[#FAF7F2] transition-colors',\n                showMinimap && 'bg-[#C2714F]/10 text-[#C2714F]',\n              )}\n              onClick={() => setShowMinimap(!showMinimap)}\n            >\n              <MapIcon size={18} />\n            </Button>\n          </TooltipTrigger>\n          <TooltipContent side=\"right\">Minimap</TooltipContent>\n        </Tooltip>\n      </div>\n\n      {/* Live Insights Pill */}\n      <div className=\"absolute left-28 bottom-6 bg-white border border-[#E8E2D9] rounded-full px-5 py-2.5 flex items-center gap-2.5 shadow-sm z-30 cursor-pointer hover:shadow-md transition-shadow\">\n        <div className=\"w-2.5 h-2.5 rounded-full bg-[#10b981] animate-pulse\" />\n        <span className=\"text-[13px] font-bold text-[#3D2B1F]\">\n          Live Insights Ativos\n        </span>\n      </div>\n\n      <div\n        className={cn(\n          'absolute left-[88px] z-20 bottom-6 flex pointer-events-none transition-all',\n          hideHeader ? 'top-6' : 'top-28',\n        )}\n      >\n        <div className=\"pointer-events-auto flex h-full\">\n          <BlockPalette funnel={funnel} />\n        </div>\n      </div>\n\n      {showMinimap && (\n        <div className=\"absolute left-28 bottom-20 transition-all duration-300 w-56 h-36 bg-white border border-[#E8E2D9] shadow-lg rounded-2xl overflow-hidden z-30\">\n          <div\n            className=\"w-full h-full relative bg-[#FAF7F2]\"\n            style={{ transform: 'scale(0.08)', transformOrigin: 'top left' }}\n          >\n            {minimapNodes}\n            <div\n              className=\"absolute border-[6px] border-[#C2714F] bg-[#C2714F]/10 rounded-xl\"\n              style={{\n                left: -transform.x / transform.scale,\n                top: -transform.y / transform.scale,\n                width:\n                  (boardRef.current?.clientWidth || 1000) / transform.scale,\n                height:\n                  (boardRef.current?.clientHeight || 800) / transform.scale,\n              }}\n            />\n          </div>\n        </div>\n      )}\n\n      {(selectedNodeObj || selectedEdgeObj) && (\n        <div\n          className={cn(\n            'absolute top-24 bg-white rounded-3xl shadow-xl border border-[#E8E2D9] p-5 w-[280px] flex flex-col gap-6 z-40 transition-all max-h-[80vh] overflow-y-auto',\n            rightPanelState ? 'right-80' : 'right-6',\n          )}\n        >\n          <div className=\"flex justify-between items-center\">\n            <h4 className=\"text-[11px] font-bold text-[#8C7B6C] tracking-widest uppercase\">\n              {isMultiSelect\n                ? 'MÚLTIPLOS SELECIONADOS'\n                : selectedNodeObj\n                  ? selectedNodeObj.type === 'FloatingText'\n                    ? 'ESTILO DE TEXTO'\n                    : ['Square', 'Diamond', 'Circle'].includes(\n                          selectedNodeObj.type,\n                        )\n                      ? 'ESTILO DE FORMA'\n                      : 'ESTILO DE NÓ'\n                  : 'ESTILO DE LINHA'}\n            </h4>\n          </div>\n\n          {selectedNodeObj &&\n            ['Square', 'Diamond', 'Circle'].includes(selectedNodeObj.type) && (\n              <>\n                <div className=\"space-y-3\">\n                  <label className=\"text-[11px] font-bold text-[#8C7B6C] uppercase tracking-wider block\">\n                    Cor de Preenchimento\n                  </label>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {[\n                      'transparent',\n                      '#FAF7F2',\n                      '#3D2B1F',\n                      '#C2714F',\n                      '#E8E2D9',\n                      '#8C7B6C',\n                      '#10b981',\n                      '#f59e0b',\n                      '#ef4444',\n                      '#3b82f6',\n                      '#a855f7',\n                    ].map((c) => (\n                      <button\n                        key={c}\n                        className={cn(\n                          'w-7 h-7 rounded-lg border-2 transition-transform',\n                          selectedNodeObj.style?.fill === c ||\n                            (c === 'transparent' &&\n                              !selectedNodeObj.style?.fill)\n                            ? 'border-[#3D2B1F] scale-110'\n                            : 'border-transparent hover:scale-110',\n                        )}\n                        style={{\n                          backgroundColor: c === 'transparent' ? '#fff' : c,\n                          backgroundImage:\n                            c === 'transparent'\n                              ? 'radial-gradient(#E8E2D9 1px, transparent 0)'\n                              : 'none',\n                          backgroundSize: '4px 4px',\n                        }}\n                        onClick={() => updateNodeStyle({ fill: c })}\n                      />\n                    ))}\n                  </div>\n                </div>\n              </>\n            )}\n\n          {selectedEdgeObj && (\n            <>\n              <div className=\"space-y-3\">\n                <label className=\"text-[11px] font-bold text-[#8C7B6C] uppercase tracking-wider block\">\n                  Estilo da Linha\n                </label>\n                <div className=\"flex gap-2\">\n                  <button\n                    className={cn(\n                      'flex-1 h-9 rounded-lg border-2 flex items-center justify-center transition-colors',\n                      selectedEdgeObj.style?.strokeDasharray === 'none' ||\n                        !selectedEdgeObj.style?.strokeDasharray\n                        ? 'border-[#C2714F] bg-[#C2714F]/10 text-[#C2714F]'\n                        : 'border-[#E8E2D9] bg-white hover:bg-[#FAF7F2] text-[#8C7B6C]',\n                    )}\n                    onClick={() => updateEdgeStyle({ strokeDasharray: 'none' })}\n                  >\n                    <svg width=\"24\" height=\"2\" className=\"overflow-visible\">\n                      <line\n                        x1=\"0\"\n                        y1=\"1\"\n                        x2=\"24\"\n                        y2=\"1\"\n                        stroke=\"currentColor\"\n                        strokeWidth=\"2.5\"\n                      />\n                    </svg>\n                  </button>\n                  <button\n                    className={cn(\n                      'flex-1 h-9 rounded-lg border-2 flex items-center justify-center transition-colors',\n                      selectedEdgeObj.style?.strokeDasharray === '8 8'\n                        ? 'border-[#C2714F] bg-[#C2714F]/10 text-[#C2714F]'\n                        : 'border-[#E8E2D9] bg-white hover:bg-[#FAF7F2] text-[#8C7B6C]',\n                    )}\n                    onClick={() => updateEdgeStyle({ strokeDasharray: '8 8' })}\n                  >\n                    <svg width=\"24\" height=\"2\" className=\"overflow-visible\">\n                      <line\n                        x1=\"0\"\n                        y1=\"1\"\n                        x2=\"24\"\n                        y2=\"1\"\n                        stroke=\"currentColor\"\n                        strokeWidth=\"2.5\"\n                        strokeDasharray=\"6 6\"\n                      />\n                    </svg>\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"space-y-3\">\n                <label className=\"text-[11px] font-bold text-[#8C7B6C] uppercase tracking-wider block\">\n                  Espessura\n                </label>\n                <div className=\"flex gap-4 items-center\">\n                  <input\n                    type=\"range\"\n                    min=\"1\"\n                    max=\"8\"\n                    step=\"1\"\n                    className=\"flex-1 accent-[#C2714F] h-1.5 bg-[#E8E2D9] rounded-full appearance-none cursor-pointer\"\n                    value={selectedEdgeObj.style?.strokeWidth || 2}\n                    onChange={(e) =>\n                      updateEdgeStyle({ strokeWidth: parseInt(e.target.value) })\n                    }\n                  />\n                  <span className=\"text-[13px] font-bold text-[#3D2B1F] w-4 text-center\">\n                    {selectedEdgeObj.style?.strokeWidth || 2}\n                  </span>\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      )}\n\n      <div\n        ref={boardRef}\n        className={cn(\n          'flex-1 relative canvas-container overflow-hidden canvas-grid',\n          isPanning\n            ? 'cursor-grabbing'\n            : isSpacePressed || activeTool === 'Pan'\n              ? 'cursor-grab'\n              : activeTool !== 'Select'\n                ? 'cursor-crosshair'\n                : '',\n        )}\n        style={{\n          backgroundPosition: `${transform.x}px ${transform.y}px`,\n          backgroundSize: `${24 * transform.scale}px ${24 * transform.scale}px`,\n        }}\n        onContextMenu={(e) => e.preventDefault()}\n        onPointerDown={handlePointerDown}\n        onPointerMove={handlePointerMove}\n        onPointerUp={handlePointerUp}\n        onPointerCancel={handlePointerUp}\n        onPointerLeave={handlePointerUp}\n        onDragOver={(e) => e.preventDefault()}\n        onDrop={handleDrop}\n        onDoubleClick={(e) => {\n          const target = e.target as HTMLElement\n          const isBg =\n            target === boardRef.current ||\n            target.classList.contains('canvas-container') ||\n            target.tagName === 'svg'\n\n          if (isBg && activeTool === 'Select') {\n            const rect = boardRef.current?.getBoundingClientRect()\n            if (!rect) return\n            let x = (e.clientX - rect.left - transform.x) / transform.scale - 50\n            let y = (e.clientY - rect.top - transform.y) / transform.scale - 15\n            if (snapToGrid) {\n              x = Math.round(x / 28) * 28\n              y = Math.round(y / 28) * 28\n            }\n            const newNodeId = generateId('n')\n            onChangeWithHistory({\n              ...funnel,\n              nodes: [\n                ...funnel.nodes,\n                {\n                  id: newNodeId,\n                  type: 'FloatingText',\n                  x,\n                  y,\n                  data: { name: 'New Text', status: '', subtitle: '' },\n                  style: { color: '#3D2B1F' },\n                },\n              ],\n            })\n            setSelectedNodes([newNodeId])\n          }\n        }}\n      >\n        <div\n          style={{\n            transform: `translate3d(${transform.x}px, ${transform.y}px, 0) scale(${transform.scale})`,\n            transformOrigin: '0 0',\n            willChange: 'transform',\n          }}\n          className=\"absolute inset-0 w-full h-full pointer-events-none\"\n        >\n          <svg className=\"absolute inset-0 w-full h-full overflow-visible z-0 pointer-events-none\">\n            <defs>\n              <linearGradient\n                id=\"edge-gradient\"\n                x1=\"0%\"\n                y1=\"0%\"\n                x2=\"100%\"\n                y2=\"0%\"\n              >\n                <stop offset=\"0%\" stopColor=\"#C2714F\" />\n                <stop offset=\"100%\" stopColor=\"#8C7B6C\" />\n              </linearGradient>\n            </defs>\n            {funnel.edges.map((e) => {\n              const sourceNode = effectiveNodesMap.get(e.source)\n              const targetNode = effectiveNodesMap.get(e.target)\n              if (!sourceNode || !targetNode) return null\n              const isSelected = selectedEdge === e.id\n\n              return (\n                <EdgeItem\n                  key={e.id}\n                  edge={e}\n                  sourceNode={sourceNode}\n                  targetNode={targetNode}\n                  isSelected={isSelected}\n                  activeTool={activeTool}\n                  onSelect={(ev) => {\n                    ev.stopPropagation()\n                    if (latest.current.activeTool === 'Select') {\n                      setSelectedEdge(e.id)\n                      setSelectedNodes([])\n                    }\n                  }}\n                />\n              )\n            })}\n            {drawingEdge &&\n              (() => {\n                const sNode = funnel.nodes.find(\n                  (n) => n.id === drawingEdge.source,\n                )\n                if (!sNode) return null\n                const sourceCoords = getRightPortCoords(sNode, sNode.x, sNode.y)\n                return (\n                  <path\n                    d={`M ${sourceCoords.x} ${sourceCoords.y} C ${sourceCoords.x + 80} ${sourceCoords.y}, ${drawingEdge.currentX - 80} ${drawingEdge.currentY}, ${drawingEdge.currentX} ${drawingEdge.currentY}`}\n                    stroke=\"#C2714F\"\n                    strokeWidth=\"3\"\n                    strokeDasharray=\"4 4\"\n                    fill=\"none\"\n                    strokeLinecap=\"round\"\n                  />\n                )\n              })()}\n            {selectionBox &&\n              (() => {\n                const w = Math.abs(selectionBox.currentX - selectionBox.startX)\n                const h = Math.abs(selectionBox.currentY - selectionBox.startY)\n                const x = Math.min(selectionBox.startX, selectionBox.currentX)\n                const y = Math.min(selectionBox.startY, selectionBox.currentY)\n                return (\n                  <rect\n                    x={x}\n                    y={y}\n                    width={w}\n                    height={h}\n                    fill=\"rgba(194, 113, 79, 0.1)\"\n                    stroke=\"#C2714F\"\n                    strokeWidth={2 / transform.scale}\n                    rx={8}\n                  />\n                )\n              })()}\n          </svg>\n\n          <div className=\"absolute inset-0 w-full h-full pointer-events-none\">\n            {funnel.nodes.map((n) => {\n              const nodeTasks = tasks.filter((t) =>\n                n.data.linkedTaskIds?.includes(t.id),\n              )\n              let total = 0\n              let completed = 0\n              nodeTasks.forEach((t) => {\n                if (t.subtasks && t.subtasks.length > 0) {\n                  total += t.subtasks.length\n                  completed += t.subtasks.filter((s) => s.isCompleted).length\n                } else {\n                  total += 1\n                  if (t.status === 'Concluído') completed += 1\n                }\n              })\n              const taskProgress = { total, completed }\n              const isNodeDragging = !!dragState && selectedNodes.includes(n.id)\n\n              return (\n                <MemoizedNodeItem\n                  key={n.id}\n                  node={effectiveNodesMap.get(n.id)!}\n                  selected={selectedNodes.includes(n.id)}\n                  isNodeDragging={isNodeDragging}\n                  snapToGrid={snapToGrid}\n                  activeTool={activeTool}\n                  taskProgress={taskProgress}\n                  onPointerDownAction={(shiftKey) =>\n                    handleNodePointerDown(n.id, shiftKey)\n                  }\n                  onMove={(dx, dy) =>\n                    setDragState({ isDragging: true, dx, dy })\n                  }\n                  onMoveEnd={(dx, dy) => {\n                    const { funnel, selectedNodes } = latest.current\n                    setDragState(null)\n                    if (dx === 0 && dy === 0) return\n                    onChangeWithHistory({\n                      ...funnel,\n                      nodes: funnel.nodes.map((node) =>\n                        selectedNodes.includes(node.id) || node.id === n.id\n                          ? { ...node, x: node.x + dx, y: node.y + dy }\n                          : node,\n                      ),\n                    })\n                  }}\n                  onResize={(x, y, w, h) =>\n                    setResizingNode({ id: n.id, x, y, width: w, height: h })\n                  }\n                  onResizeEnd={(x, y, w, h) => {\n                    const { funnel } = latest.current\n                    setResizingNode(null)\n                    onChangeWithHistory({\n                      ...funnel,\n                      nodes: funnel.nodes.map((node) =>\n                        node.id === n.id\n                          ? { ...node, x, y, width: w, height: h }\n                          : node,\n                      ),\n                    })\n                  }}\n                  onAddChild={() => handleAddChild(n.id)}\n                  onDelete={() => {\n                    const { selectedNodes } = latest.current\n                    if (selectedNodes.includes(n.id))\n                      setNodeToDelete('selected')\n                    else setNodeToDelete(n.id)\n                  }}\n                  onOpenRightPanel={(tab) =>\n                    setRightPanelState({ nodeId: n.id, tab })\n                  }\n                  onOpenSettings={() => setSettingsNodeId(n.id)}\n                  onToggleComplete={() => {\n                    const { funnel } = latest.current\n                    onChangeWithHistory({\n                      ...funnel,\n                      nodes: funnel.nodes.map((node) =>\n                        node.id === n.id\n                          ? {\n                              ...node,\n                              data: {\n                                ...node.data,\n                                isCompleted: !node.data.isCompleted,\n                              },\n                            }\n                          : node,\n                      ),\n                    })\n                  }}\n                  scale={transform.scale}\n                  onTextChange={(text) => {\n                    const { funnel } = latest.current\n                    onChangeWithHistory({\n                      ...funnel,\n                      nodes: funnel.nodes.map((node) =>\n                        node.id === n.id\n                          ? { ...node, data: { ...node.data, name: text } }\n                          : node,\n                      ),\n                    })\n                  }}\n                  onEdgeDragStart={handleEdgeDragStart}\n                  onDropResource={handleDropResource}\n                />\n              )\n            })}\n          </div>\n        </div>\n      </div>\n\n      {rightPanelState &&\n        funnel.nodes.find((n) => n.id === rightPanelState.nodeId) && (\n          <RightPanel\n            node={funnel.nodes.find((n) => n.id === rightPanelState.nodeId)!}\n            funnel={funnel}\n            defaultTab={rightPanelState.tab}\n            hideHeader={hideHeader}\n            onChange={(n) =>\n              onChangeWithHistory({\n                ...funnel,\n                nodes: funnel.nodes.map((node) =>\n                  node.id === n.id ? n : node,\n                ),\n              })\n            }\n            onClose={() => setRightPanelState(null)}\n          />\n        )}\n      <NodeSettingsModal\n        node={\n          settingsNodeId\n            ? funnel.nodes.find((n) => n.id === settingsNodeId) || null\n            : null\n        }\n        isOpen={!!settingsNodeId}\n        onClose={() => setSettingsNodeId(null)}\n        onSave={(id, updates) => {\n          onChangeWithHistory({\n            ...funnel,\n            nodes: funnel.nodes.map((n) =>\n              n.id === id ? { ...n, data: { ...n.data, ...updates } } : n,\n            ),\n          })\n          setSettingsNodeId(null)\n        }}\n      />\n\n      <ConfirmDialog\n        open={!!nodeToDelete}\n        onOpenChange={(open) => !open && setNodeToDelete(null)}\n        title=\"Excluir Elementos?\"\n        description=\"Esta ação removerá os elementos selecionados do canvas. Deseja continuar?\"\n        confirmLabel=\"Excluir\"\n        variant=\"destructive\"\n        onConfirm={handleConfirmDelete}\n      />\n    </div>\n  )\n}\n"],"x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,22],"mappings":"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"}