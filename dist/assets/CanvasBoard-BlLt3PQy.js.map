{"version":3,"file":"CanvasBoard-BlLt3PQy.js","names":["__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","__iconNode","icons: Record<string, any>","newTask: Task","newTask: Task","Switch","newAsset: Resource","newNode: Node"],"sources":["../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/arrow-left.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/circle-arrow-up.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/circle-check-big.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/credit-card.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/diamond.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/dollar-sign.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/hand-heart.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/hand.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/mail.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/map.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/megaphone.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/message-circle.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/minus.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/mouse-pointer-2.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/pen.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/phone.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/settings.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/smartphone.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/square.js","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/lucide-react@0.575.0_react@19.2.4/node_modules/lucide-react/dist/esm/icons/type.js","../../src/components/canvas/BlockPalette.tsx","../../src/components/canvas/NodeItem.tsx","../../src/components/canvas/RightPanel.tsx","../../../../cache/modules/funil-os-copy-copy-b831e/node_modules/.pnpm/@radix-ui+react-switch@1.2.6_@types+react-dom@19.2.3_@types+react@19.2.14__@types+react_e3738c514c10df2ef7e24af5ee461853/node_modules/@radix-ui/react-switch/dist/index.mjs","../../src/components/ui/switch.tsx","../../src/components/canvas/NodeSettingsModal.tsx","../../src/hooks/useCanvasHistory.ts","../../src/hooks/useCanvasTransform.ts","../../src/hooks/useCanvasSelection.ts","../../src/components/canvas/CanvasBoard.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m12 19-7-7 7-7\", key: \"1l729n\" }],\n  [\"path\", { d: \"M19 12H5\", key: \"x3x0zl\" }]\n];\nconst ArrowLeft = createLucideIcon(\"arrow-left\", __iconNode);\n\nexport { __iconNode, ArrowLeft as default };\n//# sourceMappingURL=arrow-left.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"m16 12-4-4-4 4\", key: \"177agl\" }],\n  [\"path\", { d: \"M12 16V8\", key: \"1sbj14\" }]\n];\nconst CircleArrowUp = createLucideIcon(\"circle-arrow-up\", __iconNode);\n\nexport { __iconNode, CircleArrowUp as default };\n//# sourceMappingURL=circle-arrow-up.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M21.801 10A10 10 0 1 1 17 3.335\", key: \"yps3ct\" }],\n  [\"path\", { d: \"m9 11 3 3L22 4\", key: \"1pflzl\" }]\n];\nconst CircleCheckBig = createLucideIcon(\"circle-check-big\", __iconNode);\n\nexport { __iconNode, CircleCheckBig as default };\n//# sourceMappingURL=circle-check-big.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"20\", height: \"14\", x: \"2\", y: \"5\", rx: \"2\", key: \"ynyp8z\" }],\n  [\"line\", { x1: \"2\", x2: \"22\", y1: \"10\", y2: \"10\", key: \"1b3vmo\" }]\n];\nconst CreditCard = createLucideIcon(\"credit-card\", __iconNode);\n\nexport { __iconNode, CreditCard as default };\n//# sourceMappingURL=credit-card.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z\",\n      key: \"1f1r0c\"\n    }\n  ]\n];\nconst Diamond = createLucideIcon(\"diamond\", __iconNode);\n\nexport { __iconNode, Diamond as default };\n//# sourceMappingURL=diamond.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"2\", y2: \"22\", key: \"7eqyqh\" }],\n  [\"path\", { d: \"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\", key: \"1b0p4s\" }]\n];\nconst DollarSign = createLucideIcon(\"dollar-sign\", __iconNode);\n\nexport { __iconNode, DollarSign as default };\n//# sourceMappingURL=dollar-sign.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M11 14h2a2 2 0 0 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16\", key: \"1v1a37\" }],\n  [\n    \"path\",\n    {\n      d: \"m14.45 13.39 5.05-4.694C20.196 8 21 6.85 21 5.75a2.75 2.75 0 0 0-4.797-1.837.276.276 0 0 1-.406 0A2.75 2.75 0 0 0 11 5.75c0 1.2.802 2.248 1.5 2.946L16 11.95\",\n      key: \"fhfbnt\"\n    }\n  ],\n  [\"path\", { d: \"m2 15 6 6\", key: \"10dquu\" }],\n  [\n    \"path\",\n    {\n      d: \"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a1 1 0 0 0-2.75-2.91\",\n      key: \"1x6kdw\"\n    }\n  ]\n];\nconst HandHeart = createLucideIcon(\"hand-heart\", __iconNode);\n\nexport { __iconNode, HandHeart as default };\n//# sourceMappingURL=hand-heart.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2\", key: \"1fvzgz\" }],\n  [\"path\", { d: \"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2\", key: \"1kc0my\" }],\n  [\"path\", { d: \"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8\", key: \"10h0bg\" }],\n  [\n    \"path\",\n    {\n      d: \"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15\",\n      key: \"1s1gnw\"\n    }\n  ]\n];\nconst Hand = createLucideIcon(\"hand\", __iconNode);\n\nexport { __iconNode, Hand as default };\n//# sourceMappingURL=hand.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7\", key: \"132q7q\" }],\n  [\"rect\", { x: \"2\", y: \"4\", width: \"20\", height: \"16\", rx: \"2\", key: \"izxlao\" }]\n];\nconst Mail = createLucideIcon(\"mail\", __iconNode);\n\nexport { __iconNode, Mail as default };\n//# sourceMappingURL=mail.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z\",\n      key: \"169xi5\"\n    }\n  ],\n  [\"path\", { d: \"M15 5.764v15\", key: \"1pn4in\" }],\n  [\"path\", { d: \"M9 3.236v15\", key: \"1uimfh\" }]\n];\nconst Map = createLucideIcon(\"map\", __iconNode);\n\nexport { __iconNode, Map as default };\n//# sourceMappingURL=map.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z\",\n      key: \"q8bfy3\"\n    }\n  ],\n  [\"path\", { d: \"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14\", key: \"1853fq\" }],\n  [\"path\", { d: \"M8 6v8\", key: \"15ugcq\" }]\n];\nconst Megaphone = createLucideIcon(\"megaphone\", __iconNode);\n\nexport { __iconNode, Megaphone as default };\n//# sourceMappingURL=megaphone.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719\",\n      key: \"1sd12s\"\n    }\n  ]\n];\nconst MessageCircle = createLucideIcon(\"message-circle\", __iconNode);\n\nexport { __iconNode, MessageCircle as default };\n//# sourceMappingURL=message-circle.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"M5 12h14\", key: \"1ays0h\" }]];\nconst Minus = createLucideIcon(\"minus\", __iconNode);\n\nexport { __iconNode, Minus as default };\n//# sourceMappingURL=minus.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z\",\n      key: \"edeuup\"\n    }\n  ]\n];\nconst MousePointer2 = createLucideIcon(\"mouse-pointer-2\", __iconNode);\n\nexport { __iconNode, MousePointer2 as default };\n//# sourceMappingURL=mouse-pointer-2.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z\",\n      key: \"1a8usu\"\n    }\n  ]\n];\nconst Pen = createLucideIcon(\"pen\", __iconNode);\n\nexport { __iconNode, Pen as default };\n//# sourceMappingURL=pen.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384\",\n      key: \"9njp5v\"\n    }\n  ]\n];\nconst Phone = createLucideIcon(\"phone\", __iconNode);\n\nexport { __iconNode, Phone as default };\n//# sourceMappingURL=phone.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915\",\n      key: \"1i5ecw\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n];\nconst Settings = createLucideIcon(\"settings\", __iconNode);\n\nexport { __iconNode, Settings as default };\n//# sourceMappingURL=settings.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"14\", height: \"20\", x: \"5\", y: \"2\", rx: \"2\", ry: \"2\", key: \"1yt0o3\" }],\n  [\"path\", { d: \"M12 18h.01\", key: \"mhygvu\" }]\n];\nconst Smartphone = createLucideIcon(\"smartphone\", __iconNode);\n\nexport { __iconNode, Smartphone as default };\n//# sourceMappingURL=smartphone.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"18\", height: \"18\", x: \"3\", y: \"3\", rx: \"2\", key: \"afitv7\" }]\n];\nconst Square = createLucideIcon(\"square\", __iconNode);\n\nexport { __iconNode, Square as default };\n//# sourceMappingURL=square.js.map\n","/**\n * @license lucide-react v0.575.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 4v16\", key: \"1654pz\" }],\n  [\"path\", { d: \"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2\", key: \"e0r10z\" }],\n  [\"path\", { d: \"M9 20h6\", key: \"s66wpe\" }]\n];\nconst Type = createLucideIcon(\"type\", __iconNode);\n\nexport { __iconNode, Type as default };\n//# sourceMappingURL=type.js.map\n","import React from 'react'\nimport {\n  Mail,\n  MessageSquare,\n  MessageCircle,\n  Phone,\n  Smartphone,\n  Clock,\n  LayoutTemplate,\n  CreditCard,\n  ArrowUpCircle,\n  CheckCircle,\n  FileText,\n  Megaphone,\n} from 'lucide-react'\nimport { Funnel } from '@/types'\n\nconst BLOCK_CATEGORIES = [\n  {\n    title: 'MESSAGES',\n    iconColor: 'text-purple-500',\n    blocks: [\n      { type: 'Email', icon: Mail, label: 'Email' },\n      { type: 'Slack', icon: MessageSquare, label: 'Slack' },\n      { type: 'SMS', icon: MessageCircle, label: 'SMS' },\n      { type: 'WhatsApp', icon: Phone, label: 'WATI (WhatsApp)' },\n      { type: 'ManyChat', icon: Smartphone, label: 'ManyChat (WhatsApp)' },\n    ],\n  },\n  {\n    title: 'DELAYS',\n    iconColor: 'text-purple-500',\n    blocks: [{ type: 'Wait', icon: Clock, label: 'Wait Until' }],\n  },\n  {\n    title: 'PAGES',\n    iconColor: 'text-purple-500',\n    blocks: [\n      { type: 'LandingPage', icon: LayoutTemplate, label: 'Landing Page' },\n      { type: 'Checkout', icon: CreditCard, label: 'Checkout' },\n      { type: 'Upsell', icon: ArrowUpCircle, label: 'Upsell' },\n      { type: 'ThankYou', icon: CheckCircle, label: 'Thank You' },\n      { type: 'Form', icon: FileText, label: 'Form' },\n      { type: 'Ad', icon: Megaphone, label: 'Ad Campaign' },\n    ],\n  },\n]\n\nexport default function BlockPalette({ funnel }: { funnel: Funnel }) {\n  const onDragStart = (e: React.DragEvent, type: string) => {\n    e.dataTransfer.setData('blockType', type)\n  }\n\n  return (\n    <div className=\"w-[260px] h-[calc(100%-2rem)] bg-white rounded-3xl border border-slate-100 shadow-[0_8px_30px_rgba(0,0,0,0.06)] flex flex-col overflow-hidden my-4 ml-4 z-20\">\n      <div className=\"flex-1 overflow-y-auto p-5 no-scrollbar space-y-8\">\n        {BLOCK_CATEGORIES.map((cat, idx) => (\n          <div key={idx} className=\"space-y-4\">\n            <div className=\"flex items-center gap-2 px-1\">\n              <div\n                className={`w-2 h-2 rotate-45 bg-current ${cat.iconColor}`}\n              />\n              <h4 className=\"text-[11px] font-bold text-slate-500 tracking-widest uppercase\">\n                {cat.title}\n              </h4>\n            </div>\n            <div className=\"flex flex-col gap-1\">\n              {cat.blocks.map((block) => (\n                <div\n                  key={block.type}\n                  draggable\n                  onDragStart={(e) => onDragStart(e, block.type)}\n                  className=\"flex items-center gap-4 p-3 hover:bg-slate-50 rounded-2xl cursor-grab active:cursor-grabbing transition-colors text-slate-700 border border-transparent hover:border-slate-100\"\n                >\n                  <block.icon\n                    size={18}\n                    className=\"text-slate-400 shrink-0\"\n                    strokeWidth={1.5}\n                  />\n                  <span className=\"text-[13px] font-medium truncate\">\n                    {block.label}\n                  </span>\n                </div>\n              ))}\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  )\n}\n","import { useState, useRef, useEffect } from 'react'\nimport { generateId } from '@/lib/generateId'\nimport { Node, Task } from '@/types'\nimport { cn } from '@/lib/utils'\nimport useTaskStore from '@/stores/useTaskStore'\nimport useFunnelStore from '@/stores/useFunnelStore'\nimport {\n  Megaphone,\n  LayoutTemplate,\n  MessageCircle,\n  Mail,\n  DollarSign,\n  HandHeart,\n  CheckCircle,\n  FileText,\n  Settings,\n  Trash2,\n  Zap,\n  MessageSquare,\n  Clock,\n  ExternalLink,\n  Image as ImageIcon,\n  CheckSquare,\n  Plus,\n  X,\n} from 'lucide-react'\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from '@/components/ui/tooltip'\nimport { Checkbox } from '@/components/ui/checkbox'\n\nconst icons: Record<string, any> = {\n  Ad: Megaphone,\n  LandingPage: LayoutTemplate,\n  Email: Mail,\n  Checkout: DollarSign,\n  Upsell: HandHeart,\n  Obrigado: CheckCircle,\n  Form: FileText,\n  Slack: MessageSquare,\n  SMS: MessageCircle,\n  WATI: MessageCircle,\n  ManyChat: MessageCircle,\n  WaitUntil: Clock,\n  Default: Zap,\n}\n\ntype NodeItemProps = {\n  node: Node\n  selected: boolean\n  snapToGrid?: boolean\n  activeTool: string\n  taskProgress: { total: number; completed: number }\n  onPointerDownAction: (shiftKey: boolean) => void\n  onMove: (dx: number, dy: number) => void\n  onMoveEnd: (dx: number, dy: number) => void\n  onResize?: (x: number, y: number, w: number, h: number) => void\n  onResizeEnd?: (x: number, y: number, w: number, h: number) => void\n  scale: number\n  onOpenRightPanel: (tab: string) => void\n  onOpenSettings: () => void\n  onToggleComplete: () => void\n  onDelete: () => void\n  onAddChild: () => void\n  onTextChange: (text: string) => void\n  onEdgeDragStart: (nodeId: string, e: React.PointerEvent) => void\n  onDropResource: (type: string, id: string) => void\n}\n\nexport default function NodeItem({\n  node,\n  selected,\n  snapToGrid,\n  activeTool,\n  taskProgress,\n  onPointerDownAction,\n  onMove,\n  onMoveEnd,\n  onResize,\n  onResizeEnd,\n  scale,\n  onOpenRightPanel,\n  onOpenSettings,\n  onToggleComplete,\n  onDelete,\n  onAddChild,\n  onTextChange,\n  onEdgeDragStart,\n  onDropResource,\n}: NodeItemProps) {\n  const [isDragging, setIsDragging] = useState(false)\n  const [isResizing, setIsResizing] = useState(false)\n  const [isHovered, setIsHovered] = useState(false)\n  const [isEditingText, setIsEditingText] = useState(false)\n  const textRef = useRef<HTMLDivElement>(null)\n  const hasAutoSelected = useRef(false)\n\n  const [tasks, setTasks] = useTaskStore()\n  const [funnels] = useFunnelStore()\n  const [newTaskTitle, setNewTaskTitle] = useState('')\n  const [isAddingTask, setIsAddingTask] = useState(false)\n\n  const callbacksRef = useRef({\n    onPointerDownAction,\n    onMove,\n    onMoveEnd,\n    onResize,\n    onResizeEnd,\n  })\n\n  // Synchronously update callbacks ref on each render to avoid stale closures in event listeners\n  callbacksRef.current = {\n    onPointerDownAction,\n    onMove,\n    onMoveEnd,\n    onResize,\n    onResizeEnd,\n  }\n\n  const funnel = funnels.find((f) => f.nodes.some((n) => n.id === node.id))\n  const linkedTasks = tasks.filter(\n    (t) => t.nodeId === node.id || node.data.linkedTaskIds?.includes(t.id),\n  )\n\n  const isPanMode = activeTool === 'Pan'\n  const isSelectMode = activeTool === 'Select'\n\n  useEffect(() => {\n    if (\n      node.type === 'FloatingText' &&\n      node.data.name === 'New Text' &&\n      !hasAutoSelected.current\n    ) {\n      hasAutoSelected.current = true\n      setIsEditingText(true)\n      setTimeout(() => {\n        if (textRef.current) {\n          textRef.current.focus()\n          document.execCommand('selectAll', false, undefined)\n        }\n      }, 0)\n    }\n  }, [node.type, node.data.name])\n\n  const handleToggleTask = (task: Task) => {\n    const newStatus = task.status === 'Concluído' ? 'A Fazer' : 'Concluído'\n    setTasks(\n      tasks.map((t) => (t.id === task.id ? { ...t, status: newStatus } : t)),\n    )\n  }\n\n  const handleDeleteTask = (taskId: string) => {\n    setTasks(tasks.filter((t) => t.id !== taskId))\n  }\n\n  const handleAddTask = () => {\n    if (!newTaskTitle.trim()) {\n      setIsAddingTask(false)\n      return\n    }\n\n    const newTask: Task = {\n      id: generateId('t'),\n      title: newTaskTitle.trim(),\n      projectId: funnel?.projectId || null,\n      funnelId: funnel?.id,\n      nodeId: node.id,\n      priority: 'Média',\n      status: 'A Fazer',\n      deadline: new Date(Date.now() + 86400000).toISOString(),\n    }\n\n    setTasks([...tasks, newTask])\n    setNewTaskTitle('')\n    setIsAddingTask(false)\n  }\n\n  const handlePointerDown = (e: React.PointerEvent) => {\n    if (e.button !== 0) return\n    const target = e.target as HTMLElement\n    if (\n      isPanMode ||\n      target.closest('button') ||\n      target.closest('.interactive-icon') ||\n      target.closest('[role=\"checkbox\"]') ||\n      target.closest('input') ||\n      target.closest('.resize-handle') ||\n      !isSelectMode\n    )\n      return\n    e.stopPropagation()\n    target.setPointerCapture(e.pointerId)\n    setIsDragging(true)\n    callbacksRef.current.onPointerDownAction(e.shiftKey)\n    document.body.style.userSelect = 'none'\n\n    const startX = e.clientX\n    const startY = e.clientY\n    const initialNodeX = node.x\n    const initialNodeY = node.y\n\n    const handlePointerMove = (moveEv: PointerEvent) => {\n      let dx = (moveEv.clientX - startX) / scale\n      let dy = (moveEv.clientY - startY) / scale\n      if (snapToGrid) {\n        const snappedX = Math.round((initialNodeX + dx) / 28) * 28\n        const snappedY = Math.round((initialNodeY + dy) / 28) * 28\n        dx = snappedX - initialNodeX\n        dy = snappedY - initialNodeY\n      }\n      callbacksRef.current.onMove(dx, dy)\n    }\n\n    const handlePointerUp = (upEv: PointerEvent) => {\n      try {\n        target.releasePointerCapture(upEv.pointerId)\n      } catch (err) {\n        // ignore\n      }\n      setIsDragging(false)\n      document.body.style.userSelect = ''\n      let dx = (upEv.clientX - startX) / scale\n      let dy = (upEv.clientY - startY) / scale\n      if (snapToGrid) {\n        const snappedX = Math.round((initialNodeX + dx) / 28) * 28\n        const snappedY = Math.round((initialNodeY + dy) / 28) * 28\n        dx = snappedX - initialNodeX\n        dy = snappedY - initialNodeY\n      }\n      callbacksRef.current.onMoveEnd(dx, dy)\n      window.removeEventListener('pointermove', handlePointerMove)\n      window.removeEventListener('pointerup', handlePointerUp)\n      window.removeEventListener('pointercancel', handlePointerUp)\n    }\n    window.addEventListener('pointermove', handlePointerMove)\n    window.addEventListener('pointerup', handlePointerUp)\n    window.addEventListener('pointercancel', handlePointerUp)\n  }\n\n  const handleResizeStart = (e: React.PointerEvent, corner: string) => {\n    if (e.button !== 0) return\n    e.stopPropagation()\n    const target = e.target as HTMLElement\n    target.setPointerCapture(e.pointerId)\n    setIsResizing(true)\n    callbacksRef.current.onPointerDownAction(e.shiftKey)\n    document.body.style.userSelect = 'none'\n\n    const startX = e.clientX\n    const startY = e.clientY\n    const initialX = node.x\n    const initialY = node.y\n    const initialW = node.width || 120\n    const initialH = node.height || 120\n    const isSquare = e.shiftKey\n\n    const handlePointerMove = (moveEv: PointerEvent) => {\n      let dx = (moveEv.clientX - startX) / scale\n      let dy = (moveEv.clientY - startY) / scale\n\n      let newX = initialX\n      let newY = initialY\n      let newW = initialW\n      let newH = initialH\n\n      if (corner.includes('e')) newW = Math.max(20, initialW + dx)\n      if (corner.includes('s')) newH = Math.max(20, initialH + dy)\n      if (corner.includes('w')) {\n        const mw = Math.max(20, initialW - dx)\n        newX = initialX + (initialW - mw)\n        newW = mw\n      }\n      if (corner.includes('n')) {\n        const mh = Math.max(20, initialH - dy)\n        newY = initialY + (initialH - mh)\n        newH = mh\n      }\n\n      if (isSquare) {\n        const size = Math.max(newW, newH)\n        newW = size\n        newH = size\n      }\n\n      if (snapToGrid) {\n        newX = Math.round(newX / 28) * 28\n        newY = Math.round(newY / 28) * 28\n        newW = Math.round(newW / 28) * 28\n        newH = Math.round(newH / 28) * 28\n      }\n\n      callbacksRef.current.onResize?.(newX, newY, newW, newH)\n    }\n\n    const handlePointerUp = (upEv: PointerEvent) => {\n      try {\n        target.releasePointerCapture(upEv.pointerId)\n      } catch (err) {\n        /* ignore */\n      }\n      setIsResizing(false)\n      document.body.style.userSelect = ''\n\n      let dx = (upEv.clientX - startX) / scale\n      let dy = (upEv.clientY - startY) / scale\n\n      let newX = initialX\n      let newY = initialY\n      let newW = initialW\n      let newH = initialH\n\n      if (corner.includes('e')) newW = Math.max(20, initialW + dx)\n      if (corner.includes('s')) newH = Math.max(20, initialH + dy)\n      if (corner.includes('w')) {\n        const mw = Math.max(20, initialW - dx)\n        newX = initialX + (initialW - mw)\n        newW = mw\n      }\n      if (corner.includes('n')) {\n        const mh = Math.max(20, initialH - dy)\n        newY = initialY + (initialH - mh)\n        newH = mh\n      }\n\n      if (isSquare) {\n        const size = Math.max(newW, newH)\n        newW = size\n        newH = size\n      }\n\n      if (snapToGrid) {\n        newX = Math.round(newX / 28) * 28\n        newY = Math.round(newY / 28) * 28\n        newW = Math.round(newW / 28) * 28\n        newH = Math.round(newH / 28) * 28\n      }\n      callbacksRef.current.onResizeEnd?.(newX, newY, newW, newH)\n      window.removeEventListener('pointermove', handlePointerMove)\n      window.removeEventListener('pointerup', handlePointerUp)\n      window.removeEventListener('pointercancel', handlePointerUp)\n    }\n    window.addEventListener('pointermove', handlePointerMove)\n    window.addEventListener('pointerup', handlePointerUp)\n    window.addEventListener('pointercancel', handlePointerUp)\n  }\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault()\n    e.stopPropagation()\n    const resType = e.dataTransfer.getData('resourceType')\n    const resId = e.dataTransfer.getData('resourceId')\n    if (resType && resId) {\n      onDropResource(resType, resId)\n    }\n  }\n\n  const getBackgroundColor = () => {\n    if (node.data.isTaskMode && node.data.isCompleted) return undefined\n    const fill = node.style?.fill\n    const opacity = node.style?.opacity ?? 1\n    if (!fill || fill === 'transparent') {\n      if (opacity < 1) return `rgba(255, 255, 255, ${opacity})`\n      return undefined\n    }\n    if (fill.startsWith('#')) {\n      let r, g, b\n      if (fill.length === 4) {\n        r = parseInt(fill[1] + fill[1], 16)\n        g = parseInt(fill[2] + fill[2], 16)\n        b = parseInt(fill[3] + fill[3], 16)\n      } else {\n        r = parseInt(fill.slice(1, 3), 16)\n        g = parseInt(fill.slice(3, 5), 16)\n        b = parseInt(fill.slice(5, 7), 16)\n      }\n      return `rgba(${r}, ${g}, ${b}, ${opacity})`\n    }\n    return fill\n  }\n\n  if (node.type === 'FloatingText') {\n    return (\n      <div\n        className={cn(\n          'absolute top-0 left-0 pointer-events-auto min-w-[50px] p-2 z-10 group outline-none',\n          selected && 'ring-2 ring-purple-500/60 shadow-lg rounded-md',\n          isDragging\n            ? 'opacity-95 scale-[1.02] z-50 cursor-grabbing shadow-xl ring-2 ring-purple-500/30 rounded-md'\n            : isPanMode\n              ? 'cursor-grab'\n              : isSelectMode\n                ? isEditingText\n                  ? 'cursor-text'\n                  : 'cursor-pointer'\n                : '',\n        )}\n        style={{\n          transform: `translate3d(${node.x}px, ${node.y}px, 0)`,\n          color: node.style?.color || '#1e293b',\n          transition: isDragging\n            ? 'none'\n            : 'transform 0.15s cubic-bezier(0.2, 0, 0, 1)',\n        }}\n        onPointerDown={(e) => {\n          if (isEditingText) {\n            e.stopPropagation()\n            return\n          }\n          handlePointerDown(e)\n        }}\n        onDoubleClick={(e) => {\n          if (!isPanMode && isSelectMode) {\n            e.stopPropagation()\n            setIsEditingText(true)\n            setTimeout(() => {\n              textRef.current?.focus()\n              const selection = window.getSelection()\n              const range = document.createRange()\n              range.selectNodeContents(textRef.current!)\n              selection?.removeAllRanges()\n              selection?.addRange(range)\n            }, 0)\n          }\n        }}\n        onMouseEnter={() => setIsHovered(true)}\n        onMouseLeave={() => setIsHovered(false)}\n        data-node-id={node.id}\n      >\n        <div\n          ref={textRef}\n          className=\"font-medium text-[15px] whitespace-pre-wrap outline-none min-h-[24px] min-w-[20px]\"\n          contentEditable={isEditingText}\n          suppressContentEditableWarning\n          onPointerDown={(e) => {\n            if (isEditingText) e.stopPropagation()\n          }}\n          onBlur={(e) => {\n            setIsEditingText(false)\n            const val = e.currentTarget.textContent || 'Text'\n            onTextChange(val)\n          }}\n        >\n          {node.data.name}\n        </div>\n\n        {!isPanMode && isSelectMode && (\n          <div\n            className=\"absolute -right-3 top-1/2 -translate-y-1/2 w-6 h-6 flex items-center justify-center cursor-crosshair z-20 group/port interactive-icon opacity-0 group-hover:opacity-100 transition-opacity\"\n            onPointerDown={(e) => {\n              e.stopPropagation()\n              onEdgeDragStart(node.id, e)\n            }}\n          >\n            <div className=\"w-3 h-3 rounded-full bg-white border-2 border-slate-200 group-hover/port:border-purple-500 group-hover/port:scale-125 transition-all shadow-sm\" />\n          </div>\n        )}\n\n        <div\n          className={cn(\n            'absolute -top-3 -right-3 flex items-center gap-1.5 z-20 transition-opacity',\n            selected || isHovered\n              ? 'opacity-100'\n              : 'opacity-0 pointer-events-none',\n          )}\n        >\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <button\n                onClick={(e) => {\n                  e.stopPropagation()\n                  onDelete()\n                }}\n                className=\"interactive-icon w-7 h-7 bg-white border border-slate-100 rounded-full flex items-center justify-center text-red-400 hover:text-red-600 shadow-sm transition-transform hover:scale-110\"\n              >\n                <Trash2 size={13} strokeWidth={2.5} />\n              </button>\n            </TooltipTrigger>\n            <TooltipContent>Excluir</TooltipContent>\n          </Tooltip>\n        </div>\n      </div>\n    )\n  }\n\n  if (['Square', 'Diamond', 'Circle'].includes(node.type)) {\n    const w = node.width || 120\n    const h = node.height || 120\n\n    return (\n      <div\n        className={cn(\n          'absolute top-0 left-0 pointer-events-auto flex items-center justify-center z-10 group text-slate-700',\n          selected && 'shadow-md',\n          isDragging || isResizing\n            ? 'opacity-95 z-50 shadow-[0_25px_50px_-12px_rgba(0,0,0,0.25)] cursor-grabbing scale-[1.02]'\n            : isPanMode\n              ? 'cursor-grab'\n              : isSelectMode\n                ? 'cursor-pointer'\n                : '',\n        )}\n        style={{\n          transform: `translate3d(${node.x}px, ${node.y}px, 0)`,\n          width: w,\n          height: h,\n          transition:\n            isDragging || isResizing\n              ? 'none'\n              : 'transform 0.15s cubic-bezier(0.2, 0, 0, 1), width 0.15s, height 0.15s',\n        }}\n        onPointerDown={handlePointerDown}\n        onMouseEnter={() => setIsHovered(true)}\n        onMouseLeave={() => setIsHovered(false)}\n        data-node-id={node.id}\n      >\n        <svg\n          className=\"absolute inset-0 w-full h-full overflow-visible pointer-events-none\"\n          viewBox={`0 0 ${w} ${h}`}\n        >\n          {node.type === 'Square' && (\n            <rect\n              x=\"0\"\n              y=\"0\"\n              width={w}\n              height={h}\n              rx={8}\n              fill={node.style?.fill || 'transparent'}\n              fillOpacity={node.style?.opacity ?? 1}\n              stroke={node.style?.stroke || '#1e293b'}\n              strokeWidth={node.style?.strokeWidth ?? 2}\n              strokeDasharray={\n                node.style?.strokeDasharray === 'none'\n                  ? undefined\n                  : node.style?.strokeDasharray\n              }\n              className={cn(\n                'pointer-events-auto',\n                selected && 'stroke-purple-400 drop-shadow-md',\n              )}\n              style={{ transition: isResizing ? 'none' : 'all 0.15s' }}\n            />\n          )}\n          {node.type === 'Circle' && (\n            <ellipse\n              cx={w / 2}\n              cy={h / 2}\n              rx={w / 2}\n              ry={h / 2}\n              fill={node.style?.fill || 'transparent'}\n              fillOpacity={node.style?.opacity ?? 1}\n              stroke={node.style?.stroke || '#1e293b'}\n              strokeWidth={node.style?.strokeWidth ?? 2}\n              strokeDasharray={\n                node.style?.strokeDasharray === 'none'\n                  ? undefined\n                  : node.style?.strokeDasharray\n              }\n              className={cn(\n                'pointer-events-auto',\n                selected && 'stroke-purple-400 drop-shadow-md',\n              )}\n              style={{ transition: isResizing ? 'none' : 'all 0.15s' }}\n            />\n          )}\n          {node.type === 'Diamond' && (\n            <polygon\n              points={`${w / 2},0 ${w},${h / 2} ${w / 2},${h} 0,${h / 2}`}\n              fill={node.style?.fill || 'transparent'}\n              fillOpacity={node.style?.opacity ?? 1}\n              stroke={node.style?.stroke || '#1e293b'}\n              strokeWidth={node.style?.strokeWidth ?? 2}\n              strokeDasharray={\n                node.style?.strokeDasharray === 'none'\n                  ? undefined\n                  : node.style?.strokeDasharray\n              }\n              strokeLinejoin=\"round\"\n              className={cn(\n                'pointer-events-auto',\n                selected && 'stroke-purple-400 drop-shadow-md',\n              )}\n              style={{ transition: isResizing ? 'none' : 'all 0.15s' }}\n            />\n          )}\n        </svg>\n\n        <div\n          className={cn(\n            'absolute -top-6 -right-6 flex items-center gap-1.5 z-20 transition-opacity',\n            selected || isHovered\n              ? 'opacity-100'\n              : 'opacity-0 pointer-events-none',\n          )}\n        >\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <button\n                onClick={(e) => {\n                  e.stopPropagation()\n                  onDelete()\n                }}\n                className=\"interactive-icon w-7 h-7 bg-white border border-slate-100 rounded-full flex items-center justify-center text-red-400 hover:text-red-600 shadow-sm transition-transform hover:scale-110\"\n              >\n                <Trash2 size={13} strokeWidth={2.5} />\n              </button>\n            </TooltipTrigger>\n            <TooltipContent>Excluir</TooltipContent>\n          </Tooltip>\n        </div>\n\n        {!isPanMode && isSelectMode && (\n          <div\n            className=\"absolute -right-3 top-1/2 -translate-y-1/2 w-6 h-6 flex items-center justify-center cursor-crosshair z-20 group/port interactive-icon opacity-0 group-hover:opacity-100 transition-opacity\"\n            onPointerDown={(e) => {\n              e.stopPropagation()\n              onEdgeDragStart(node.id, e)\n            }}\n          >\n            <div className=\"w-3 h-3 rounded-full bg-white border-2 border-slate-200 group-hover/port:border-purple-500 group-hover/port:scale-125 transition-all shadow-sm\" />\n          </div>\n        )}\n\n        {selected && !isPanMode && isSelectMode && (\n          <>\n            <div className=\"absolute top-0 left-0 w-full h-full border border-purple-500/50 pointer-events-none\" />\n            <div\n              className=\"resize-handle nw-resize absolute -top-1.5 -left-1.5 w-3 h-3 bg-white border border-purple-500 rounded-sm cursor-nwse-resize z-30\"\n              onPointerDown={(e) => handleResizeStart(e, 'nw')}\n            />\n            <div\n              className=\"resize-handle ne-resize absolute -top-1.5 -right-1.5 w-3 h-3 bg-white border border-purple-500 rounded-sm cursor-nesw-resize z-30\"\n              onPointerDown={(e) => handleResizeStart(e, 'ne')}\n            />\n            <div\n              className=\"resize-handle sw-resize absolute -bottom-1.5 -left-1.5 w-3 h-3 bg-white border border-purple-500 rounded-sm cursor-nesw-resize z-30\"\n              onPointerDown={(e) => handleResizeStart(e, 'sw')}\n            />\n            <div\n              className=\"resize-handle se-resize absolute -bottom-1.5 -right-1.5 w-3 h-3 bg-white border border-purple-500 rounded-sm cursor-nwse-resize z-30\"\n              onPointerDown={(e) => handleResizeStart(e, 'se')}\n            />\n\n            <div\n              className=\"resize-handle n-resize absolute -top-1.5 left-1/2 -translate-x-1/2 w-3 h-3 bg-white border border-purple-500 rounded-sm cursor-ns-resize z-30\"\n              onPointerDown={(e) => handleResizeStart(e, 'n')}\n            />\n            <div\n              className=\"resize-handle s-resize absolute -bottom-1.5 left-1/2 -translate-x-1/2 w-3 h-3 bg-white border border-purple-500 rounded-sm cursor-ns-resize z-30\"\n              onPointerDown={(e) => handleResizeStart(e, 's')}\n            />\n            <div\n              className=\"resize-handle e-resize absolute top-1/2 -right-1.5 -translate-y-1/2 w-3 h-3 bg-white border border-purple-500 rounded-sm cursor-ew-resize z-30\"\n              onPointerDown={(e) => handleResizeStart(e, 'e')}\n            />\n            <div\n              className=\"resize-handle w-resize absolute top-1/2 -left-1.5 -translate-y-1/2 w-3 h-3 bg-white border border-purple-500 rounded-sm cursor-ew-resize z-30\"\n              onPointerDown={(e) => handleResizeStart(e, 'w')}\n            />\n          </>\n        )}\n      </div>\n    )\n  }\n\n  if (node.type === 'Text') {\n    return (\n      <div\n        className={cn(\n          'absolute top-0 left-0 pointer-events-auto min-w-[150px] max-w-[400px] p-4 bg-yellow-50/90 backdrop-blur-sm rounded-xl shadow-sm border border-yellow-200 text-slate-800 z-10 group',\n          selected && 'ring-2 ring-purple-500/60 shadow-md',\n          isDragging\n            ? 'opacity-95 scale-[1.02] z-50 cursor-grabbing shadow-[0_25px_50px_-12px_rgba(0,0,0,0.25)] ring-2 ring-purple-500/50'\n            : isPanMode\n              ? 'cursor-grab'\n              : isSelectMode\n                ? isEditingText\n                  ? 'cursor-text'\n                  : 'cursor-pointer'\n                : '',\n        )}\n        style={{\n          transform: `translate3d(${node.x}px, ${node.y}px, 0)`,\n          transition: isDragging\n            ? 'none'\n            : 'transform 0.15s cubic-bezier(0.2, 0, 0, 1)',\n        }}\n        onPointerDown={(e) => {\n          if (isEditingText) {\n            e.stopPropagation()\n            return\n          }\n          handlePointerDown(e)\n        }}\n        onDoubleClick={(e) => {\n          if (!isPanMode && isSelectMode) {\n            e.stopPropagation()\n            setIsEditingText(true)\n            setTimeout(() => {\n              textRef.current?.focus()\n            }, 0)\n          }\n        }}\n        onMouseEnter={() => setIsHovered(true)}\n        onMouseLeave={() => setIsHovered(false)}\n        data-node-id={node.id}\n      >\n        <div\n          ref={textRef}\n          className=\"font-medium text-[15px] whitespace-pre-wrap outline-none cursor-text\"\n          contentEditable={isEditingText}\n          suppressContentEditableWarning\n          onPointerDown={(e) => {\n            if (isEditingText) e.stopPropagation()\n          }}\n          onBlur={(e) => {\n            setIsEditingText(false)\n            onTextChange(e.currentTarget.textContent || 'Text')\n          }}\n        >\n          {node.data.name}\n        </div>\n\n        {!isPanMode && isSelectMode && (\n          <div\n            className=\"absolute -right-3 top-1/2 -translate-y-1/2 w-6 h-6 flex items-center justify-center cursor-crosshair z-20 group/port interactive-icon opacity-0 group-hover:opacity-100 transition-opacity\"\n            onPointerDown={(e) => {\n              e.stopPropagation()\n              onEdgeDragStart(node.id, e)\n            }}\n          >\n            <div className=\"w-3 h-3 rounded-full bg-white border-2 border-slate-200 group-hover/port:border-purple-500 group-hover/port:scale-125 transition-all shadow-sm\" />\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  if (node.type === 'Image') {\n    return (\n      <div\n        className={cn(\n          'absolute top-0 left-0 pointer-events-auto w-[300px] rounded-2xl shadow-sm border border-slate-200 bg-white z-10 overflow-hidden group',\n          selected &&\n            'ring-4 ring-purple-500/40 border-purple-500/50 shadow-md',\n          isDragging\n            ? 'opacity-95 scale-[1.02] z-50 cursor-grabbing shadow-[0_25px_50px_-12px_rgba(0,0,0,0.25)] ring-4 ring-purple-500/50'\n            : isPanMode\n              ? 'cursor-grab'\n              : isSelectMode\n                ? 'cursor-pointer'\n                : '',\n        )}\n        style={{\n          transform: `translate3d(${node.x}px, ${node.y}px, 0)`,\n          transition: isDragging\n            ? 'none'\n            : 'transform 0.15s cubic-bezier(0.2, 0, 0, 1)',\n        }}\n        onPointerDown={handlePointerDown}\n        onDoubleClick={(e) => {\n          if (!isPanMode && isSelectMode) {\n            e.stopPropagation()\n            onOpenRightPanel('assets')\n          }\n        }}\n        onMouseEnter={() => setIsHovered(true)}\n        onMouseLeave={() => setIsHovered(false)}\n        data-node-id={node.id}\n      >\n        <img\n          src={node.data.name}\n          alt=\"Canvas\"\n          className=\"w-full h-auto object-cover pointer-events-none select-none\"\n        />\n\n        {!isPanMode && isSelectMode && (\n          <div\n            className=\"absolute -right-3 top-1/2 -translate-y-1/2 w-6 h-6 flex items-center justify-center cursor-crosshair z-20 group/port interactive-icon opacity-0 group-hover:opacity-100 transition-opacity\"\n            onPointerDown={(e) => {\n              e.stopPropagation()\n              onEdgeDragStart(node.id, e)\n            }}\n          >\n            <div className=\"w-3 h-3 rounded-full bg-white border-2 border-slate-200 group-hover/port:border-purple-500 group-hover/port:scale-125 transition-all shadow-sm\" />\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  const Icon = icons[node.type] || icons.Default\n  const circumference = 2 * Math.PI * 6\n  const progressPercent =\n    taskProgress.total > 0 ? taskProgress.completed / taskProgress.total : 0\n  const strokeDashoffset = circumference - progressPercent * circumference\n  const showTaskIcon = taskProgress.total > 0 || node.data.isTaskMode\n\n  return (\n    <div\n      className={cn(\n        'absolute top-0 left-0 pointer-events-auto w-[260px] rounded-[1.25rem] shadow-[0_4px_20px_rgba(0,0,0,0.03)] border p-5 z-10 flex flex-col gap-2 group select-none',\n        isHovered &&\n          !selected &&\n          'shadow-[0_8px_30px_rgba(0,0,0,0.06)] ring-4 ring-slate-50',\n        selected &&\n          'shadow-[0_8px_30px_rgba(0,0,0,0.12)] ring-2 ring-purple-500/40 border-purple-500/50',\n        isDragging &&\n          'opacity-95 scale-[1.03] z-50 shadow-[0_25px_50px_-12px_rgba(0,0,0,0.25)] ring-2 ring-purple-500/50 border-purple-500/50',\n        node.data.isTaskMode && node.data.isCompleted\n          ? 'bg-[#ecfdf5] border-[#bbf7d0]'\n          : (node.style?.fill && node.style.fill !== 'transparent') ||\n              (node.style?.opacity ?? 1) < 1\n            ? 'border-slate-100'\n            : 'bg-white border-slate-100',\n      )}\n      style={{\n        transform: `translate3d(${node.x}px, ${node.y}px, 0)`,\n        transition: isDragging\n          ? 'none'\n          : 'transform 0.15s cubic-bezier(0.2, 0, 0, 1), box-shadow 0.2s, background-color 0.3s',\n        cursor: isPanMode\n          ? 'grab'\n          : isDragging\n            ? 'grabbing'\n            : isSelectMode\n              ? 'pointer'\n              : '',\n        backgroundColor: getBackgroundColor(),\n      }}\n      onPointerDown={handlePointerDown}\n      onDoubleClick={(e) => {\n        if (!isPanMode && isSelectMode) {\n          e.stopPropagation()\n          onOpenRightPanel('details')\n        }\n      }}\n      onMouseEnter={() => setIsHovered(true)}\n      onMouseLeave={() => setIsHovered(false)}\n      onDragOver={(e) => {\n        e.preventDefault()\n        e.stopPropagation()\n      }}\n      onDrop={handleDrop}\n      data-node-id={node.id}\n    >\n      <div className=\"absolute -top-3.5 left-4 flex items-center gap-1.5 z-20\">\n        {(node.data.linkedDocumentIds?.length ?? 0) > 0 && (\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <div\n                className=\"interactive-icon w-7 h-7 rounded-full bg-white border border-slate-100 text-blue-500 flex items-center justify-center shadow-sm cursor-pointer hover:scale-110 transition-transform\"\n                onClick={(e) => {\n                  e.stopPropagation()\n                  onOpenRightPanel('content')\n                }}\n              >\n                <FileText size={13} strokeWidth={2.5} />\n              </div>\n            </TooltipTrigger>\n            <TooltipContent>Ver Documentos</TooltipContent>\n          </Tooltip>\n        )}\n        {(node.data.linkedAssetIds?.length ?? 0) > 0 && (\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <div\n                className=\"interactive-icon w-7 h-7 rounded-full bg-white border border-slate-100 text-purple-500 flex items-center justify-center shadow-sm cursor-pointer hover:scale-110 transition-transform\"\n                onClick={(e) => {\n                  e.stopPropagation()\n                  onOpenRightPanel('assets')\n                }}\n              >\n                <ImageIcon size={13} strokeWidth={2.5} />\n              </div>\n            </TooltipTrigger>\n            <TooltipContent>Ver Assets</TooltipContent>\n          </Tooltip>\n        )}\n      </div>\n\n      <div className=\"absolute -top-3.5 right-4 flex items-center gap-1.5 z-20\">\n        <div\n          className={cn(\n            'flex items-center gap-1.5 transition-opacity',\n            selected || isHovered\n              ? 'opacity-100'\n              : 'opacity-0 pointer-events-none',\n          )}\n        >\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <button\n                onClick={(e) => {\n                  e.stopPropagation()\n                  onOpenSettings()\n                }}\n                className=\"interactive-icon w-7 h-7 bg-white border border-slate-100 rounded-full flex items-center justify-center text-slate-400 hover:text-slate-700 shadow-sm transition-transform hover:scale-110\"\n              >\n                <Settings size={13} strokeWidth={2.5} />\n              </button>\n            </TooltipTrigger>\n            <TooltipContent>Configurações</TooltipContent>\n          </Tooltip>\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <button\n                onClick={(e) => {\n                  e.stopPropagation()\n                  onDelete()\n                }}\n                className=\"interactive-icon w-7 h-7 bg-white border border-slate-100 rounded-full flex items-center justify-center text-red-400 hover:text-red-600 shadow-sm transition-transform hover:scale-110\"\n              >\n                <Trash2 size={13} strokeWidth={2.5} />\n              </button>\n            </TooltipTrigger>\n            <TooltipContent>Excluir</TooltipContent>\n          </Tooltip>\n        </div>\n\n        {showTaskIcon && (\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <div\n                className=\"interactive-icon w-7 h-7 rounded-full bg-white shadow-sm flex items-center justify-center border border-slate-100 cursor-pointer hover:scale-110 transition-transform\"\n                onClick={(e) => {\n                  e.stopPropagation()\n                  onOpenRightPanel('tasks')\n                }}\n              >\n                {taskProgress.total > 0 ? (\n                  <svg width=\"16\" height=\"16\" className=\"transform -rotate-90\">\n                    <circle\n                      cx=\"8\"\n                      cy=\"8\"\n                      r=\"6\"\n                      stroke=\"currentColor\"\n                      strokeWidth=\"2.5\"\n                      fill=\"transparent\"\n                      className=\"text-slate-100\"\n                    />\n                    <circle\n                      cx=\"8\"\n                      cy=\"8\"\n                      r=\"6\"\n                      stroke=\"currentColor\"\n                      strokeWidth=\"2.5\"\n                      fill=\"transparent\"\n                      strokeDasharray={circumference}\n                      strokeDashoffset={strokeDashoffset}\n                      className=\"text-blue-500 transition-all duration-500\"\n                    />\n                  </svg>\n                ) : (\n                  <CheckSquare\n                    size={13}\n                    className=\"text-slate-400\"\n                    strokeWidth={2.5}\n                  />\n                )}\n              </div>\n            </TooltipTrigger>\n            <TooltipContent>Tarefas</TooltipContent>\n          </Tooltip>\n        )}\n      </div>\n\n      <div className=\"flex items-center gap-2 text-slate-500 mb-0.5 mt-0.5\">\n        <Icon size={15} strokeWidth={2} className=\"text-slate-400\" />\n        <span className=\"text-[13px] font-semibold tracking-wide text-slate-600\">\n          {node.type}\n        </span>\n      </div>\n\n      <div className=\"flex flex-col\">\n        <div className=\"flex items-start gap-2.5\">\n          {node.data.isTaskMode && (\n            <div\n              className=\"mt-0.5\"\n              onPointerDown={(e) => e.stopPropagation()}\n              onClick={(e) => {\n                e.stopPropagation()\n                onToggleComplete()\n              }}\n            >\n              <Checkbox\n                checked={node.data.isCompleted}\n                className={cn(\n                  'rounded-[4px] border-slate-300 w-4 h-4 shadow-none',\n                  node.data.isCompleted &&\n                    'data-[state=checked]:bg-green-500 data-[state=checked]:border-green-500',\n                )}\n              />\n            </div>\n          )}\n          <div className=\"flex flex-col min-w-0 flex-1\">\n            <h4\n              className={cn(\n                'font-bold text-slate-800 text-[15px] truncate leading-tight',\n                node.data.isTaskMode &&\n                  node.data.isCompleted &&\n                  'text-slate-600 line-through decoration-slate-300',\n              )}\n            >\n              {node.data.name}\n            </h4>\n            <span className=\"text-[13px] text-slate-400 mt-1 truncate font-medium\">\n              {node.data.subtitle || '+1 filter'}\n            </span>\n          </div>\n        </div>\n      </div>\n\n      {node.data.isTaskMode && (\n        <div className=\"mt-2 flex flex-col gap-1.5\">\n          {linkedTasks.length > 0 && (\n            <div className=\"h-px bg-slate-100 w-full my-1 rounded-full\" />\n          )}\n\n          {linkedTasks.map((task) => (\n            <div\n              key={task.id}\n              className=\"flex items-start gap-2 group/task relative pr-4\"\n            >\n              <Checkbox\n                checked={task.status === 'Concluído'}\n                onCheckedChange={() => handleToggleTask(task)}\n                className=\"mt-0.5 w-3.5 h-3.5 rounded-[4px] border-slate-300 data-[state=checked]:bg-blue-500 data-[state=checked]:border-blue-500\"\n              />\n              <span\n                className={cn(\n                  'text-[12px] leading-tight font-medium flex-1 transition-all break-words',\n                  task.status === 'Concluído'\n                    ? 'text-slate-400 line-through'\n                    : 'text-slate-600 group-hover/task:text-slate-800',\n                )}\n              >\n                {task.title}\n              </span>\n              <button\n                className=\"absolute right-0 top-0 opacity-0 group-hover/task:opacity-100 text-slate-300 hover:text-red-500 transition-opacity\"\n                onClick={(e) => {\n                  e.stopPropagation()\n                  handleDeleteTask(task.id)\n                }}\n              >\n                <X size={14} />\n              </button>\n            </div>\n          ))}\n\n          {isAddingTask ? (\n            <div className=\"flex items-center gap-1.5 mt-1\">\n              <input\n                autoFocus\n                type=\"text\"\n                value={newTaskTitle}\n                onChange={(e) => setNewTaskTitle(e.target.value)}\n                onKeyDown={(e) => {\n                  if (e.key === 'Enter') {\n                    e.preventDefault()\n                    handleAddTask()\n                  }\n                  if (e.key === 'Escape') {\n                    setIsAddingTask(false)\n                    setNewTaskTitle('')\n                  }\n                }}\n                onBlur={() => {\n                  if (newTaskTitle.trim()) {\n                    handleAddTask()\n                  } else {\n                    setIsAddingTask(false)\n                  }\n                }}\n                placeholder=\"Nome da tarefa...\"\n                className=\"flex-1 text-[12px] bg-slate-50 border border-slate-200 rounded px-2 py-1 outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-400/20 transition-all text-slate-700 w-full\"\n              />\n            </div>\n          ) : (\n            <button\n              onClick={(e) => {\n                e.stopPropagation()\n                setIsAddingTask(true)\n              }}\n              className=\"flex items-center gap-1.5 mt-1 text-[12px] font-medium text-slate-400 hover:text-blue-500 transition-colors w-full text-left py-0.5 rounded-sm interactive-icon\"\n            >\n              <Plus size={12} strokeWidth={2.5} />\n              Adicionar tarefa\n            </button>\n          )}\n        </div>\n      )}\n\n      {!isPanMode && isSelectMode && (\n        <div\n          className=\"absolute -right-3 top-1/2 -translate-y-1/2 w-6 h-6 flex items-center justify-center cursor-crosshair z-20 group/port interactive-icon opacity-0 group-hover:opacity-100 transition-opacity\"\n          onPointerDown={(e) => {\n            e.stopPropagation()\n            onEdgeDragStart(node.id, e)\n          }}\n        >\n          <div className=\"w-3 h-3 rounded-full bg-white border-2 border-slate-200 group-hover/port:border-purple-500 group-hover/port:scale-125 transition-all shadow-sm\" />\n        </div>\n      )}\n\n      <div className=\"absolute -bottom-4 left-1/2 -translate-x-1/2 z-20\">\n        <button\n          onClick={(e) => {\n            e.stopPropagation()\n            onAddChild()\n          }}\n          className=\"interactive-icon h-8 px-4 bg-white border border-slate-100 rounded-full shadow-sm flex items-center justify-center gap-1.5 text-slate-500 hover:text-slate-800 hover:border-slate-200 transition-all font-medium text-[12px]\"\n        >\n          <ExternalLink size={12} strokeWidth={2} /> Exit\n        </button>\n      </div>\n    </div>\n  )\n}\n","import { Node, Funnel, Task, Resource } from '@/types'\nimport { generateId } from '@/lib/generateId'\nimport { useState, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Textarea } from '@/components/ui/textarea'\nimport {\n  X,\n  FileText,\n  CheckSquare,\n  Image as ImageIcon,\n  Plus,\n} from 'lucide-react'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport useDocumentStore from '@/stores/useDocumentStore'\nimport useTaskStore from '@/stores/useTaskStore'\nimport useResourceStore from '@/stores/useResourceStore'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { Dialog, DialogContent, DialogTitle } from '@/components/ui/dialog'\n\nexport default function RightPanel({\n  node,\n  funnel,\n  defaultTab = 'details',\n  onChange,\n  onClose,\n}: {\n  node: Node\n  funnel: Funnel\n  defaultTab?: string\n  onChange: (n: Node) => void\n  onClose: () => void\n}) {\n  const [docs, setDocs] = useDocumentStore()\n  const [tasks, setTasks] = useTaskStore()\n  const [resources, setResources] = useResourceStore()\n  const [activeTab, setActiveTab] = useState(defaultTab)\n  const [inspectResource, setInspectResource] = useState<Resource | null>(null)\n\n  useEffect(() => {\n    setActiveTab(defaultTab)\n  }, [defaultTab, node.id])\n\n  const linkedDocs = docs.filter((d) =>\n    node.data.linkedDocumentIds?.includes(d.id),\n  )\n  const linkedTasks = tasks.filter(\n    (t) => t.nodeId === node.id || node.data.linkedTaskIds?.includes(t.id),\n  )\n  const linkedResources = resources.filter((a) =>\n    node.data.linkedAssetIds?.includes(a.id),\n  )\n\n  const projDocs = docs.filter(\n    (d) =>\n      d.projectId === funnel.projectId &&\n      !node.data.linkedDocumentIds?.includes(d.id),\n  )\n  const projTasks = tasks.filter(\n    (t) =>\n      t.projectId === funnel.projectId &&\n      t.nodeId !== node.id &&\n      !node.data.linkedTaskIds?.includes(t.id),\n  )\n  const projResources = resources.filter(\n    (a) =>\n      a.projectId === funnel.projectId &&\n      !node.data.linkedAssetIds?.includes(a.id),\n  )\n\n  const linkResource = (type: 'doc' | 'task' | 'asset', id: string) => {\n    const key =\n      type === 'doc'\n        ? 'linkedDocumentIds'\n        : type === 'task'\n          ? 'linkedTaskIds'\n          : 'linkedAssetIds'\n    onChange({\n      ...node,\n      data: {\n        ...node.data,\n        [key]: [\n          ...((node.data[key as keyof typeof node.data] as string[]) || []),\n          id,\n        ],\n      },\n    })\n    if (type === 'doc')\n      setDocs(\n        docs.map((d) =>\n          d.id === id ? { ...d, funnelId: funnel.id, nodeId: node.id } : d,\n        ),\n      )\n    if (type === 'task')\n      setTasks(\n        tasks.map((t) =>\n          t.id === id ? { ...t, funnelId: funnel.id, nodeId: node.id } : t,\n        ),\n      )\n  }\n\n  const handleCreateTask = () => {\n    const newTask: Task = {\n      id: generateId('t'),\n      title: 'Nova Tarefa do Nó',\n      projectId: funnel.projectId,\n      funnelId: funnel.id,\n      nodeId: node.id,\n      priority: 'Média',\n      status: 'A Fazer',\n      deadline: new Date(Date.now() + 86400000).toISOString(),\n    }\n    setTasks([...tasks, newTask])\n    onChange({\n      ...node,\n      data: {\n        ...node.data,\n        linkedTaskIds: [...(node.data.linkedTaskIds || []), newTask.id],\n      },\n    })\n  }\n\n  return (\n    <div className=\"w-[500px] bg-white border-l border-slate-100 h-full flex flex-col shadow-[-10px_0_40px_rgba(0,0,0,0.05)] z-30 shrink-0 absolute right-0 top-0 bottom-0 rounded-l-[2rem]\">\n      <div className=\"px-8 py-5 flex items-center justify-between border-b border-slate-50 shrink-0\">\n        <input\n          className=\"bg-transparent text-[22px] font-bold tracking-tight text-slate-800 outline-none border-none px-0 focus:ring-0 truncate max-w-[300px]\"\n          value={node.data.name}\n          onChange={(e) =>\n            onChange({ ...node, data: { ...node.data, name: e.target.value } })\n          }\n          placeholder=\"Node Title\"\n        />\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={onClose}\n          className=\"text-slate-400 hover:bg-slate-100\"\n        >\n          <X size={18} />\n        </Button>\n      </div>\n\n      <Tabs\n        value={activeTab}\n        onValueChange={setActiveTab}\n        className=\"flex-1 flex flex-col min-h-0 overflow-hidden\"\n      >\n        <TabsList className=\"mx-8 mt-4 grid grid-cols-4 bg-slate-50/50 p-1 rounded-xl\">\n          <TabsTrigger value=\"details\" className=\"text-xs rounded-lg\">\n            Detalhes\n          </TabsTrigger>\n          <TabsTrigger value=\"content\" className=\"text-xs rounded-lg\">\n            Conteúdo\n          </TabsTrigger>\n          <TabsTrigger value=\"tasks\" className=\"text-xs rounded-lg\">\n            Tarefas\n          </TabsTrigger>\n          <TabsTrigger value=\"resources\" className=\"text-xs rounded-lg\">\n            Recursos\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent\n          value=\"details\"\n          className=\"flex-1 overflow-auto p-8 space-y-6 m-0 border-none outline-none no-scrollbar\"\n        >\n          <div className=\"bg-slate-50 rounded-2xl p-4 border border-slate-100\">\n            <label className=\"text-[11px] font-bold text-slate-400 uppercase tracking-widest block mb-2\">\n              Subtítulo / Lógica\n            </label>\n            <input\n              className=\"w-full bg-transparent text-sm font-medium text-slate-700 outline-none placeholder:text-slate-400\"\n              value={node.data.subtitle || ''}\n              onChange={(e) =>\n                onChange({\n                  ...node,\n                  data: { ...node.data, subtitle: e.target.value },\n                })\n              }\n              placeholder=\"+1 filter\"\n            />\n          </div>\n          <div className=\"space-y-3\">\n            <label className=\"text-[11px] font-bold text-slate-400 uppercase tracking-widest block\">\n              Notas\n            </label>\n            <Textarea\n              value={node.data.notes || ''}\n              onChange={(e) =>\n                onChange({\n                  ...node,\n                  data: { ...node.data, notes: e.target.value },\n                })\n              }\n              placeholder=\"Adicione contexto ou notas lógicas aqui...\"\n              className=\"min-h-[240px] bg-slate-50/50 rounded-2xl p-4 resize-none text-sm\"\n            />\n          </div>\n        </TabsContent>\n\n        <TabsContent\n          value=\"content\"\n          className=\"flex-1 overflow-auto p-8 space-y-6 m-0 border-none outline-none no-scrollbar\"\n        >\n          <div className=\"flex items-center gap-2\">\n            <Select onValueChange={(val) => linkResource('doc', val)}>\n              <SelectTrigger className=\"flex-1 bg-white\">\n                <SelectValue placeholder=\"Vincular Documento...\" />\n              </SelectTrigger>\n              <SelectContent>\n                {projDocs.map((d) => (\n                  <SelectItem key={d.id} value={d.id}>\n                    <div className=\"flex items-center gap-2\">\n                      <FileText size={14} />\n                      {d.title}\n                    </div>\n                  </SelectItem>\n                ))}\n                {projDocs.length === 0 && (\n                  <div className=\"p-2 text-sm text-muted-foreground text-center\">\n                    Nenhum documento\n                  </div>\n                )}\n              </SelectContent>\n            </Select>\n          </div>\n          {linkedDocs.map((doc) => (\n            <div\n              key={doc.id}\n              className=\"space-y-3 border rounded-xl p-4 bg-white shadow-sm\"\n            >\n              <div className=\"font-semibold text-slate-800 flex items-center gap-2 border-b pb-2\">\n                <FileText size={16} className=\"text-blue-500\" /> {doc.title}\n              </div>\n              <div\n                contentEditable\n                className=\"min-h-[150px] outline-none text-sm text-slate-600 prose prose-sm max-w-none\"\n                dangerouslySetInnerHTML={{ __html: doc.content }}\n                onBlur={(e) =>\n                  setDocs(\n                    docs.map((d) =>\n                      d.id === doc.id\n                        ? { ...d, content: e.currentTarget.innerHTML }\n                        : d,\n                    ),\n                  )\n                }\n              />\n            </div>\n          ))}\n          {linkedDocs.length === 0 && (\n            <div className=\"text-center text-sm text-slate-400 py-8\">\n              Nenhum documento vinculado.\n            </div>\n          )}\n        </TabsContent>\n\n        <TabsContent\n          value=\"tasks\"\n          className=\"flex-1 overflow-auto p-8 space-y-6 m-0 border-none outline-none no-scrollbar\"\n        >\n          <div className=\"flex items-center gap-2\">\n            <Select onValueChange={(val) => linkResource('task', val)}>\n              <SelectTrigger className=\"flex-1 bg-white\">\n                <SelectValue placeholder=\"Importar Tarefa...\" />\n              </SelectTrigger>\n              <SelectContent>\n                {projTasks.map((t) => (\n                  <SelectItem key={t.id} value={t.id}>\n                    <div className=\"flex items-center gap-2\">\n                      <CheckSquare size={14} />\n                      {t.title}\n                    </div>\n                  </SelectItem>\n                ))}\n                {projTasks.length === 0 && (\n                  <div className=\"p-2 text-sm text-muted-foreground text-center\">\n                    Nenhuma tarefa disponível\n                  </div>\n                )}\n              </SelectContent>\n            </Select>\n            <Button variant=\"outline\" size=\"icon\" onClick={handleCreateTask}>\n              <Plus size={16} />\n            </Button>\n          </div>\n          <div className=\"space-y-3\">\n            {linkedTasks.map((t) => (\n              <div\n                key={t.id}\n                className=\"p-4 border rounded-xl bg-white shadow-sm flex flex-col gap-2\"\n              >\n                <div className=\"flex justify-between items-start\">\n                  <span className=\"font-semibold text-sm\">{t.title}</span>\n                  <Badge variant=\"outline\">{t.status}</Badge>\n                </div>\n                <div className=\"text-xs text-slate-500\">\n                  Prioridade: {t.priority}\n                </div>\n              </div>\n            ))}\n            {linkedTasks.length === 0 && (\n              <div className=\"text-center text-sm text-slate-400 py-8\">\n                Nenhuma tarefa vinculada.\n              </div>\n            )}\n          </div>\n        </TabsContent>\n\n        <TabsContent\n          value=\"resources\"\n          className=\"flex-1 overflow-auto p-8 space-y-6 m-0 border-none outline-none no-scrollbar\"\n        >\n          <div className=\"flex items-center gap-2\">\n            <Select onValueChange={(val) => linkResource('asset', val)}>\n              <SelectTrigger className=\"flex-1 bg-white\">\n                <SelectValue placeholder=\"Vincular Recurso...\" />\n              </SelectTrigger>\n              <SelectContent>\n                {projResources.map((a) => (\n                  <SelectItem key={a.id} value={a.id}>\n                    <div className=\"flex items-center gap-2\">\n                      <ImageIcon size={14} />\n                      {a.title}\n                    </div>\n                  </SelectItem>\n                ))}\n                {projResources.length === 0 && (\n                  <div className=\"p-2 text-sm text-muted-foreground text-center\">\n                    Nenhum recurso disponível\n                  </div>\n                )}\n              </SelectContent>\n            </Select>\n          </div>\n          <div className=\"grid grid-cols-2 gap-4\">\n            {linkedResources.map((a) => (\n              <div\n                key={a.id}\n                className=\"rounded-xl overflow-hidden border bg-white shadow-sm group relative cursor-pointer\"\n                onClick={() => a.type === 'image' && setInspectResource(a)}\n              >\n                {a.type === 'image' ? (\n                  <img\n                    src={a.content}\n                    alt={a.title}\n                    className=\"w-full aspect-video object-cover\"\n                  />\n                ) : (\n                  <div className=\"p-3 text-sm text-muted-foreground line-clamp-3 aspect-video flex items-center\">\n                    {a.content}\n                  </div>\n                )}\n                <div className=\"p-2 text-xs font-medium truncate border-t\">\n                  {a.title}\n                </div>\n              </div>\n            ))}\n          </div>\n          {linkedResources.length === 0 && (\n            <div className=\"text-center text-sm text-slate-400 py-8\">\n              Nenhum recurso vinculado.\n            </div>\n          )}\n        </TabsContent>\n      </Tabs>\n\n      <Dialog\n        open={!!inspectResource}\n        onOpenChange={(open) => !open && setInspectResource(null)}\n      >\n        <DialogContent className=\"max-w-7xl w-full h-[90vh] p-0 bg-black/95 border-none shadow-2xl flex flex-col overflow-hidden rounded-none sm:rounded-none\">\n          <DialogTitle className=\"sr-only\">Inspeção de Recurso</DialogTitle>\n          <div className=\"absolute top-6 left-6 text-white font-bold text-xl z-10 drop-shadow-md\">\n            {inspectResource?.title}\n          </div>\n          <div className=\"flex-1 flex items-center justify-center p-8 overflow-auto\">\n            <img\n              src={inspectResource?.content}\n              alt={inspectResource?.title}\n              className=\"max-w-full max-h-full object-contain\"\n            />\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  )\n}\n","\"use client\";\n\n// src/switch.tsx\nimport * as React from \"react\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport { createContextScope } from \"@radix-ui/react-context\";\nimport { useControllableState } from \"@radix-ui/react-use-controllable-state\";\nimport { usePrevious } from \"@radix-ui/react-use-previous\";\nimport { useSize } from \"@radix-ui/react-use-size\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { jsx, jsxs } from \"react/jsx-runtime\";\nvar SWITCH_NAME = \"Switch\";\nvar [createSwitchContext, createSwitchScope] = createContextScope(SWITCH_NAME);\nvar [SwitchProvider, useSwitchContext] = createSwitchContext(SWITCH_NAME);\nvar Switch = React.forwardRef(\n  (props, forwardedRef) => {\n    const {\n      __scopeSwitch,\n      name,\n      checked: checkedProp,\n      defaultChecked,\n      required,\n      disabled,\n      value = \"on\",\n      onCheckedChange,\n      form,\n      ...switchProps\n    } = props;\n    const [button, setButton] = React.useState(null);\n    const composedRefs = useComposedRefs(forwardedRef, (node) => setButton(node));\n    const hasConsumerStoppedPropagationRef = React.useRef(false);\n    const isFormControl = button ? form || !!button.closest(\"form\") : true;\n    const [checked, setChecked] = useControllableState({\n      prop: checkedProp,\n      defaultProp: defaultChecked ?? false,\n      onChange: onCheckedChange,\n      caller: SWITCH_NAME\n    });\n    return /* @__PURE__ */ jsxs(SwitchProvider, { scope: __scopeSwitch, checked, disabled, children: [\n      /* @__PURE__ */ jsx(\n        Primitive.button,\n        {\n          type: \"button\",\n          role: \"switch\",\n          \"aria-checked\": checked,\n          \"aria-required\": required,\n          \"data-state\": getState(checked),\n          \"data-disabled\": disabled ? \"\" : void 0,\n          disabled,\n          value,\n          ...switchProps,\n          ref: composedRefs,\n          onClick: composeEventHandlers(props.onClick, (event) => {\n            setChecked((prevChecked) => !prevChecked);\n            if (isFormControl) {\n              hasConsumerStoppedPropagationRef.current = event.isPropagationStopped();\n              if (!hasConsumerStoppedPropagationRef.current) event.stopPropagation();\n            }\n          })\n        }\n      ),\n      isFormControl && /* @__PURE__ */ jsx(\n        SwitchBubbleInput,\n        {\n          control: button,\n          bubbles: !hasConsumerStoppedPropagationRef.current,\n          name,\n          value,\n          checked,\n          required,\n          disabled,\n          form,\n          style: { transform: \"translateX(-100%)\" }\n        }\n      )\n    ] });\n  }\n);\nSwitch.displayName = SWITCH_NAME;\nvar THUMB_NAME = \"SwitchThumb\";\nvar SwitchThumb = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeSwitch, ...thumbProps } = props;\n    const context = useSwitchContext(THUMB_NAME, __scopeSwitch);\n    return /* @__PURE__ */ jsx(\n      Primitive.span,\n      {\n        \"data-state\": getState(context.checked),\n        \"data-disabled\": context.disabled ? \"\" : void 0,\n        ...thumbProps,\n        ref: forwardedRef\n      }\n    );\n  }\n);\nSwitchThumb.displayName = THUMB_NAME;\nvar BUBBLE_INPUT_NAME = \"SwitchBubbleInput\";\nvar SwitchBubbleInput = React.forwardRef(\n  ({\n    __scopeSwitch,\n    control,\n    checked,\n    bubbles = true,\n    ...props\n  }, forwardedRef) => {\n    const ref = React.useRef(null);\n    const composedRefs = useComposedRefs(ref, forwardedRef);\n    const prevChecked = usePrevious(checked);\n    const controlSize = useSize(control);\n    React.useEffect(() => {\n      const input = ref.current;\n      if (!input) return;\n      const inputProto = window.HTMLInputElement.prototype;\n      const descriptor = Object.getOwnPropertyDescriptor(\n        inputProto,\n        \"checked\"\n      );\n      const setChecked = descriptor.set;\n      if (prevChecked !== checked && setChecked) {\n        const event = new Event(\"click\", { bubbles });\n        setChecked.call(input, checked);\n        input.dispatchEvent(event);\n      }\n    }, [prevChecked, checked, bubbles]);\n    return /* @__PURE__ */ jsx(\n      \"input\",\n      {\n        type: \"checkbox\",\n        \"aria-hidden\": true,\n        defaultChecked: checked,\n        ...props,\n        tabIndex: -1,\n        ref: composedRefs,\n        style: {\n          ...props.style,\n          ...controlSize,\n          position: \"absolute\",\n          pointerEvents: \"none\",\n          opacity: 0,\n          margin: 0\n        }\n      }\n    );\n  }\n);\nSwitchBubbleInput.displayName = BUBBLE_INPUT_NAME;\nfunction getState(checked) {\n  return checked ? \"checked\" : \"unchecked\";\n}\nvar Root = Switch;\nvar Thumb = SwitchThumb;\nexport {\n  Root,\n  Switch,\n  SwitchThumb,\n  Thumb,\n  createSwitchScope\n};\n//# sourceMappingURL=index.mjs.map\n","/* Switch Component primitives - A component that displays a switch (a component that displays a toggle) - from shadcn/ui (exposes Switch) */\nimport * as React from 'react'\nimport * as SwitchPrimitives from '@radix-ui/react-switch'\n\nimport { cn } from '@/lib/utils'\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      'peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input',\n      className,\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        'pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0',\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","import { useState, useEffect } from 'react'\nimport { Node, NodeData } from '@/types'\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n  DialogFooter,\n} from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Switch } from '@/components/ui/switch'\nimport { Label } from '@/components/ui/label'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { X } from 'lucide-react'\nimport useDocumentStore from '@/stores/useDocumentStore'\nimport useResourceStore from '@/stores/useResourceStore'\n\ntype NodeSettingsModalProps = {\n  node: Node | null\n  isOpen: boolean\n  onClose: () => void\n  onSave: (id: string, updates: Partial<NodeData>) => void\n}\n\nexport function NodeSettingsModal({\n  node,\n  isOpen,\n  onClose,\n  onSave,\n}: NodeSettingsModalProps) {\n  const [description, setDescription] = useState('')\n  const [isTaskMode, setIsTaskMode] = useState(false)\n  const [docs] = useDocumentStore()\n  const [resources] = useResourceStore()\n  const [linkedDocs, setLinkedDocs] = useState<string[]>([])\n  const [linkedAssets, setLinkedAssets] = useState<string[]>([])\n\n  useEffect(() => {\n    if (isOpen && node) {\n      setDescription(node.data.description || '')\n      setIsTaskMode(node.data.isTaskMode || false)\n      setLinkedDocs(node.data.linkedDocumentIds || [])\n      setLinkedAssets(node.data.linkedAssetIds || [])\n    }\n  }, [isOpen, node])\n\n  const handleSave = () => {\n    if (node) {\n      onSave(node.id, {\n        description,\n        isTaskMode,\n        linkedDocumentIds: linkedDocs,\n        linkedAssetIds: linkedAssets,\n      })\n    }\n  }\n\n  if (!node) return null\n\n  const availableDocs = docs.filter((d) => !linkedDocs.includes(d.id))\n  const availableAssets = resources.filter((a) => !linkedAssets.includes(a.id))\n\n  return (\n    <Dialog open={isOpen} onOpenChange={(open) => !open && onClose()}>\n      <DialogContent className=\"sm:max-w-[480px] p-8 gap-0\">\n        <DialogHeader className=\"mb-6\">\n          <DialogTitle className=\"text-xl font-bold text-slate-900 tracking-tight\">\n            Advanced Settings\n          </DialogTitle>\n          <DialogDescription className=\"text-sm font-medium text-slate-500 mt-1\">\n            Configure underlying logic for this node.\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"grid gap-6 py-2\">\n          <div className=\"space-y-2.5\">\n            <Label\n              htmlFor=\"description\"\n              className=\"text-sm font-semibold text-slate-700\"\n            >\n              Technical Description\n            </Label>\n            <Textarea\n              id=\"description\"\n              value={description}\n              onChange={(e) => setDescription(e.target.value)}\n              className=\"min-h-[110px] rounded-xl shadow-sm bg-white border-slate-200 focus-visible:ring-[#f95015] focus-visible:border-[#f95015] text-sm\"\n              placeholder=\"Internal notes or technical details...\"\n            />\n          </div>\n\n          <div className=\"space-y-6 pt-2\">\n            <div className=\"space-y-2.5\">\n              <Label className=\"text-sm font-semibold text-slate-700\">\n                Link Documents\n              </Label>\n              <Select\n                onValueChange={(val) => setLinkedDocs([...linkedDocs, val])}\n              >\n                <SelectTrigger className=\"bg-white rounded-xl border-slate-200 shadow-sm text-slate-500 h-11\">\n                  <SelectValue placeholder=\"Search and select a document...\" />\n                </SelectTrigger>\n                <SelectContent className=\"rounded-xl\">\n                  {availableDocs.map((d) => (\n                    <SelectItem key={d.id} value={d.id}>\n                      {d.title}\n                    </SelectItem>\n                  ))}\n                  {availableDocs.length === 0 && (\n                    <div className=\"p-3 text-sm text-muted-foreground text-center\">\n                      No documents available\n                    </div>\n                  )}\n                </SelectContent>\n              </Select>\n              {linkedDocs.length > 0 && (\n                <div className=\"flex flex-wrap gap-2 pt-1\">\n                  {linkedDocs.map((id) => {\n                    const d = docs.find((doc) => doc.id === id)\n                    if (!d) return null\n                    return (\n                      <Badge\n                        key={id}\n                        variant=\"outline\"\n                        className=\"flex items-center gap-1.5 pl-3 pr-2 py-1.5 bg-white border-slate-200 shadow-sm rounded-full text-[13px] font-medium text-slate-600 hover:bg-slate-50 transition-colors\"\n                      >\n                        {d.title}\n                        <button\n                          onClick={() =>\n                            setLinkedDocs(linkedDocs.filter((l) => l !== id))\n                          }\n                          className=\"text-slate-400 hover:text-slate-600 rounded-full transition-colors outline-none\"\n                        >\n                          <X size={14} />\n                        </button>\n                      </Badge>\n                    )\n                  })}\n                </div>\n              )}\n            </div>\n\n            <div className=\"space-y-2.5\">\n              <Label className=\"text-sm font-semibold text-slate-700\">\n                Link Assets\n              </Label>\n              <Select\n                onValueChange={(val) => setLinkedAssets([...linkedAssets, val])}\n              >\n                <SelectTrigger className=\"bg-white rounded-xl border-slate-200 shadow-sm text-slate-500 h-11\">\n                  <SelectValue placeholder=\"Search and select an asset...\" />\n                </SelectTrigger>\n                <SelectContent className=\"rounded-xl\">\n                  {availableAssets.map((a) => (\n                    <SelectItem key={a.id} value={a.id}>\n                      {a.title}\n                    </SelectItem>\n                  ))}\n                  {availableAssets.length === 0 && (\n                    <div className=\"p-3 text-sm text-muted-foreground text-center\">\n                      No assets available\n                    </div>\n                  )}\n                </SelectContent>\n              </Select>\n              {linkedAssets.length > 0 && (\n                <div className=\"flex flex-wrap gap-2 pt-1\">\n                  {linkedAssets.map((id) => {\n                    const a = resources.find((asset) => asset.id === id)\n                    if (!a) return null\n                    return (\n                      <Badge\n                        key={id}\n                        variant=\"outline\"\n                        className=\"flex items-center gap-1.5 pl-3 pr-2 py-1.5 bg-white border-slate-200 shadow-sm rounded-full text-[13px] font-medium text-slate-600 hover:bg-slate-50 transition-colors\"\n                      >\n                        {a.title}\n                        <button\n                          onClick={() =>\n                            setLinkedAssets(\n                              linkedAssets.filter((l) => l !== id),\n                            )\n                          }\n                          className=\"text-slate-400 hover:text-slate-600 rounded-full transition-colors outline-none\"\n                        >\n                          <X size={14} />\n                        </button>\n                      </Badge>\n                    )\n                  })}\n                </div>\n              )}\n            </div>\n          </div>\n\n          <div className=\"flex flex-row items-center justify-between rounded-2xl border border-slate-100 bg-white p-5 shadow-[0_2px_10px_rgba(0,0,0,0.02)] mt-2\">\n            <div className=\"space-y-1\">\n              <Label className=\"text-[15px] font-bold text-slate-800\">\n                Task Mode\n              </Label>\n              <p className=\"text-[13.5px] text-slate-500 font-medium\">\n                Enable checklist functionality on canvas.\n              </p>\n            </div>\n            <Switch\n              checked={isTaskMode}\n              onCheckedChange={setIsTaskMode}\n              className=\"data-[state=checked]:bg-[#f95015] shadow-sm\"\n            />\n          </div>\n        </div>\n\n        <DialogFooter className=\"mt-8 sm:justify-end gap-3\">\n          <Button\n            variant=\"ghost\"\n            onClick={onClose}\n            className=\"rounded-full px-6 font-semibold text-slate-600 hover:text-slate-900 hover:bg-slate-100\"\n          >\n            Cancel\n          </Button>\n          <Button\n            onClick={handleSave}\n            className=\"rounded-full px-6 font-semibold bg-[#f95015] hover:bg-[#e04812] text-white shadow-sm border-none\"\n          >\n            Save Changes\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n","import { useState, useCallback, useRef } from 'react'\nimport { Funnel } from '@/types'\n\nconst MAX_HISTORY = 50\n\nexport function useCanvasHistory(initialFunnel: Funnel) {\n  const pastRef = useRef<string[]>([])\n  const futureRef = useRef<string[]>([])\n  const [, forceUpdate] = useState(0)\n\n  const pushState = useCallback((funnel: Funnel) => {\n    const snapshot = JSON.stringify({\n      nodes: funnel.nodes,\n      edges: funnel.edges,\n    })\n    pastRef.current.push(snapshot)\n    if (pastRef.current.length > MAX_HISTORY) {\n      pastRef.current.shift()\n    }\n    futureRef.current = []\n    forceUpdate((c) => c + 1)\n  }, [])\n\n  const undo = useCallback(\n    (currentFunnel: Funnel, onChange: (f: Funnel) => void) => {\n      if (pastRef.current.length === 0) return\n      const currentSnapshot = JSON.stringify({\n        nodes: currentFunnel.nodes,\n        edges: currentFunnel.edges,\n      })\n      futureRef.current.push(currentSnapshot)\n      const prev = pastRef.current.pop()!\n      const parsed = JSON.parse(prev)\n      onChange({ ...currentFunnel, nodes: parsed.nodes, edges: parsed.edges })\n      forceUpdate((c) => c + 1)\n    },\n    [],\n  )\n\n  const redo = useCallback(\n    (currentFunnel: Funnel, onChange: (f: Funnel) => void) => {\n      if (futureRef.current.length === 0) return\n      const currentSnapshot = JSON.stringify({\n        nodes: currentFunnel.nodes,\n        edges: currentFunnel.edges,\n      })\n      pastRef.current.push(currentSnapshot)\n      const next = futureRef.current.pop()!\n      const parsed = JSON.parse(next)\n      onChange({ ...currentFunnel, nodes: parsed.nodes, edges: parsed.edges })\n      forceUpdate((c) => c + 1)\n    },\n    [],\n  )\n\n  const canUndo = pastRef.current.length > 0\n  const canRedo = futureRef.current.length > 0\n\n  return { pushState, undo, redo, canUndo, canRedo }\n}\n","import { useState, useRef, useEffect } from 'react'\n\nexport function useCanvasTransform(initialScale = 1, hideHeader = false) {\n  const [transform, setTransform] = useState({\n    x: hideHeader ? 300 : 400,\n    y: 150,\n    scale: initialScale,\n  })\n  const [isPanning, setIsPanning] = useState(false)\n  const lastPan = useRef({ x: 0, y: 0 })\n\n  const zoomIn = () =>\n    setTransform((p) => ({ ...p, scale: Math.min(3, p.scale + 0.1) }))\n  const zoomOut = () =>\n    setTransform((p) => ({ ...p, scale: Math.max(0.1, p.scale - 0.1) }))\n  const resetZoom = () => setTransform({ x: 400, y: 150, scale: 1 })\n\n  return {\n    transform,\n    setTransform,\n    isPanning,\n    setIsPanning,\n    lastPan,\n    zoomIn,\n    zoomOut,\n    resetZoom,\n  }\n}\n","import { useState } from 'react'\n\nexport function useCanvasSelection() {\n  const [selectedNodes, setSelectedNodes] = useState<string[]>([])\n  const [selectedEdge, setSelectedEdge] = useState<string | null>(null)\n  const [selectionBox, setSelectionBox] = useState<{\n    startX: number\n    startY: number\n    currentX: number\n    currentY: number\n  } | null>(null)\n\n  return {\n    selectedNodes,\n    setSelectedNodes,\n    selectedEdge,\n    setSelectedEdge,\n    selectionBox,\n    setSelectionBox,\n  }\n}\n","import { useState, useRef, useEffect, useCallback } from 'react'\nimport { useNavigate, useSearchParams } from 'react-router-dom'\nimport { Funnel, Node, Edge, NodeData, Resource } from '@/types'\nimport { generateId } from '@/lib/generateId'\nimport BlockPalette from './BlockPalette'\nimport NodeItem from './NodeItem'\nimport RightPanel from './RightPanel'\nimport { NodeSettingsModal } from './NodeSettingsModal'\nimport { useCanvasHistory } from '@/hooks/useCanvasHistory'\nimport { useCanvasTransform } from '@/hooks/useCanvasTransform'\nimport { useCanvasSelection } from '@/hooks/useCanvasSelection'\nimport { ConfirmDialog } from '@/components/ConfirmDialog'\nimport {\n  Plus,\n  Minus,\n  Map,\n  Grid,\n  Edit2,\n  Image as ImageIcon,\n  MousePointer2,\n  Hand,\n  Type,\n  ArrowLeft,\n  Square,\n  Diamond,\n  Circle,\n} from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport {\n  Tooltip,\n  TooltipTrigger,\n  TooltipContent,\n} from '@/components/ui/tooltip'\nimport { cn } from '@/lib/utils'\nimport useTaskStore from '@/stores/useTaskStore'\nimport useDocumentStore from '@/stores/useDocumentStore'\nimport useResourceStore from '@/stores/useResourceStore'\nimport { useToast } from '@/hooks/use-toast'\nimport { format } from 'date-fns'\n\nconst getRightPortCoords = (node: Node, x: number, y: number) => {\n  const w = node.width || 120\n  const h = node.height || 120\n  if (['Square', 'Diamond', 'Circle'].includes(node.type))\n    return { x: x + w, y: y + h / 2 }\n  if (node.type === 'FloatingText') {\n    const textLen = (node.data.name || '').length\n    const approxW = Math.max(40, textLen * 8.5 + 16)\n    return { x: x + approxW, y: y + 20 }\n  }\n  if (node.type === 'Image') return { x: x + 300, y: y + 100 }\n  if (node.type === 'Text') return { x: x + 150, y: y + 30 }\n  return { x: x + 260, y: y + 44 }\n}\n\nconst getLeftPortCoords = (node: Node, x: number, y: number) => {\n  const h = node.height || 120\n  if (['Square', 'Diamond', 'Circle'].includes(node.type))\n    return { x, y: y + h / 2 }\n  if (node.type === 'FloatingText') return { x, y: y + 20 }\n  if (node.type === 'Image') return { x, y: y + 100 }\n  if (node.type === 'Text') return { x, y: y + 30 }\n  return { x, y: y + 44 }\n}\n\nconst getApproxBounds = (n: Node) => {\n  let w = n.width || 260\n  let h = n.height || 120\n  if (n.type === 'FloatingText') {\n    w = 150\n    h = 40\n  } else if (n.type === 'Text') {\n    w = 200\n    h = 80\n  } else if (n.type === 'Image') {\n    w = 300\n    h = 200\n  } else if (['Square', 'Diamond', 'Circle'].includes(n.type)) {\n    w = n.width || 120\n    h = n.height || 120\n  }\n  return { x: n.x, y: n.y, w, h }\n}\n\nexport default function CanvasBoard({\n  funnel,\n  onChange,\n  hideHeader,\n  onBack,\n}: {\n  funnel: Funnel\n  onChange: (f: Funnel) => void\n  hideHeader?: boolean\n  onBack?: () => void\n}) {\n  const navigate = useNavigate()\n  const [searchParams, setSearchParams] = useSearchParams()\n  const [tasks, setTasks] = useTaskStore()\n  const [docs, setDocs] = useDocumentStore()\n  const [resources, setResources] = useResourceStore()\n  const { toast } = useToast()\n  const { pushState, undo, redo } = useCanvasHistory(funnel)\n  const [nodeToDelete, setNodeToDelete] = useState<string | 'selected' | null>(\n    null,\n  )\n\n  const onChangeWithHistory = useCallback(\n    (newFunnel: Funnel) => {\n      pushState(funnel)\n      onChange(newFunnel)\n    },\n    [funnel, onChange, pushState],\n  )\n\n  const {\n    selectedNodes,\n    setSelectedNodes,\n    selectedEdge,\n    setSelectedEdge,\n    selectionBox,\n    setSelectionBox,\n  } = useCanvasSelection()\n\n  const {\n    transform,\n    setTransform,\n    isPanning,\n    setIsPanning,\n    lastPan,\n    zoomIn,\n    zoomOut,\n    resetZoom,\n  } = useCanvasTransform(1, hideHeader)\n\n  const [rightPanelState, setRightPanelState] = useState<{\n    nodeId: string\n    tab: string\n  } | null>(null)\n  const [isSpacePressed, setIsSpacePressed] = useState(false)\n  const [activeTool, setActiveTool] = useState<\n    'Select' | 'Pan' | 'Square' | 'Diamond' | 'Circle'\n  >('Select')\n  const [showMinimap, setShowMinimap] = useState(false)\n  const [snapToGrid, setSnapToGrid] = useState(false)\n\n  const [dragState, setDragState] = useState<{\n    isDragging: boolean\n    dx: number\n    dy: number\n  } | null>(null)\n  const [resizingNode, setResizingNode] = useState<{\n    id: string\n    x: number\n    y: number\n    width?: number\n    height?: number\n  } | null>(null)\n  const [drawingEdge, setDrawingEdge] = useState<{\n    source: string\n    currentX: number\n    currentY: number\n  } | null>(null)\n  const [creatingShape, setCreatingShape] = useState<{\n    type: string\n    startX: number\n    startY: number\n    currentX: number\n    currentY: number\n  } | null>(null)\n\n  const [settingsNodeId, setSettingsNodeId] = useState<string | null>(null)\n  const boardRef = useRef<HTMLDivElement>(null)\n\n  const targetNodeId = searchParams.get('nodeId')\n  useEffect(() => {\n    if (targetNodeId && funnel.nodes.length > 0) {\n      const node = funnel.nodes.find((n) => n.id === targetNodeId)\n      if (node && boardRef.current) {\n        const rect = boardRef.current.getBoundingClientRect()\n        setTransform({\n          x: rect.width / 2 - node.x * 1.5 - 195,\n          y: rect.height / 2 - node.y * 1.5 - 60,\n          scale: 1.5,\n        })\n        setSelectedNodes([node.id])\n        setRightPanelState({ nodeId: node.id, tab: 'details' })\n        searchParams.delete('nodeId')\n        setSearchParams(searchParams, { replace: true })\n      }\n    }\n  }, [\n    targetNodeId,\n    funnel.nodes,\n    searchParams,\n    setSearchParams,\n    setSelectedNodes,\n    setTransform,\n  ])\n\n  const handleGroupSelected = useCallback(() => {\n    if (selectedNodes.length < 2) return\n    const groupId = generateId('g')\n    onChangeWithHistory({\n      ...funnel,\n      nodes: funnel.nodes.map((n) =>\n        selectedNodes.includes(n.id) ? { ...n, groupId } : n,\n      ),\n    })\n    toast({ title: 'Elementos agrupados.' })\n  }, [funnel, selectedNodes, onChangeWithHistory, toast])\n\n  const handleDeleteSelected = useCallback(() => {\n    if (selectedNodes.length === 0) return\n    onChangeWithHistory({\n      ...funnel,\n      nodes: funnel.nodes.filter((n) => !selectedNodes.includes(n.id)),\n      edges: funnel.edges.filter(\n        (e) =>\n          !selectedNodes.includes(e.source) &&\n          !selectedNodes.includes(e.target),\n      ),\n    })\n    setSelectedNodes([])\n    if (rightPanelState && selectedNodes.includes(rightPanelState.nodeId))\n      setRightPanelState(null)\n    if (settingsNodeId && selectedNodes.includes(settingsNodeId))\n      setSettingsNodeId(null)\n  }, [\n    funnel,\n    selectedNodes,\n    onChangeWithHistory,\n    rightPanelState,\n    settingsNodeId,\n    setSelectedNodes,\n  ])\n\n  const handleConfirmDelete = useCallback(() => {\n    if (nodeToDelete === 'selected') {\n      handleDeleteSelected()\n    } else if (nodeToDelete && nodeToDelete !== 'selected') {\n      onChangeWithHistory({\n        ...funnel,\n        nodes: funnel.nodes.filter((x) => x.id !== nodeToDelete),\n        edges: funnel.edges.filter(\n          (e) => e.source !== nodeToDelete && e.target !== nodeToDelete,\n        ),\n      })\n      if (rightPanelState?.nodeId === nodeToDelete) setRightPanelState(null)\n      if (settingsNodeId === nodeToDelete) setSettingsNodeId(null)\n    }\n    setNodeToDelete(null)\n  }, [\n    nodeToDelete,\n    handleDeleteSelected,\n    funnel,\n    onChangeWithHistory,\n    rightPanelState,\n    settingsNodeId,\n  ])\n\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (\n        e.target instanceof HTMLInputElement ||\n        e.target instanceof HTMLTextAreaElement ||\n        (e.target as HTMLElement).isContentEditable\n      )\n        return\n      if (e.code === 'Space') {\n        e.preventDefault()\n        setIsSpacePressed(true)\n        return\n      }\n      switch (e.key.toLowerCase()) {\n        case '1':\n        case 'v':\n          setActiveTool('Select')\n          break\n        case '2':\n          setActiveTool('Square')\n          break\n        case '3':\n          setActiveTool('Diamond')\n          break\n        case '4':\n          setActiveTool('Circle')\n          break\n        case 'h':\n          setActiveTool('Pan')\n          break\n        case 'delete':\n        case 'backspace':\n          if (selectedNodes.length > 0) setNodeToDelete('selected')\n          break\n        case 'g':\n          if (e.ctrlKey || e.metaKey) {\n            e.preventDefault()\n            handleGroupSelected()\n          }\n          break\n        case 'z':\n          if (e.ctrlKey || e.metaKey) {\n            e.preventDefault()\n            if (e.shiftKey) {\n              redo(funnel, onChange)\n            } else {\n              undo(funnel, onChange)\n            }\n          }\n          break\n      }\n    }\n    const handleKeyUp = (e: KeyboardEvent) => {\n      if (e.code === 'Space') {\n        setIsSpacePressed(false)\n      }\n    }\n    window.addEventListener('keydown', handleKeyDown)\n    window.addEventListener('keyup', handleKeyUp)\n    return () => {\n      window.removeEventListener('keydown', handleKeyDown)\n      window.removeEventListener('keyup', handleKeyUp)\n    }\n  }, [\n    handleDeleteSelected,\n    handleGroupSelected,\n    selectedNodes.length,\n    undo,\n    redo,\n    funnel,\n    onChange,\n  ])\n\n  useEffect(() => {\n    const handlePaste = (e: ClipboardEvent) => {\n      const items = e.clipboardData?.items\n      if (!items) return\n      for (let i = 0; i < items.length; i++) {\n        if (items[i].type.indexOf('image') !== -1) {\n          const newAsset: Resource = {\n            id: generateId('a'),\n            projectId: funnel.projectId,\n            title: 'Pasted Image ' + format(new Date(), 'HH:mm:ss'),\n            content:\n              'https://img.usecurling.com/p/800/600?q=wireframe&color=gray',\n            type: 'image',\n            tags: ['pasted', 'canvas'],\n            folderId: null,\n            isPinned: false,\n            createdAt: new Date().toISOString(),\n          }\n          setResources((prev) => [newAsset, ...prev])\n\n          const newNode: Node = {\n            id: generateId('n'),\n            type: 'Image',\n            x: -transform.x / transform.scale + 400,\n            y: -transform.y / transform.scale + 200,\n            data: {\n              name: newAsset.content,\n              status: '',\n              subtitle: '',\n              linkedAssetIds: [newAsset.id],\n            },\n          }\n          onChangeWithHistory({ ...funnel, nodes: [...funnel.nodes, newNode] })\n          setSelectedNodes([newNode.id])\n          toast({ title: 'Imagem colada no canvas!' })\n        }\n      }\n    }\n    window.addEventListener('paste', handlePaste)\n    return () => window.removeEventListener('paste', handlePaste)\n  }, [\n    funnel,\n    setResources,\n    transform,\n    onChangeWithHistory,\n    setSelectedNodes,\n    toast,\n  ])\n\n  useEffect(() => {\n    const el = boardRef.current\n    if (!el) return\n    const onWheel = (e: WheelEvent) => {\n      e.preventDefault()\n      if (e.ctrlKey || e.metaKey) {\n        setTransform((prev) => {\n          let newScale = prev.scale * Math.exp(e.deltaY * -0.005)\n          newScale = Math.min(Math.max(0.1, newScale), 3)\n          const rect = el.getBoundingClientRect()\n          const mouseX = e.clientX - rect.left,\n            mouseY = e.clientY - rect.top\n          return {\n            x: mouseX - (mouseX - prev.x) * (newScale / prev.scale),\n            y: mouseY - (mouseY - prev.y) * (newScale / prev.scale),\n            scale: newScale,\n          }\n        })\n      } else {\n        setTransform((prev) => ({\n          ...prev,\n          x: prev.x - e.deltaX,\n          y: prev.y - e.deltaY,\n        }))\n      }\n    }\n    el.addEventListener('wheel', onWheel, { passive: false })\n    return () => el.removeEventListener('wheel', onWheel)\n  }, [setTransform])\n\n  const handlePointerDown = (e: React.PointerEvent) => {\n    const isCanvasBg =\n      e.target === boardRef.current ||\n      (e.target as HTMLElement).classList.contains('canvas-container') ||\n      (e.target as HTMLElement).tagName === 'svg'\n    const rect = boardRef.current?.getBoundingClientRect()\n    if (!rect) return\n\n    const isMiddleClick = e.button === 1\n    const isSpaceRightClick = isSpacePressed && e.button === 2\n\n    if (activeTool === 'Pan' || isMiddleClick || isSpaceRightClick) {\n      setIsPanning(true)\n      lastPan.current = { x: e.clientX, y: e.clientY }\n      ;(e.target as HTMLElement).setPointerCapture(e.pointerId)\n      document.body.style.userSelect = 'none'\n      return\n    }\n\n    if (isCanvasBg && e.button === 0) {\n      if (['Square', 'Diamond', 'Circle'].includes(activeTool)) {\n        let x = (e.clientX - rect.left - transform.x) / transform.scale\n        let y = (e.clientY - rect.top - transform.y) / transform.scale\n        if (snapToGrid) {\n          x = Math.round(x / 28) * 28\n          y = Math.round(y / 28) * 28\n        }\n        setCreatingShape({\n          type: activeTool,\n          startX: x,\n          startY: y,\n          currentX: x,\n          currentY: y,\n        })\n        ;(e.target as HTMLElement).setPointerCapture(e.pointerId)\n        e.stopPropagation()\n        return\n      }\n\n      if (activeTool === 'Select') {\n        setSelectedNodes([])\n        setSelectedEdge(null)\n        let x = (e.clientX - rect.left - transform.x) / transform.scale\n        let y = (e.clientY - rect.top - transform.y) / transform.scale\n        setSelectionBox({ startX: x, startY: y, currentX: x, currentY: y })\n        ;(e.target as HTMLElement).setPointerCapture(e.pointerId)\n      }\n    }\n  }\n\n  const handlePointerMove = (e: React.PointerEvent) => {\n    const rect = boardRef.current?.getBoundingClientRect()\n    if (!rect) return\n\n    if (creatingShape) {\n      let x = (e.clientX - rect.left - transform.x) / transform.scale\n      let y = (e.clientY - rect.top - transform.y) / transform.scale\n      if (snapToGrid) {\n        x = Math.round(x / 28) * 28\n        y = Math.round(y / 28) * 28\n      }\n      setCreatingShape((prev) =>\n        prev ? { ...prev, currentX: x, currentY: y } : null,\n      )\n      return\n    }\n\n    if (selectionBox) {\n      let x = (e.clientX - rect.left - transform.x) / transform.scale\n      let y = (e.clientY - rect.top - transform.y) / transform.scale\n      setSelectionBox((prev) =>\n        prev ? { ...prev, currentX: x, currentY: y } : null,\n      )\n\n      const minX = Math.min(selectionBox.startX, x)\n      const maxX = Math.max(selectionBox.startX, x)\n      const minY = Math.min(selectionBox.startY, y)\n      const maxY = Math.max(selectionBox.startY, y)\n\n      const newSelected = funnel.nodes\n        .filter((n) => {\n          const bounds = getApproxBounds(n)\n          return (\n            bounds.x < maxX &&\n            bounds.x + bounds.w > minX &&\n            bounds.y < maxY &&\n            bounds.y + bounds.h > minY\n          )\n        })\n        .map((n) => n.id)\n      setSelectedNodes(newSelected)\n      return\n    }\n\n    if (isPanning) {\n      setTransform((prev) => ({\n        ...prev,\n        x: prev.x + (e.clientX - lastPan.current.x),\n        y: prev.y + (e.clientY - lastPan.current.y),\n      }))\n      lastPan.current = { x: e.clientX, y: e.clientY }\n    }\n  }\n\n  const handlePointerUp = (e: React.PointerEvent) => {\n    if (creatingShape) {\n      const width = Math.abs(creatingShape.currentX - creatingShape.startX)\n      const height = Math.abs(creatingShape.currentY - creatingShape.startY)\n      const x = Math.min(creatingShape.startX, creatingShape.currentX)\n      const y = Math.min(creatingShape.startY, creatingShape.currentY)\n\n      if (width > 10 && height > 10) {\n        const newNodeId = generateId('n')\n        onChangeWithHistory({\n          ...funnel,\n          nodes: [\n            ...funnel.nodes,\n            {\n              id: newNodeId,\n              type: creatingShape.type,\n              x,\n              y,\n              width,\n              height,\n              data: { name: '', status: '', subtitle: '' },\n              style: {\n                fill: 'transparent',\n                opacity: 1,\n                stroke: '#1e293b',\n                strokeWidth: 2,\n                strokeDasharray: 'none',\n              },\n            },\n          ],\n        })\n        setSelectedNodes([newNodeId])\n      }\n      setCreatingShape(null)\n      setActiveTool('Select')\n      try {\n        ;(e.target as HTMLElement).releasePointerCapture(e.pointerId)\n      } catch (err) {\n        /* ignore */\n      }\n      return\n    }\n\n    if (selectionBox) {\n      setSelectionBox(null)\n      try {\n        ;(e.target as HTMLElement).releasePointerCapture(e.pointerId)\n      } catch (err) {\n        /* ignore */\n      }\n      return\n    }\n\n    if (isPanning) {\n      setIsPanning(false)\n      try {\n        ;(e.target as HTMLElement).releasePointerCapture(e.pointerId)\n      } catch (err) {\n        /* ignore */\n      }\n      document.body.style.userSelect = ''\n    }\n  }\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault()\n    const type = e.dataTransfer.getData('blockType')\n    if (!type) return\n    const rect = boardRef.current?.getBoundingClientRect()\n    if (!rect) return\n    let x = (e.clientX - rect.left - transform.x) / transform.scale - 130\n    let y = (e.clientY - rect.top - transform.y) / transform.scale - 40\n    if (snapToGrid) {\n      x = Math.round(x / 28) * 28\n      y = Math.round(y / 28) * 28\n    }\n    const newNodeId = generateId('n')\n    onChangeWithHistory({\n      ...funnel,\n      nodes: [\n        ...funnel.nodes,\n        {\n          id: newNodeId,\n          type,\n          x,\n          y,\n          data: { name: type, status: 'A Fazer', subtitle: '+1 filter' },\n        },\n      ],\n    })\n    setSelectedNodes([newNodeId])\n  }\n\n  const handleEdgeDragStart = (nodeId: string, e: React.PointerEvent) => {\n    if (e.button !== 0) return\n    const rect = boardRef.current?.getBoundingClientRect()\n    if (!rect) return\n    const getCoords = (cx: number, cy: number) => ({\n      x: (cx - rect.left - transform.x) / transform.scale,\n      y: (cy - rect.top - transform.y) / transform.scale,\n    })\n    const coords = getCoords(e.clientX, e.clientY)\n    setDrawingEdge({ source: nodeId, currentX: coords.x, currentY: coords.y })\n\n    const onMove = (ev: PointerEvent) => {\n      const coords = getCoords(ev.clientX, ev.clientY)\n      setDrawingEdge((prev) =>\n        prev ? { ...prev, currentX: coords.x, currentY: coords.y } : null,\n      )\n    }\n    const onUp = (ev: PointerEvent) => {\n      const targetNodeEl = document\n        .elementFromPoint(ev.clientX, ev.clientY)\n        ?.closest('[data-node-id]')\n      if (targetNodeEl) {\n        const targetId = targetNodeEl.getAttribute('data-node-id')\n        if (\n          targetId &&\n          targetId !== nodeId &&\n          !funnel.edges.some(\n            (edge) => edge.source === nodeId && edge.target === targetId,\n          )\n        ) {\n          onChangeWithHistory({\n            ...funnel,\n            edges: [\n              ...funnel.edges,\n              { id: generateId('e'), source: nodeId, target: targetId },\n            ],\n          })\n        }\n      }\n      setDrawingEdge(null)\n      window.removeEventListener('pointermove', onMove)\n      window.removeEventListener('pointerup', onUp)\n      window.removeEventListener('pointercancel', onUp)\n    }\n    window.addEventListener('pointermove', onMove)\n    window.addEventListener('pointerup', onUp)\n    window.addEventListener('pointercancel', onUp)\n  }\n\n  const handleAddChild = (parentId: string) => {\n    const parent = funnel.nodes.find((n) => n.id === parentId)\n    if (!parent) return\n    const newId = generateId('n')\n    let newX = parent.x + 350,\n      newY = parent.y\n    if (snapToGrid) {\n      newX = Math.round(newX / 28) * 28\n      newY = Math.round(newY / 28) * 28\n    }\n    onChangeWithHistory({\n      ...funnel,\n      nodes: [\n        ...funnel.nodes,\n        {\n          id: newId,\n          type: 'Default',\n          x: newX,\n          y: newY,\n          data: { name: 'New Step', status: 'A Fazer', subtitle: '+1 filter' },\n        },\n      ],\n      edges: [\n        ...funnel.edges,\n        { id: generateId('e'), source: parentId, target: newId },\n      ],\n    })\n  }\n\n  const handleAddAnnotation = (type: 'Text' | 'Image', name: string) => {\n    const newNodeId = generateId('n')\n    onChangeWithHistory({\n      ...funnel,\n      nodes: [\n        ...funnel.nodes,\n        {\n          id: newNodeId,\n          type,\n          x: -transform.x / transform.scale + 400,\n          y: -transform.y / transform.scale + 200,\n          data: { name, status: '', subtitle: '' },\n          style: type === 'Text' ? { color: '#1e293b' } : undefined,\n        },\n      ],\n    })\n    setSelectedNodes([newNodeId])\n  }\n\n  const handleDropResource = (nodeId: string, type: string, id: string) => {\n    const updatedNodes = funnel.nodes.map((n) => {\n      if (n.id === nodeId) {\n        const key =\n          type === 'document'\n            ? 'linkedDocumentIds'\n            : type === 'task'\n              ? 'linkedTaskIds'\n              : 'linkedAssetIds'\n        const currentIds = (n.data[key as keyof NodeData] as string[]) || []\n        if (!currentIds.includes(id))\n          return { ...n, data: { ...n.data, [key]: [...currentIds, id] } }\n      }\n      return n\n    })\n    onChangeWithHistory({ ...funnel, nodes: updatedNodes })\n\n    if (type === 'document')\n      setDocs(\n        docs.map((d) =>\n          d.id === id ? { ...d, funnelId: funnel.id, nodeId } : d,\n        ),\n      )\n    else if (type === 'task')\n      setTasks(\n        tasks.map((t) =>\n          t.id === id ? { ...t, funnelId: funnel.id, nodeId } : t,\n        ),\n      )\n    else if (type === 'asset')\n      setResources(\n        resources.map((a) =>\n          a.id === id ? { ...a, projectId: funnel.projectId } : a,\n        ),\n      )\n  }\n\n  const updateEdgeStyle = (styleUpdates: Partial<Edge['style']>) => {\n    if (selectedEdge) {\n      onChangeWithHistory({\n        ...funnel,\n        edges: funnel.edges.map((e) =>\n          e.id === selectedEdge\n            ? { ...e, style: { ...e.style, ...styleUpdates } }\n            : e,\n        ),\n      })\n    }\n  }\n\n  const updateNodeStyle = (updates: Partial<Node['style']>) => {\n    if (selectedNodes.length > 0) {\n      onChangeWithHistory({\n        ...funnel,\n        nodes: funnel.nodes.map((n) =>\n          selectedNodes.includes(n.id)\n            ? { ...n, style: { ...n.style, ...updates } }\n            : n,\n        ),\n      })\n    }\n  }\n\n  const handleNodePointerDown = (id: string, shiftKey: boolean) => {\n    const n = funnel.nodes.find((x) => x.id === id)\n    if (!n) return\n    const groupMembers = n.groupId\n      ? funnel.nodes.filter((x) => x.groupId === n.groupId).map((x) => x.id)\n      : [id]\n    if (!selectedNodes.includes(id)) {\n      if (shiftKey)\n        setSelectedNodes([...new Set([...selectedNodes, ...groupMembers])])\n      else setSelectedNodes(groupMembers)\n      setSelectedEdge(null)\n    } else if (shiftKey) {\n      setSelectedNodes(selectedNodes.filter((x) => !groupMembers.includes(x)))\n    }\n  }\n\n  const rightOffset = rightPanelState ? 'right-[540px]' : 'right-6'\n  const canvasTools = [\n    { id: 'Select', icon: MousePointer2, label: 'Select (1)', key: '1' },\n    { id: 'Pan', icon: Hand, label: 'Pan (H)', key: 'H' },\n    { id: 'divider' },\n    { id: 'Square', icon: Square, label: 'Square (2)', key: '2' },\n    { id: 'Diamond', icon: Diamond, label: 'Diamond (3)', key: '3' },\n    { id: 'Circle', icon: Circle, label: 'Circle (4)', key: '4' },\n  ]\n\n  const isMultiSelect = selectedNodes.length > 1\n  const selectedNodeObj =\n    selectedNodes.length > 0\n      ? funnel.nodes.find((n) => n.id === selectedNodes[0])\n      : undefined\n  const selectedEdgeObj = funnel.edges.find((e) => e.id === selectedEdge)\n\n  const getEffectiveNode = (n: Node | undefined) => {\n    if (!n) return undefined\n    if (resizingNode?.id === n.id) {\n      return {\n        ...n,\n        x: resizingNode.x,\n        y: resizingNode.y,\n        width: resizingNode.width,\n        height: resizingNode.height,\n      }\n    }\n    if (selectedNodes.includes(n.id) && dragState) {\n      return { ...n, x: n.x + dragState.dx, y: n.y + dragState.dy }\n    }\n    return n\n  }\n\n  return (\n    <div className=\"flex-1 flex relative overflow-hidden bg-[#f8fafc]\">\n      {!hideHeader && (\n        <div className=\"absolute top-6 left-[300px] flex items-center gap-3 text-[14px] z-30 bg-white/90 backdrop-blur-md px-5 py-2.5 rounded-full border border-slate-100 shadow-[0_8px_30px_rgba(0,0,0,0.06)]\">\n          <span\n            className=\"text-slate-500 font-medium cursor-pointer hover:text-slate-800 transition-colors\"\n            onClick={() => navigate('/canvas')}\n          >\n            Campaigns\n          </span>\n          <span className=\"text-slate-300\">/</span>\n          <span className=\"font-semibold text-slate-800\">{funnel.name}</span>\n          <button className=\"text-slate-400 hover:text-purple-600 transition-colors ml-1\">\n            <Edit2 size={14} strokeWidth={2} />\n          </button>\n        </div>\n      )}\n\n      {onBack && !hideHeader && (\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          className=\"absolute top-6 left-6 z-30 bg-white/90 backdrop-blur-md shadow-sm border border-slate-100 rounded-full px-4 hover:bg-white text-slate-600 hover:text-slate-900\"\n          onClick={onBack}\n        >\n          <ArrowLeft size={16} className=\"mr-2\" /> Voltar\n        </Button>\n      )}\n\n      <div\n        className={cn(\n          'absolute left-1/2 -translate-x-1/2 flex items-center p-1.5 bg-white/90 backdrop-blur-md rounded-full shadow-[0_8px_30px_rgba(0,0,0,0.06)] border border-slate-200 z-30 gap-1',\n          hideHeader ? 'top-4' : 'top-6',\n        )}\n      >\n        {canvasTools.map((t) => {\n          if (t.id === 'divider')\n            return <div key={t.id} className=\"w-px h-6 bg-slate-200 mx-1\" />\n          return (\n            <Tooltip key={t.id}>\n              <TooltipTrigger asChild>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className={cn(\n                    'w-10 h-10 rounded-full transition-all relative',\n                    activeTool === t.id\n                      ? 'bg-primary/10 text-primary shadow-sm'\n                      : 'text-slate-500 hover:text-slate-700 hover:bg-slate-100',\n                  )}\n                  onClick={() => setActiveTool(t.id as any)}\n                >\n                  <t.icon size={18} />\n                  {t.key && t.id !== 'Pan' && (\n                    <span className=\"absolute bottom-1 right-1.5 text-[9px] font-bold opacity-60\">\n                      {t.key}\n                    </span>\n                  )}\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent>{t.label}</TooltipContent>\n            </Tooltip>\n          )\n        })}\n        <div className=\"w-px h-6 bg-slate-200 mx-1\" />\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"w-10 h-10 rounded-full text-slate-500 hover:text-slate-700\"\n              onClick={() => handleAddAnnotation('Text', 'Add text here...')}\n            >\n              <Type size={18} />\n            </Button>\n          </TooltipTrigger>\n          <TooltipContent>Add Note</TooltipContent>\n        </Tooltip>\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"w-10 h-10 rounded-full text-slate-500 hover:text-slate-700\"\n              onClick={() =>\n                handleAddAnnotation(\n                  'Image',\n                  'https://img.usecurling.com/p/400/300?q=marketing',\n                )\n              }\n            >\n              <ImageIcon size={18} />\n            </Button>\n          </TooltipTrigger>\n          <TooltipContent>Add Image</TooltipContent>\n        </Tooltip>\n      </div>\n\n      <div\n        className={cn(\n          'absolute flex items-center p-1 bg-white/90 backdrop-blur-md rounded-full shadow-[0_8px_30px_rgba(0,0,0,0.06)] border border-slate-200 z-30 gap-1 transition-all duration-300',\n          rightOffset,\n          hideHeader ? 'top-4' : 'top-6',\n        )}\n      >\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className=\"w-8 h-8 rounded-full text-slate-500 hover:text-slate-700 hover:bg-slate-100\"\n          onClick={zoomOut}\n        >\n          <Minus size={16} />\n        </Button>\n        <button\n          onClick={resetZoom}\n          className=\"text-[13px] font-semibold text-slate-600 px-3 min-w-[3.5rem] hover:text-primary transition-colors text-center\"\n        >\n          {Math.round(transform.scale * 100)}%\n        </button>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className=\"w-8 h-8 rounded-full text-slate-500 hover:text-slate-700 hover:bg-slate-100\"\n          onClick={zoomIn}\n        >\n          <Plus size={16} />\n        </Button>\n      </div>\n\n      <div\n        className={cn(\n          'absolute bottom-6 flex items-center gap-2 z-30 transition-all duration-300',\n          rightOffset,\n        )}\n      >\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <button\n              onClick={() => setSnapToGrid(!snapToGrid)}\n              className={cn(\n                'w-10 h-10 flex items-center justify-center bg-white border border-slate-100 shadow-[0_8px_30px_rgba(0,0,0,0.08)] rounded-full text-slate-500 hover:text-slate-700 transition-all',\n                snapToGrid && 'bg-primary/10 text-primary border-primary/20',\n              )}\n            >\n              <Grid size={16} />\n            </button>\n          </TooltipTrigger>\n          <TooltipContent>Snap to Grid</TooltipContent>\n        </Tooltip>\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <button\n              onClick={() => setShowMinimap(!showMinimap)}\n              className={cn(\n                'w-10 h-10 flex items-center justify-center bg-white border border-slate-100 shadow-[0_8px_30px_rgba(0,0,0,0.08)] rounded-full text-slate-500 hover:text-slate-700 transition-all',\n                showMinimap && 'bg-primary/10 text-primary border-primary/20',\n              )}\n            >\n              <Map size={16} />\n            </button>\n          </TooltipTrigger>\n          <TooltipContent>Minimap</TooltipContent>\n        </Tooltip>\n      </div>\n\n      <div\n        className={cn(\n          'absolute left-0 z-20 bottom-0 flex pointer-events-none transition-all',\n          hideHeader ? 'top-0' : onBack ? 'top-[72px]' : 'top-6',\n        )}\n      >\n        <div className=\"pointer-events-auto flex h-full\">\n          <BlockPalette funnel={funnel} />\n        </div>\n      </div>\n\n      {showMinimap && (\n        <div\n          className={cn(\n            'absolute bottom-20 transition-all duration-300 w-48 h-32 bg-white/90 backdrop-blur-md border border-slate-200 shadow-[0_8px_30px_rgba(0,0,0,0.08)] rounded-2xl overflow-hidden z-30',\n            rightOffset,\n          )}\n        >\n          <div\n            className=\"w-full h-full relative bg-slate-50/50\"\n            style={{ transform: 'scale(0.08)', transformOrigin: 'top left' }}\n          >\n            {funnel.nodes.map((n) => (\n              <div\n                key={n.id}\n                className=\"absolute bg-slate-300 rounded-xl\"\n                style={{\n                  left: n.x,\n                  top: n.y,\n                  width:\n                    n.width ||\n                    (n.type === 'Text' || n.type === 'Image' ? 200 : 260),\n                  height: n.height || 100,\n                }}\n              />\n            ))}\n            <div\n              className=\"absolute border-4 border-primary bg-primary/10 rounded-xl\"\n              style={{\n                left: -transform.x / transform.scale,\n                top: -transform.y / transform.scale,\n                width:\n                  (boardRef.current?.clientWidth || 1000) / transform.scale,\n                height:\n                  (boardRef.current?.clientHeight || 800) / transform.scale,\n              }}\n            />\n          </div>\n        </div>\n      )}\n\n      {(selectedNodeObj || selectedEdgeObj) && (\n        <div\n          className={cn(\n            'absolute top-6 bg-white/95 backdrop-blur-md rounded-3xl shadow-[0_12px_40px_rgba(0,0,0,0.12)] border border-slate-100 p-5 w-[280px] flex flex-col gap-6 z-40 transition-all max-h-[85vh] overflow-y-auto',\n            rightPanelState ? 'right-[540px]' : 'right-6',\n          )}\n        >\n          <div className=\"flex justify-between items-center\">\n            <h4 className=\"text-[12px] font-bold text-slate-800 tracking-widest uppercase\">\n              {isMultiSelect\n                ? 'MULTIPLE SELECTED'\n                : selectedNodeObj\n                  ? selectedNodeObj.type === 'FloatingText'\n                    ? 'Text Style'\n                    : ['Square', 'Diamond', 'Circle'].includes(\n                          selectedNodeObj.type,\n                        )\n                      ? 'SHAPE STYLE'\n                      : 'NODE STYLE'\n                  : 'Line Style'}\n            </h4>\n          </div>\n\n          {selectedNodeObj &&\n            ['Square', 'Diamond', 'Circle'].includes(selectedNodeObj.type) && (\n              <>\n                <div className=\"space-y-3\">\n                  <label className=\"text-[11px] font-semibold text-slate-500 uppercase tracking-wider block\">\n                    Background Opacity\n                  </label>\n                  <div className=\"flex gap-4 items-center\">\n                    <input\n                      type=\"range\"\n                      min=\"0\"\n                      max=\"1\"\n                      step=\"0.05\"\n                      className=\"flex-1 accent-primary h-1.5 bg-slate-100 rounded-full appearance-none cursor-pointer\"\n                      value={selectedNodeObj.style?.opacity ?? 1}\n                      onChange={(e) =>\n                        updateNodeStyle({ opacity: parseFloat(e.target.value) })\n                      }\n                    />\n                    <span className=\"text-[13px] font-medium text-slate-600 w-8 text-right\">\n                      {Math.round((selectedNodeObj.style?.opacity ?? 1) * 100)}%\n                    </span>\n                  </div>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <label className=\"text-[11px] font-semibold text-slate-500 uppercase tracking-wider block\">\n                    Fill Color\n                  </label>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {[\n                      'transparent',\n                      '#f8fafc',\n                      '#fce7f3',\n                      '#f3e8ff',\n                      '#e0e7ff',\n                      '#dbeafe',\n                      '#d1fae5',\n                      '#dcfce7',\n                      '#fef9c3',\n                      '#fef08a',\n                      '#ffedd5',\n                      '#fee2e2',\n                      '#1e293b',\n                      '#64748b',\n                      '#ef4444',\n                      '#f97316',\n                      '#f59e0b',\n                      '#84cc16',\n                      '#10b981',\n                      '#06b6d4',\n                      '#3b82f6',\n                      '#6366f1',\n                      '#a855f7',\n                      '#ec4899',\n                    ].map((c) => (\n                      <button\n                        key={c}\n                        className={cn(\n                          'w-7 h-7 rounded-lg border-2 transition-transform',\n                          selectedNodeObj.style?.fill === c ||\n                            (c === 'transparent' &&\n                              !selectedNodeObj.style?.fill)\n                            ? 'border-slate-800 scale-110'\n                            : 'border-slate-200 hover:scale-110',\n                        )}\n                        style={{\n                          backgroundColor: c === 'transparent' ? '#fff' : c,\n                          backgroundImage:\n                            c === 'transparent'\n                              ? 'radial-gradient(#e2e8f0 1px, transparent 0)'\n                              : 'none',\n                          backgroundSize: '4px 4px',\n                        }}\n                        onClick={() => updateNodeStyle({ fill: c })}\n                      />\n                    ))}\n                  </div>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <label className=\"text-[11px] font-semibold text-slate-500 uppercase tracking-wider block\">\n                    Stroke Color\n                  </label>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {[\n                      '#1e293b',\n                      '#64748b',\n                      '#ef4444',\n                      '#f97316',\n                      '#f59e0b',\n                      '#84cc16',\n                      '#10b981',\n                      '#06b6d4',\n                      '#3b82f6',\n                      '#6366f1',\n                      '#a855f7',\n                      '#ec4899',\n                    ].map((c) => (\n                      <button\n                        key={c}\n                        className={cn(\n                          'w-7 h-7 rounded-lg border-2 transition-transform',\n                          selectedNodeObj.style?.stroke === c ||\n                            (c === '#1e293b' && !selectedNodeObj.style?.stroke)\n                            ? 'border-slate-800 scale-110'\n                            : 'border-transparent hover:scale-110',\n                        )}\n                        style={{ backgroundColor: c }}\n                        onClick={() => updateNodeStyle({ stroke: c })}\n                      />\n                    ))}\n                  </div>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <label className=\"text-[11px] font-semibold text-slate-500 uppercase tracking-wider block\">\n                    Stroke Width\n                  </label>\n                  <div className=\"flex gap-4 items-center\">\n                    <input\n                      type=\"range\"\n                      min=\"1\"\n                      max=\"8\"\n                      step=\"1\"\n                      className=\"flex-1 accent-primary h-1.5 bg-slate-100 rounded-full appearance-none cursor-pointer\"\n                      value={selectedNodeObj.style?.strokeWidth || 2}\n                      onChange={(e) =>\n                        updateNodeStyle({\n                          strokeWidth: parseInt(e.target.value),\n                        })\n                      }\n                    />\n                    <span className=\"text-[13px] font-medium text-slate-600 w-4 text-center\">\n                      {selectedNodeObj.style?.strokeWidth || 2}\n                    </span>\n                  </div>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <label className=\"text-[11px] font-semibold text-slate-500 uppercase tracking-wider block\">\n                    Border Style\n                  </label>\n                  <div className=\"flex gap-2\">\n                    <button\n                      className={cn(\n                        'flex-1 h-9 rounded-lg border-2 flex items-center justify-center transition-colors',\n                        selectedNodeObj.style?.strokeDasharray === 'none' ||\n                          !selectedNodeObj.style?.strokeDasharray\n                          ? 'border-primary bg-primary/10 text-primary'\n                          : 'border-slate-100 bg-white hover:bg-slate-50 text-slate-400',\n                      )}\n                      onClick={() =>\n                        updateNodeStyle({ strokeDasharray: 'none' })\n                      }\n                    >\n                      <svg width=\"24\" height=\"2\" className=\"overflow-visible\">\n                        <line\n                          x1=\"0\"\n                          y1=\"1\"\n                          x2=\"24\"\n                          y2=\"1\"\n                          stroke=\"currentColor\"\n                          strokeWidth=\"2.5\"\n                        />\n                      </svg>\n                    </button>\n                    <button\n                      className={cn(\n                        'flex-1 h-9 rounded-lg border-2 flex items-center justify-center transition-colors',\n                        selectedNodeObj.style?.strokeDasharray === '8 8'\n                          ? 'border-primary bg-primary/10 text-primary'\n                          : 'border-slate-100 bg-white hover:bg-slate-50 text-slate-400',\n                      )}\n                      onClick={() =>\n                        updateNodeStyle({ strokeDasharray: '8 8' })\n                      }\n                    >\n                      <svg width=\"24\" height=\"2\" className=\"overflow-visible\">\n                        <line\n                          x1=\"0\"\n                          y1=\"1\"\n                          x2=\"24\"\n                          y2=\"1\"\n                          stroke=\"currentColor\"\n                          strokeWidth=\"2.5\"\n                          strokeDasharray=\"6 6\"\n                        />\n                      </svg>\n                    </button>\n                    <button\n                      className={cn(\n                        'flex-1 h-9 rounded-lg border-2 flex items-center justify-center transition-colors',\n                        selectedNodeObj.style?.strokeDasharray === '4 4'\n                          ? 'border-primary bg-primary/10 text-primary'\n                          : 'border-slate-100 bg-white hover:bg-slate-50 text-slate-400',\n                      )}\n                      onClick={() =>\n                        updateNodeStyle({ strokeDasharray: '4 4' })\n                      }\n                    >\n                      <svg width=\"24\" height=\"2\" className=\"overflow-visible\">\n                        <line\n                          x1=\"0\"\n                          y1=\"1\"\n                          x2=\"24\"\n                          y2=\"1\"\n                          stroke=\"currentColor\"\n                          strokeWidth=\"2.5\"\n                          strokeDasharray=\"2 4\"\n                          strokeLinecap=\"round\"\n                        />\n                      </svg>\n                    </button>\n                  </div>\n                </div>\n              </>\n            )}\n\n          {selectedNodeObj &&\n            ![\n              'FloatingText',\n              'Text',\n              'Image',\n              'Square',\n              'Diamond',\n              'Circle',\n            ].includes(selectedNodeObj.type) && (\n              <>\n                <div className=\"space-y-3\">\n                  <label className=\"text-[11px] font-semibold text-slate-500 uppercase tracking-wider block\">\n                    Background Opacity\n                  </label>\n                  <div className=\"flex gap-4 items-center\">\n                    <input\n                      type=\"range\"\n                      min=\"0\"\n                      max=\"1\"\n                      step=\"0.05\"\n                      className=\"flex-1 accent-primary h-1.5 bg-slate-100 rounded-full appearance-none cursor-pointer\"\n                      value={selectedNodeObj.style?.opacity ?? 1}\n                      onChange={(e) =>\n                        updateNodeStyle({ opacity: parseFloat(e.target.value) })\n                      }\n                    />\n                    <span className=\"text-[13px] font-medium text-slate-600 w-8 text-right\">\n                      {Math.round((selectedNodeObj.style?.opacity ?? 1) * 100)}%\n                    </span>\n                  </div>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <label className=\"text-[11px] font-semibold text-slate-500 uppercase tracking-wider block\">\n                    Background Color\n                  </label>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {[\n                      'transparent',\n                      '#f8fafc',\n                      '#fce7f3',\n                      '#f3e8ff',\n                      '#e0e7ff',\n                      '#dbeafe',\n                      '#d1fae5',\n                      '#dcfce7',\n                      '#fef9c3',\n                      '#fef08a',\n                      '#ffedd5',\n                      '#fee2e2',\n                      '#1e293b',\n                      '#64748b',\n                      '#ef4444',\n                      '#f97316',\n                      '#f59e0b',\n                      '#84cc16',\n                      '#10b981',\n                      '#06b6d4',\n                      '#3b82f6',\n                      '#6366f1',\n                      '#a855f7',\n                      '#ec4899',\n                    ].map((c) => (\n                      <button\n                        key={c}\n                        className={cn(\n                          'w-7 h-7 rounded-lg border-2 transition-transform',\n                          selectedNodeObj.style?.fill === c ||\n                            (c === 'transparent' &&\n                              !selectedNodeObj.style?.fill)\n                            ? 'border-slate-800 scale-110'\n                            : 'border-slate-200 hover:scale-110',\n                        )}\n                        style={{\n                          backgroundColor: c === 'transparent' ? '#fff' : c,\n                          backgroundImage:\n                            c === 'transparent'\n                              ? 'radial-gradient(#e2e8f0 1px, transparent 0)'\n                              : 'none',\n                          backgroundSize: '4px 4px',\n                        }}\n                        onClick={() => updateNodeStyle({ fill: c })}\n                      />\n                    ))}\n                  </div>\n                </div>\n              </>\n            )}\n\n          {selectedNodeObj && selectedNodeObj.type === 'FloatingText' && (\n            <div className=\"space-y-3\">\n              <label className=\"text-[11px] font-semibold text-slate-500 uppercase tracking-wider block\">\n                Text Color\n              </label>\n              <div className=\"flex flex-wrap gap-2\">\n                {[\n                  '#1e293b',\n                  '#64748b',\n                  '#ef4444',\n                  '#f97316',\n                  '#f59e0b',\n                  '#84cc16',\n                  '#10b981',\n                  '#06b6d4',\n                  '#3b82f6',\n                  '#6366f1',\n                  '#a855f7',\n                  '#ec4899',\n                ].map((c) => (\n                  <button\n                    key={c}\n                    className={cn(\n                      'w-7 h-7 rounded-lg border-2 transition-transform',\n                      selectedNodeObj.style?.color === c ||\n                        (c === '#1e293b' && !selectedNodeObj.style?.color)\n                        ? 'border-slate-800 scale-110'\n                        : 'border-transparent hover:scale-110',\n                    )}\n                    style={{ backgroundColor: c }}\n                    onClick={() => updateNodeStyle({ color: c })}\n                  />\n                ))}\n              </div>\n            </div>\n          )}\n\n          {selectedEdgeObj && (\n            <>\n              <div className=\"space-y-3\">\n                <label className=\"text-[11px] font-semibold text-slate-500 uppercase tracking-wider block\">\n                  Stroke Style\n                </label>\n                <div className=\"flex gap-2\">\n                  <button\n                    className={cn(\n                      'flex-1 h-9 rounded-lg border-2 flex items-center justify-center transition-colors',\n                      selectedEdgeObj.style?.strokeDasharray === 'none' ||\n                        !selectedEdgeObj.style?.strokeDasharray\n                        ? 'border-primary bg-primary/10 text-primary'\n                        : 'border-slate-100 bg-white hover:bg-slate-50 text-slate-400',\n                    )}\n                    onClick={() => updateEdgeStyle({ strokeDasharray: 'none' })}\n                  >\n                    <svg width=\"24\" height=\"2\" className=\"overflow-visible\">\n                      <line\n                        x1=\"0\"\n                        y1=\"1\"\n                        x2=\"24\"\n                        y2=\"1\"\n                        stroke=\"currentColor\"\n                        strokeWidth=\"2.5\"\n                      />\n                    </svg>\n                  </button>\n                  <button\n                    className={cn(\n                      'flex-1 h-9 rounded-lg border-2 flex items-center justify-center transition-colors',\n                      selectedEdgeObj.style?.strokeDasharray === '8 8'\n                        ? 'border-primary bg-primary/10 text-primary'\n                        : 'border-slate-100 bg-white hover:bg-slate-50 text-slate-400',\n                    )}\n                    onClick={() => updateEdgeStyle({ strokeDasharray: '8 8' })}\n                  >\n                    <svg width=\"24\" height=\"2\" className=\"overflow-visible\">\n                      <line\n                        x1=\"0\"\n                        y1=\"1\"\n                        x2=\"24\"\n                        y2=\"1\"\n                        stroke=\"currentColor\"\n                        strokeWidth=\"2.5\"\n                        strokeDasharray=\"6 6\"\n                      />\n                    </svg>\n                  </button>\n                  <button\n                    className={cn(\n                      'flex-1 h-9 rounded-lg border-2 flex items-center justify-center transition-colors',\n                      selectedEdgeObj.style?.strokeDasharray === '4 4'\n                        ? 'border-primary bg-primary/10 text-primary'\n                        : 'border-slate-100 bg-white hover:bg-slate-50 text-slate-400',\n                    )}\n                    onClick={() => updateEdgeStyle({ strokeDasharray: '4 4' })}\n                  >\n                    <svg width=\"24\" height=\"2\" className=\"overflow-visible\">\n                      <line\n                        x1=\"0\"\n                        y1=\"1\"\n                        x2=\"24\"\n                        y2=\"1\"\n                        stroke=\"currentColor\"\n                        strokeWidth=\"2.5\"\n                        strokeDasharray=\"2 4\"\n                        strokeLinecap=\"round\"\n                      />\n                    </svg>\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"space-y-3\">\n                <label className=\"text-[11px] font-semibold text-slate-500 uppercase tracking-wider block\">\n                  Line Thickness\n                </label>\n                <div className=\"flex gap-4 items-center\">\n                  <input\n                    type=\"range\"\n                    min=\"1\"\n                    max=\"8\"\n                    step=\"1\"\n                    className=\"flex-1 accent-primary h-1.5 bg-slate-100 rounded-full appearance-none cursor-pointer\"\n                    value={selectedEdgeObj.style?.strokeWidth || 2}\n                    onChange={(e) =>\n                      updateEdgeStyle({ strokeWidth: parseInt(e.target.value) })\n                    }\n                  />\n                  <span className=\"text-[13px] font-medium text-slate-600 w-4 text-center\">\n                    {selectedEdgeObj.style?.strokeWidth || 2}\n                  </span>\n                </div>\n              </div>\n\n              <div className=\"space-y-3\">\n                <label className=\"text-[11px] font-semibold text-slate-500 uppercase tracking-wider block\">\n                  Color\n                </label>\n                <div className=\"flex flex-wrap gap-2\">\n                  {[\n                    '#cbd5e1',\n                    '#a855f7',\n                    '#3b82f6',\n                    '#10b981',\n                    '#f59e0b',\n                    '#ef4444',\n                    '#1e293b',\n                  ].map((c) => (\n                    <button\n                      key={c}\n                      className={cn(\n                        'w-7 h-7 rounded-lg border-2 transition-transform',\n                        selectedEdgeObj.style?.stroke === c ||\n                          (c === '#cbd5e1' && !selectedEdgeObj.style?.stroke)\n                          ? 'border-slate-800 scale-110'\n                          : 'border-transparent hover:scale-110',\n                      )}\n                      style={{ backgroundColor: c }}\n                      onClick={() => updateEdgeStyle({ stroke: c })}\n                    />\n                  ))}\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      )}\n\n      <div\n        ref={boardRef}\n        className={cn(\n          'flex-1 relative canvas-container overflow-hidden',\n          isPanning\n            ? 'cursor-grabbing'\n            : isSpacePressed || activeTool === 'Pan'\n              ? 'cursor-grab'\n              : activeTool !== 'Select'\n                ? 'cursor-crosshair'\n                : '',\n        )}\n        style={{\n          backgroundPosition: `${transform.x}px ${transform.y}px`,\n          backgroundSize: `${28 * transform.scale}px ${28 * transform.scale}px`,\n        }}\n        onContextMenu={(e) => e.preventDefault()}\n        onPointerDown={handlePointerDown}\n        onPointerMove={handlePointerMove}\n        onPointerUp={handlePointerUp}\n        onPointerCancel={handlePointerUp}\n        onPointerLeave={handlePointerUp}\n        onDragOver={(e) => e.preventDefault()}\n        onDrop={handleDrop}\n        onDoubleClick={(e) => {\n          const target = e.target as HTMLElement\n          const isBg =\n            target === boardRef.current ||\n            target.classList.contains('canvas-container') ||\n            target.tagName === 'svg'\n\n          if (isBg && activeTool === 'Select') {\n            const rect = boardRef.current?.getBoundingClientRect()\n            if (!rect) return\n            let x = (e.clientX - rect.left - transform.x) / transform.scale - 50\n            let y = (e.clientY - rect.top - transform.y) / transform.scale - 15\n            if (snapToGrid) {\n              x = Math.round(x / 28) * 28\n              y = Math.round(y / 28) * 28\n            }\n            const newNodeId = generateId('n')\n            onChangeWithHistory({\n              ...funnel,\n              nodes: [\n                ...funnel.nodes,\n                {\n                  id: newNodeId,\n                  type: 'FloatingText',\n                  x,\n                  y,\n                  data: { name: 'New Text', status: '', subtitle: '' },\n                  style: { color: '#1e293b' },\n                },\n              ],\n            })\n            setSelectedNodes([newNodeId])\n          }\n        }}\n      >\n        <div\n          style={{\n            transform: `translate3d(${transform.x}px, ${transform.y}px, 0) scale(${transform.scale})`,\n            transformOrigin: '0 0',\n          }}\n          className=\"absolute inset-0 w-full h-full pointer-events-none\"\n        >\n          <svg className=\"absolute inset-0 w-full h-full overflow-visible z-0 pointer-events-none\">\n            {funnel.edges.map((e) => {\n              const sourceNode = getEffectiveNode(\n                funnel.nodes.find((n) => n.id === e.source),\n              )\n              const targetNode = getEffectiveNode(\n                funnel.nodes.find((n) => n.id === e.target),\n              )\n              if (!sourceNode || !targetNode) return null\n              const isSelected = selectedEdge === e.id\n\n              const sourceCoords = getRightPortCoords(\n                sourceNode,\n                sourceNode.x,\n                sourceNode.y,\n              )\n              const targetCoords = getLeftPortCoords(\n                targetNode,\n                targetNode.x,\n                targetNode.y,\n              )\n\n              const d = `M ${sourceCoords.x} ${sourceCoords.y} C ${sourceCoords.x + 50} ${sourceCoords.y}, ${targetCoords.x - 50} ${targetCoords.y}, ${targetCoords.x} ${targetCoords.y}`\n\n              const strokeColor =\n                e.style?.stroke || (isSelected ? '#a855f7' : '#cbd5e1')\n              const strokeWidth = e.style?.strokeWidth || (isSelected ? 3 : 2)\n              const strokeDasharray = e.style?.strokeDasharray || 'none'\n\n              return (\n                <path\n                  key={e.id}\n                  d={d}\n                  stroke={strokeColor}\n                  strokeWidth={strokeWidth}\n                  strokeDasharray={strokeDasharray}\n                  fill=\"none\"\n                  className=\"transition-colors cursor-pointer hover:stroke-slate-400 pointer-events-auto\"\n                  onClick={(ev) => {\n                    ev.stopPropagation()\n                    if (activeTool === 'Select') {\n                      setSelectedEdge(e.id)\n                      setSelectedNodes([])\n                    }\n                  }}\n                />\n              )\n            })}\n            {drawingEdge &&\n              (() => {\n                const sNode = funnel.nodes.find(\n                  (n) => n.id === drawingEdge.source,\n                )\n                if (!sNode) return null\n                const sourceCoords = getRightPortCoords(sNode, sNode.x, sNode.y)\n                return (\n                  <path\n                    d={`M ${sourceCoords.x} ${sourceCoords.y} C ${sourceCoords.x + 50} ${sourceCoords.y}, ${drawingEdge.currentX - 50} ${drawingEdge.currentY}, ${drawingEdge.currentX} ${drawingEdge.currentY}`}\n                    stroke=\"#a855f7\"\n                    strokeWidth=\"2\"\n                    strokeDasharray=\"4 4\"\n                    fill=\"none\"\n                  />\n                )\n              })()}\n            {creatingShape &&\n              (() => {\n                const w = Math.abs(\n                  creatingShape.currentX - creatingShape.startX,\n                )\n                const h = Math.abs(\n                  creatingShape.currentY - creatingShape.startY,\n                )\n                const x = Math.min(creatingShape.startX, creatingShape.currentX)\n                const y = Math.min(creatingShape.startY, creatingShape.currentY)\n\n                if (creatingShape.type === 'Square')\n                  return (\n                    <rect\n                      x={x}\n                      y={y}\n                      width={w}\n                      height={h}\n                      rx={8}\n                      fill=\"rgba(244, 81, 11, 0.1)\"\n                      stroke=\"#f4510b\"\n                      strokeWidth={2 / transform.scale}\n                      strokeDasharray=\"4 4\"\n                    />\n                  )\n                if (creatingShape.type === 'Circle')\n                  return (\n                    <ellipse\n                      cx={x + w / 2}\n                      cy={y + h / 2}\n                      rx={w / 2}\n                      ry={h / 2}\n                      fill=\"rgba(244, 81, 11, 0.1)\"\n                      stroke=\"#f4510b\"\n                      strokeWidth={2 / transform.scale}\n                      strokeDasharray=\"4 4\"\n                    />\n                  )\n                if (creatingShape.type === 'Diamond')\n                  return (\n                    <polygon\n                      points={`${x + w / 2},${y} ${x + w},${y + h / 2} ${x + w / 2},${y + h} ${x},${y + h / 2}`}\n                      fill=\"rgba(244, 81, 11, 0.1)\"\n                      stroke=\"#f4510b\"\n                      strokeWidth={2 / transform.scale}\n                      strokeDasharray=\"4 4\"\n                      strokeLinejoin=\"round\"\n                    />\n                  )\n              })()}\n            {selectionBox &&\n              (() => {\n                const w = Math.abs(selectionBox.currentX - selectionBox.startX)\n                const h = Math.abs(selectionBox.currentY - selectionBox.startY)\n                const x = Math.min(selectionBox.startX, selectionBox.currentX)\n                const y = Math.min(selectionBox.startY, selectionBox.currentY)\n                return (\n                  <rect\n                    x={x}\n                    y={y}\n                    width={w}\n                    height={h}\n                    fill=\"rgba(244, 81, 11, 0.08)\"\n                    stroke=\"#f4510b\"\n                    strokeWidth={1 / transform.scale}\n                  />\n                )\n              })()}\n          </svg>\n\n          <div className=\"absolute inset-0 w-full h-full pointer-events-none\">\n            {funnel.nodes.map((n) => {\n              const nodeTasks = tasks.filter((t) =>\n                n.data.linkedTaskIds?.includes(t.id),\n              )\n              let total = 0\n              let completed = 0\n              nodeTasks.forEach((t) => {\n                if (t.subtasks && t.subtasks.length > 0) {\n                  total += t.subtasks.length\n                  completed += t.subtasks.filter((s) => s.isCompleted).length\n                } else {\n                  total += 1\n                  if (t.status === 'Concluído') completed += 1\n                }\n              })\n              const taskProgress = { total, completed }\n\n              return (\n                <NodeItem\n                  key={n.id}\n                  node={getEffectiveNode(n)!}\n                  selected={selectedNodes.includes(n.id)}\n                  snapToGrid={snapToGrid}\n                  activeTool={activeTool}\n                  taskProgress={taskProgress}\n                  onPointerDownAction={(shiftKey) =>\n                    handleNodePointerDown(n.id, shiftKey)\n                  }\n                  onMove={(dx, dy) =>\n                    setDragState({ isDragging: true, dx, dy })\n                  }\n                  onMoveEnd={(dx, dy) => {\n                    setDragState(null)\n                    if (dx === 0 && dy === 0) return\n                    onChangeWithHistory({\n                      ...funnel,\n                      nodes: funnel.nodes.map((node) =>\n                        selectedNodes.includes(node.id) || node.id === n.id\n                          ? { ...node, x: node.x + dx, y: node.y + dy }\n                          : node,\n                      ),\n                    })\n                  }}\n                  onResize={(x, y, w, h) =>\n                    setResizingNode({ id: n.id, x, y, width: w, height: h })\n                  }\n                  onResizeEnd={(x, y, w, h) => {\n                    setResizingNode(null)\n                    onChangeWithHistory({\n                      ...funnel,\n                      nodes: funnel.nodes.map((node) =>\n                        node.id === n.id\n                          ? { ...node, x, y, width: w, height: h }\n                          : node,\n                      ),\n                    })\n                  }}\n                  onAddChild={() => handleAddChild(n.id)}\n                  onDelete={() => {\n                    if (selectedNodes.includes(n.id))\n                      setNodeToDelete('selected')\n                    else setNodeToDelete(n.id)\n                  }}\n                  onOpenRightPanel={(tab) =>\n                    setRightPanelState({ nodeId: n.id, tab })\n                  }\n                  onOpenSettings={() => setSettingsNodeId(n.id)}\n                  onToggleComplete={() =>\n                    onChangeWithHistory({\n                      ...funnel,\n                      nodes: funnel.nodes.map((node) =>\n                        node.id === n.id\n                          ? {\n                              ...node,\n                              data: {\n                                ...node.data,\n                                isCompleted: !node.data.isCompleted,\n                              },\n                            }\n                          : node,\n                      ),\n                    })\n                  }\n                  scale={transform.scale}\n                  onTextChange={(text) =>\n                    onChangeWithHistory({\n                      ...funnel,\n                      nodes: funnel.nodes.map((node) =>\n                        node.id === n.id\n                          ? { ...node, data: { ...node.data, name: text } }\n                          : node,\n                      ),\n                    })\n                  }\n                  onEdgeDragStart={handleEdgeDragStart}\n                  onDropResource={(type, id) =>\n                    handleDropResource(n.id, type, id)\n                  }\n                />\n              )\n            })}\n          </div>\n        </div>\n      </div>\n\n      {rightPanelState &&\n        funnel.nodes.find((n) => n.id === rightPanelState.nodeId) && (\n          <RightPanel\n            node={funnel.nodes.find((n) => n.id === rightPanelState.nodeId)!}\n            funnel={funnel}\n            defaultTab={rightPanelState.tab}\n            onChange={(n) =>\n              onChangeWithHistory({\n                ...funnel,\n                nodes: funnel.nodes.map((node) =>\n                  node.id === n.id ? n : node,\n                ),\n              })\n            }\n            onClose={() => setRightPanelState(null)}\n          />\n        )}\n      <NodeSettingsModal\n        node={\n          settingsNodeId\n            ? funnel.nodes.find((n) => n.id === settingsNodeId) || null\n            : null\n        }\n        isOpen={!!settingsNodeId}\n        onClose={() => setSettingsNodeId(null)}\n        onSave={(id, updates) => {\n          onChangeWithHistory({\n            ...funnel,\n            nodes: funnel.nodes.map((n) =>\n              n.id === id ? { ...n, data: { ...n.data, ...updates } } : n,\n            ),\n          })\n          setSettingsNodeId(null)\n        }}\n      />\n\n      <ConfirmDialog\n        open={!!nodeToDelete}\n        onOpenChange={(open) => !open && setNodeToDelete(null)}\n        title=\"Excluir Elementos?\"\n        description=\"Esta ação removerá os elementos selecionados do canvas. Deseja continuar?\"\n        confirmLabel=\"Excluir\"\n        variant=\"destructive\"\n        onConfirm={handleConfirmDelete}\n      />\n    </div>\n  )\n}\n"],"x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,23],"mappings":"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"}